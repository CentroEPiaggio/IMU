C51 COMPILER V9.51   IMU_FUNCTIONS                                                         02/16/2018 15:56:04 PAGE 1   


C51 COMPILER V9.51, COMPILATION OF MODULE IMU_FUNCTIONS
OBJECT MODULE PLACED IN .\DP8051_Keil_951\Release\IMU_functions.obj
COMPILER INVOKED BY: C:\Program Files (x86)\Cypress\PSoC Creator\4.1\PSoC Creator\import\keil\pk51\9.51\C51\BIN\c51.exe 
                    -IMU_functions.c NOIV LARGE MODDP2 OMF2 VB(1) NOIP INCDIR(.,Generated_Source\PSoC3) FF(3) DB DF(NDEBUG) WL(2) PR(.\DP8051
                    -_Keil_951\Release/IMU_functions.lst) CD OT(11,SPEED) OJ(.\DP8051_Keil_951\Release\IMU_functions.obj)

line level    source

*** MESSAGE C286 IN LINE 0 OF (null): license limits optimization to level 5
   1          // ----------------------------------------------------------------------------
   2          // BSD 3-Clause License
   3          
   4          // Copyright (c) 2016, qbrobotics
   5          // Copyright (c) 2017-2018, Centro "E.Piaggio"
   6          // All rights reserved.
   7          
   8          // Redistribution and use in source and binary forms, with or without
   9          // modification, are permitted provided that the following conditions are met:
  10          
  11          // * Redistributions of source code must retain the above copyright notice, this
  12          //   list of conditions and the following disclaimer.
  13          
  14          // * Redistributions in binary form must reproduce the above copyright notice,
  15          //   this list of conditions and the following disclaimer in the documentation
  16          //   and/or other materials provided with the distribution.
  17          
  18          // * Neither the name of the copyright holder nor the names of its
  19          //   contributors may be used to endorse or promote products derived from
  20          //   this software without specific prior written permission.
  21          
  22          // THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
  23          // AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
  24          // IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
  25          // DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE
  26          // FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
  27          // DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
  28          // SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
  29          // CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
  30          // OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
  31          // OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
  32          // POSSIBILITY OF SUCH DAMAGE.
  33          // ----------------------------------------------------------------------------
  34          
  35          /**
  36          * \file         IMU_functions.c
  37          *
  38          * \brief        Implementation of IMU module functions.
  39          * \date         February 01, 2018
  40          * \author       _Centro "E.Piaggio"_
  41          * \copyright    (C) 2012-2016 qbrobotics. All rights reserved.
  42          * \copyright    (C) 2017-2018 Centro "E.Piaggio". All rights reserved.
  43          */
  44          
  45          #include <IMU_functions.h>
  46          #include <SPI_IMU.h>
  47          
  48          extern uint8 Accel[N_IMU_MAX][6];
  49          extern uint8 Gyro[N_IMU_MAX][6];
  50          extern uint8 Mag[N_IMU_MAX][6];
  51          extern uint8 MagCal[N_IMU_MAX][3];
  52          
C51 COMPILER V9.51   IMU_FUNCTIONS                                                         02/16/2018 15:56:04 PAGE 2   

  53          /*******************************************************************************
  54          * Function Name: Imus Reset
  55          *********************************************************************************/      
  56          void ImusReset() {
  57   1      
  58   1          Opto_Pin_Write(0);
  59   1          CyDelay(10);
  60   1          Opto_Pin_Write(1);
  61   1          CyDelay(10);
  62   1          InitIMUgeneral();
  63   1      
  64   1          CyDelay(10);
  65   1      }
  66          
  67          /*******************************************************************************
  68          * Function Name: IMU Initialization
  69          *********************************************************************************/
  70          void InitIMU(){ 
  71   1          
  72   1              WriteControlRegister(MPU9250_PWR_MGMT_1, 0x10); 
  73   1              CyDelay(10);    
  74   1              WriteControlRegister(MPU9250_USER_CTRL, 0x20);  //I2C master enable - disable I2C (prima 0x30)
  75   1              CyDelay(10);
  76   1          WriteControlRegister(MPU9250_CONFIG, 0x06); //Gyro & Temp Low Pass Filter 0x01 = 184Hz, 0x02 = 92Hz, 0
             -x04 = 20Hz, 0x05 = 10Hz
  77   1          CyDelay(10);        
  78   1              WriteControlRegister(MPU9250_GYRO_CONFIG , GYRO_SF_2000); //Gyro full scale select 0x00=250Â°/s 0x80=500Â
             -°/s 0x18=2000Â°/s 
  79   1              CyDelay(10);
  80   1          WriteControlRegister(MPU9250_ACCEL_CONFIG, ACC_SF_2G); // Acc full scale select 0x00 = 2g 0x08 = 4g 0x
             -10 = 8g 0x18 = 16g
  81   1          CyDelay(10);
  82   1          WriteControlRegister(MPU9250_ACCEL_CONFIG2, 0x05);
  83   1          CyDelay(10);
  84   1              //mag register
  85   1              WriteControlRegister(MPU9250_I2C_MST_CTRL, 0x0D); //set slave I2C speed
  86   1              CyDelay(10);
  87   1              //SLV0 (use to write)
  88   1              WriteControlRegister(MPU9250_I2C_SLV0_ADDR, 0x0C); //set compass address
  89   1              CyDelay(10);                    
  90   1              WriteControlRegister(MPU9250_I2C_SLV0_REG, AK8936_CNTL); //compass mode register
  91   1              CyDelay(10);    
  92   1              // Istruction used to read Compass
  93   1              WriteControlRegister(MPU9250_I2C_SLV0_D0, 0x16); //0x12 continuous mode1  0x16 continuous mode2
  94   1              CyDelay(10);
  95   1              WriteControlRegister(MPU9250_I2C_SLV0_CTRL, 0x81); //enable data from register + 1 bit to write
  96   1              CyDelay(10);
  97   1              //SLV0 (use to read)
  98   1              WriteControlRegister(MPU9250_I2C_SLV0_ADDR, 0x8C); // RCR  | AK8963_address (0x0C) 
  99   1              CyDelay(10);
 100   1              // Istruction used to read Compass
 101   1              WriteControlRegister(MPU9250_I2C_SLV0_REG, 0x03); // 0x03:start from Xout Low in case of calibration 0x10
             -:start from ASAX
 102   1              CyDelay(10);
 103   1              // Istruction used to read Compass
 104   1              WriteControlRegister(MPU9250_I2C_SLV0_CTRL, 0x8D); //How many bits read  SEMPRE DISPARI 0x8D era quella c
             -he funzionava
 105   1              CyDelay(10);
 106   1              WriteControlRegister(MPU9250_PWR_MGMT_1, 0x00); 
 107   1              CyDelay(20);
 108   1      }       
 109          
C51 COMPILER V9.51   IMU_FUNCTIONS                                                         02/16/2018 15:56:04 PAGE 3   

 110          /*******************************************************************************
 111          * Function Name: IMU Mag Cal Initialization
 112          *********************************************************************************/
 113          void InitIMUMagCal(){   
 114   1          
 115   1              WriteControlRegister(MPU9250_PWR_MGMT_1, 0x10); 
 116   1              CyDelay(10);    
 117   1              WriteControlRegister(MPU9250_USER_CTRL, 0x20);  //I2C master enable - disable I2C (prima 0x30)
 118   1              CyDelay(10);
 119   1          WriteControlRegister(MPU9250_CONFIG, 0x06); //Gyro & Temp Low Pass Filter 0x01 = 184Hz, 0x02 = 92Hz, 0
             -x04 = 20Hz, 0x05 = 10Hz
 120   1          CyDelay(10);        
 121   1              WriteControlRegister(MPU9250_GYRO_CONFIG , GYRO_SF_2000); //Gyro full scale select 0x00=250Â°/s 0x80=500Â
             -°/s 0x18=2000Â°/s 
 122   1              CyDelay(10);
 123   1          WriteControlRegister(MPU9250_ACCEL_CONFIG, ACC_SF_2G); // Acc full scale select 0x00 = 2g 0x08 = 4g 0x
             -10 = 8g 0x18 = 16g
 124   1          CyDelay(10);
 125   1          WriteControlRegister(MPU9250_ACCEL_CONFIG2, 0x05);
 126   1          CyDelay(10);
 127   1              //mag register
 128   1              WriteControlRegister(MPU9250_I2C_MST_CTRL, 0x0D); //set slave I2C speed
 129   1              CyDelay(10);
 130   1              //SLV0 (use to write)
 131   1              WriteControlRegister(MPU9250_I2C_SLV0_ADDR, 0x0C); //set compass address
 132   1              CyDelay(10);                    
 133   1              WriteControlRegister(MPU9250_I2C_SLV0_REG, AK8936_CNTL); //compass mode register
 134   1              CyDelay(10);    
 135   1              WriteControlRegister(MPU9250_I2C_SLV0_D0, 0x1F); //0x1F ROM access
 136   1              CyDelay(10);
 137   1              WriteControlRegister(MPU9250_I2C_SLV0_CTRL, 0x81); //enable data from register + 1 bit to write
 138   1              CyDelay(10);
 139   1              //SLV0 (use to read)
 140   1              WriteControlRegister(MPU9250_I2C_SLV0_ADDR, 0x8C); // RCR  | AK8963_address (0x0C) 
 141   1              CyDelay(10);
 142   1              WriteControlRegister(MPU9250_I2C_SLV0_REG, 0x10); // 0x10:start from ASAX
 143   1              CyDelay(10);
 144   1              WriteControlRegister(MPU9250_I2C_SLV0_CTRL, 0x83);
 145   1              CyDelay(10);
 146   1              WriteControlRegister(MPU9250_PWR_MGMT_1, 0x00); 
 147   1              CyDelay(20);
 148   1      }
 149          
 150          /********************************************************************************
 151          * Function Name: ChipSelector                                                   *
 152          *********************************************************************************/
 153          void ChipSelector(int n)
 154          {
 155   1          Chip_Select_A_Write(15);
 156   1          Chip_Select_B_Write(3);
 157   1          
 158   1          if(n<15)
 159   1              Chip_Select_A_Write(n);
 160   1          if(n==15)
 161   1              Chip_Select_B_Write(0);
 162   1          if(n==16)
 163   1              Chip_Select_B_Write(1);
 164   1      }
 165          
 166          /********************************************************************************
 167          * Function Name: InitIMUGeneral                                                 *
 168          *********************************************************************************/
C51 COMPILER V9.51   IMU_FUNCTIONS                                                         02/16/2018 15:56:04 PAGE 4   

 169          void InitIMUgeneral()
 170          {
 171   1          uint8 k_imu;
 172   1          uint8 count = 0;
 173   1          int IMU_ack;
 174   1          int tmp[N_IMU_MAX];
 175   1      
 176   1          // Initialize Memory Structure 
 177   1          memset(&g_imu, 0, sizeof(struct st_imu));
 178   1          memset(&IMU_connected, 0, sizeof(IMU_connected));
 179   1      
 180   1          // Identify IMU connected
 181   1          ChipSelector(0);
 182   1          CyDelay(10);
 183   1          IMU_ack = ReadControlRegister(MPU9250_WHO_AM_I);
 184   1          IMU_ack = 0;
 185   1          N_IMU_Connected = 0;    
 186   1          for (k_imu = 0; k_imu < N_IMU_MAX; k_imu++) 
 187   1          {      
 188   2              ChipSelector(k_imu);
 189   2              CyDelay(10);
 190   2              IMU_ack = ReadControlRegister(MPU9250_WHO_AM_I);
 191   2              if (IMU_ack == 0x71) 
 192   2              {
 193   3                  N_IMU_Connected++;
 194   3                  IMU_ack = 0;
 195   3                  tmp[k_imu] = 1;
 196   3              }
 197   2              else
 198   2                  tmp[k_imu] = 0;
 199   2          }
 200   1      
 201   1          for(k_imu = 0; k_imu < N_IMU_MAX; k_imu++)
 202   1          {
 203   2              if(tmp[k_imu] == 1)
 204   2              {
 205   3                  IMU_connected[count] = k_imu;
 206   3                  count++;
 207   3              }
 208   2          }
 209   1                  
 210   1          // Standard Initialization of the IMU
 211   1          Opto_Pin_Write(0);
 212   1          CyDelay(10);
 213   1          Opto_Pin_Write(1);
 214   1          CyDelay(10);
 215   1          for (k_imu=0; k_imu < N_IMU_MAX; k_imu++) 
 216   1          {   
 217   2                  ChipSelector(k_imu);
 218   2                  CyDelay(10);
 219   2                  InitIMU();
 220   2                  CyDelay(10); 
 221   2              InitIMUMagCal();      // Initialize IMU to Read MagCal Parameters
 222   2                  CyDelay(10); 
 223   2          }
 224   1          CyDelay(50);
 225   1          
 226   1          // Reading of MagCal Parameters
 227   1          for (k_imu = 0; k_imu < N_IMU_MAX; k_imu++){
 228   2              ChipSelector(k_imu);
 229   2              ReadMagCal(k_imu); 
 230   2          }
C51 COMPILER V9.51   IMU_FUNCTIONS                                                         02/16/2018 15:56:04 PAGE 5   

 231   1          CyDelay(50);
 232   1          
 233   1          // Set Standard Read for the IMU
 234   1          memset(&single_imu_size, 0, sizeof(single_imu_size));
 235   1          imus_data_size = 1; //header    
 236   1          for (k_imu = 0; k_imu < N_IMU_Connected; k_imu++)
 237   1          {
 238   2              single_imu_size[IMU_connected[k_imu]] = 1 + 6*c_mem.IMU_conf[IMU_connected[k_imu]][0] + 6*c_mem.IM
             -U_conf[IMU_connected[k_imu]][1] + 6*c_mem.IMU_conf[IMU_connected[k_imu]][2]+ 16*c_mem.IMU_conf[IMU_connected[k_imu]][3] 
             -+ 2*c_mem.IMU_conf[IMU_connected[k_imu]][4]+ 1;
 239   2              imus_data_size = imus_data_size + single_imu_size[IMU_connected[k_imu]];
 240   2          }
 241   1          imus_data_size = imus_data_size + 1;    //checksum
 242   1      }
 243          
 244          /*******************************************************************************
 245          * Function Name: IMU Read
 246          *********************************************************************************/      
 247          void ReadIMU(int n)
 248          {
 249   1          if (c_mem.IMU_conf[n][0]) ReadAcc(n);
 250   1          if (c_mem.IMU_conf[n][1]) ReadGyro(n);
 251   1          if (c_mem.IMU_conf[n][2]) ReadMag(n);
 252   1          if (c_mem.IMU_conf[n][3]) ReadQuat(n);
 253   1          if (c_mem.IMU_conf[n][4]) ReadTemp(n);
 254   1      }
 255          
 256          /*******************************************************************************
 257          * Function Name: Read Acc's Data of IMU n
 258          *********************************************************************************/
 259          void ReadAcc(int n)
 260          {
 261   1              uint8 low=0, high=0;
 262   1              
 263   1              int row = n;
 264   1              
 265   1              //read X
 266   1          low=ReadControlRegister(MPU9250_ACCEL_XOUT_L);
 267   1          SPI_delay();
 268   1          high=ReadControlRegister(MPU9250_ACCEL_XOUT_H);
 269   1          SPI_delay();
 270   1          
 271   1              Accel[row][0] = high; 
 272   1              Accel[row][1] = low; 
 273   1              low=0, high=0;
 274   1                              
 275   1              //read Y
 276   1          low=ReadControlRegister(MPU9250_ACCEL_YOUT_L);
 277   1          SPI_delay();
 278   1              high=ReadControlRegister(MPU9250_ACCEL_YOUT_H);
 279   1          SPI_delay();
 280   1      
 281   1              Accel[row][2] = high; 
 282   1              Accel[row][3] = low; 
 283   1              low=0, high=0;
 284   1                      
 285   1              //read Z
 286   1          low=ReadControlRegister(MPU9250_ACCEL_ZOUT_L);
 287   1          SPI_delay();
 288   1          high=ReadControlRegister(MPU9250_ACCEL_ZOUT_H);
 289   1          SPI_delay();
 290   1          
C51 COMPILER V9.51   IMU_FUNCTIONS                                                         02/16/2018 15:56:04 PAGE 6   

 291   1              Accel[row][4] = high; 
 292   1              Accel[row][5] = low;
 293   1              low=0, high=0;
 294   1      }
 295          
 296          /*******************************************************************************
 297          * Function Name: Read Gyro's Data of IMU n
 298          *********************************************************************************/
 299          void ReadGyro(int n){
 300   1              uint8 low=0, high=0;
 301   1          
 302   1              int row = n;
 303   1              
 304   1              //read X
 305   1              low=ReadControlRegister(MPU9250_GYRO_XOUT_L);
 306   1          SPI_delay();
 307   1              high=ReadControlRegister(MPU9250_GYRO_XOUT_H);
 308   1          SPI_delay();
 309   1          
 310   1              Gyro[row][0] = high; 
 311   1              Gyro[row][1] = low;
 312   1              low=0, high=0;
 313   1          
 314   1              //read Y
 315   1              low=ReadControlRegister(MPU9250_GYRO_YOUT_L);
 316   1          SPI_delay();
 317   1              high=ReadControlRegister(MPU9250_GYRO_YOUT_H);
 318   1          SPI_delay();
 319   1          
 320   1              Gyro[row][2] = high; 
 321   1              Gyro[row][3] = low;
 322   1              low=0, high=0;
 323   1      
 324   1              //read Z
 325   1          low=ReadControlRegister(MPU9250_GYRO_ZOUT_L);
 326   1          SPI_delay();
 327   1              high=ReadControlRegister(MPU9250_GYRO_ZOUT_H);
 328   1          SPI_delay();
 329   1          
 330   1              Gyro[row][4] = high; 
 331   1              Gyro[row][5] = low;        
 332   1      
 333   1              low=0, high=0;
 334   1      }
 335          
 336          /*******************************************************************************
 337          * Function Name: Read Compas' Data of IMU n
 338          *********************************************************************************/
 339          void ReadMag(int n){
 340   1              
 341   1              uint8 low, high;
 342   1              int row = n;    
 343   1              //read X
 344   1              low = ReadControlRegister(MPU9250_EXT_SENS_DATA_00);
 345   1          SPI_delay();
 346   1              high = ReadControlRegister(MPU9250_EXT_SENS_DATA_01);           
 347   1          SPI_delay();
 348   1          
 349   1              Mag[row][0] = high; 
 350   1              Mag[row][1] = low;
 351   1              low=0, high=0;
 352   1          
C51 COMPILER V9.51   IMU_FUNCTIONS                                                         02/16/2018 15:56:04 PAGE 7   

 353   1              //read Y
 354   1              low = ReadControlRegister(MPU9250_EXT_SENS_DATA_02);
 355   1          SPI_delay();
 356   1              high = ReadControlRegister(MPU9250_EXT_SENS_DATA_03);           
 357   1          SPI_delay();
 358   1          
 359   1              Mag[row][2] = high; 
 360   1              Mag[row][3] = low;
 361   1              low=0, high=0;
 362   1          
 363   1              //read Z
 364   1              low = ReadControlRegister(MPU9250_EXT_SENS_DATA_04);
 365   1          SPI_delay();
 366   1              high = ReadControlRegister(MPU9250_EXT_SENS_DATA_05);
 367   1          SPI_delay();
 368   1                      
 369   1              Mag[row][4] = high; 
 370   1              Mag[row][5] = low;
 371   1              low=0, high=0;
 372   1      }
 373          
 374          /********************************************************************************
 375          * Function Name: ReadMagCal
 376          *********************************************************************************/
 377          void ReadMagCal(int n){
 378   1              
 379   1          uint8 read = 0; 
 380   1              int row = n;    
 381   1              //read X
 382   1              read = ReadControlRegister(MPU9250_EXT_SENS_DATA_00);
 383   1          MagCal[row][0] = read; 
 384   1          read = 0;
 385   1          
 386   1              //read Y
 387   1              read = ReadControlRegister(MPU9250_EXT_SENS_DATA_01);                   
 388   1              MagCal[row][1] = read; 
 389   1              read = 0;
 390   1          
 391   1              //read Z
 392   1              read = ReadControlRegister(MPU9250_EXT_SENS_DATA_02);                   
 393   1              MagCal[row][2] = read; 
 394   1              read = 0;
 395   1          
 396   1      }
 397              
 398          /*******************************************************************************
 399          * Function Name: Read Quaternion of IMU n
 400          *********************************************************************************/
 401          void ReadQuat(int n)
 402          {
 403   1              uint8 i=0;      
 404   1          int16 var_h;
 405   1          float qd0,qd1,qd2,qd3;        
 406   1          float aP[3]; //, fa[3];
 407   1          float Napla[4],g[4],qL[4];
 408   1          float time = 0;
 409   1              
 410   1          if (N_IMU_Connected == 1) {
 411   2              // Compute quaternion only if 1 IMU is connected
 412   2              
 413   2              if (!c_mem.IMU_conf[n][0]) ReadAcc(n);
 414   2              if (!c_mem.IMU_conf[n][1]) ReadGyro(n);
C51 COMPILER V9.51   IMU_FUNCTIONS                                                         02/16/2018 15:56:04 PAGE 8   

 415   2              
 416   2              // assume cycle time is the same of last function_scheduler execution,
 417   2              // without adding another counter
 418   2              time = (float)((uint32)timer_value0 - (uint32)timer_value) / 1000000.0;
 419   2              
 420   2              // how N sees P; N is 'Earth' equivalent, P is for sensor
 421   2              // e.g. N = imu1, P = imu0, how imu1 sees imu0
 422   2      
 423   2              var_h = Accel[n][0];
 424   2              aP[0] = (int16)(var_h << 8 | Accel[n][1]); 
 425   2              var_h = Accel[n][2];
 426   2              aP[1] = (int16)(var_h << 8 | Accel[n][3]); 
 427   2              var_h = Accel[n][4];
 428   2              aP[2] = (int16)(var_h << 8 | Accel[n][5]);
 429   2              
 430   2              g[0] = 0;
 431   2              var_h = Gyro[n][0];
 432   2              g[1] = ((int16)(var_h << 8 | Gyro[n][1]))*TICK2GYRO;
 433   2              if ( fabs(g[1]) < GYRO_THR ) g[1] = 0;
 434   2              var_h = Gyro[n][2];
 435   2              g[2] = ((int16)(var_h << 8 | Gyro[n][3]))*TICK2GYRO; 
 436   2              if ( fabs(g[2]) < GYRO_THR ) g[2] = 0;
 437   2              var_h = Gyro[n][4];
 438   2              g[3] = ((int16)(var_h << 8 | Gyro[n][5]))*TICK2GYRO;
 439   2              if ( fabs(g[3]) < GYRO_THR ) g[3] = 0;
 440   2              
 441   2              // Normalize to 1
 442   2              v3_normalize(aP);
 443   2              
 444   2              // Current quaternion assignment
 445   2              qL[0] = Quat[0];
 446   2              qL[1] = Quat[1];
 447   2              qL[2] = Quat[2];
 448   2              qL[3] = Quat[3];   
 449   2              
 450   2              // Napla computation
 451   2              Napla[0] = (-qL[2]*((2*(qL[1]*qL[3]-qL[0]*qL[2]) - aP[0])) + qL[1]*((2*(qL[0]*qL[1] + qL[2]*qL[3])
             - - aP[1])))*TICK2ACC*BETA;
 452   2              Napla[1] = (qL[3]*((2*(qL[1]*qL[3]-qL[0]*qL[2]) - aP[0])) + qL[0]*((2*(qL[0]*qL[1] + qL[2]*qL[3]) 
             -- aP[1])) -2*qL[1]*((2*(0.5 - qL[1]*qL[1] - qL[2]*qL[2]) - aP[2])))*TICK2ACC*BETA;
 453   2              Napla[2] = (-qL[0]*((2*(qL[1]*qL[3]-qL[0]*qL[2]) - aP[0])) +qL[3]*((2*(qL[0]*qL[1] + qL[2]*qL[3]) 
             -- aP[1])) -2*qL[2]*((2*(0.5 - qL[1]*qL[1] - qL[2]*qL[2]) - aP[2])))*TICK2ACC*BETA;
 454   2              Napla[3] = (qL[1]*((2*(qL[1]*qL[3]-qL[0]*qL[2]) - aP[0])) + qL[2]*((2*(qL[0]*qL[1] + qL[2]*qL[3]) 
             -- aP[1])))*TICK2ACC*BETA;
 455   2              
 456   2              qd0 = 0.5*(-(qL[1]*g[1] + qL[2]*g[2] + qL[3]*g[3])) - Napla[0];
 457   2              qd1 = 0.5*(qL[0]*g[1] + (qL[2]*g[3] - qL[3]*g[2])) - Napla[1];
 458   2              qd2 = 0.5*(qL[0]*g[2] + (qL[3]*g[1] - qL[1]*g[3])) - Napla[2];
 459   2              qd3 = 0.5*(qL[0]*g[3] + (qL[1]*g[2] - qL[2]*g[1])) - Napla[3];
 460   2                      
 461   2              qL[0] = qL[0] + qd0*time;
 462   2              qL[1] = qL[1] + qd1*time;
 463   2              qL[2] = qL[2] + qd2*time;
 464   2              qL[3] = qL[3] + qd3*time;
 465   2              v4_normalize(qL);
 466   2              
 467   2              // Quaternion update      
 468   2              Quat[0] = qL[0];
 469   2              Quat[1] = qL[1];
 470   2              Quat[2] = qL[2];
 471   2              Quat[3] = qL[3];
 472   2          }
C51 COMPILER V9.51   IMU_FUNCTIONS                                                         02/16/2018 15:56:04 PAGE 9   

 473   1          else {
 474   2              return;
 475   2          }
 476   1      }
 477          
 478          /********************************************************************************
 479          * Function Name: ReadAllIMUs
 480          *********************************************************************************/
 481          void ReadAllIMUs(){
 482   1          static uint8 k_imu = 0;
 483   1          uint16 tmp = 0, i = 0, j = 0;
 484   1          int16 value = 0;
 485   1      
 486   1          for (k_imu = 0; k_imu < N_IMU_Connected; k_imu++){ 
 487   2              // Read k_imu IMU
 488   2              ChipSelector(IMU_connected[k_imu]);
 489   2              ReadIMU(IMU_connected[k_imu]);
 490   2              
 491   2              for (j = 0; j < 3; j++) {
 492   3                  tmp = Accel[IMU_connected[k_imu]][2*j];
 493   3                  g_imuNew[k_imu].accel_value[j] = (int16)(tmp<<8 | Accel[IMU_connected[k_imu]][2*j + 1]);
 494   3              }
 495   2              
 496   2              for (j = 0; j < 3; j++) {
 497   3                  tmp = Gyro[IMU_connected[k_imu]][2*j];
 498   3                  g_imuNew[k_imu].gyro_value[j] = (int16)(tmp<<8 | Gyro[IMU_connected[k_imu]][2*j + 1]);
 499   3              }
 500   2                      
 501   2              for (j = 0; j < 3; j++) {
 502   3                  tmp = Mag[IMU_connected[k_imu]][2*j];
 503   3                  g_imuNew[k_imu].mag_value[j] = (int16)(tmp<<8 | Mag[IMU_connected[k_imu]][2*j + 1]);
 504   3              }  
 505   2              
 506   2              // Save quaternion only for first IMU
 507   2              for (j = 0; k_imu == 0 && j < 4; j++) {
 508   3                  g_imuNew[k_imu].quat_value[j] = (float)Quat[j];
 509   3              }
 510   2              
 511   2              tmp = Temp[IMU_connected[k_imu]][0];
 512   2              g_imuNew[k_imu].temp_value = (int16)(tmp<<8 | Temp[IMU_connected[k_imu]][1]);
 513   2          }
 514   1      }
 515          
 516          /*******************************************************************************
 517          * Function Name: Read Temperature Data of IMU n
 518          *********************************************************************************/
 519          void ReadTemp(int n)
 520          {
 521   1              uint8 low=0, high=0;    
 522   1              int row = n;
 523   1              
 524   1              //read X
 525   1          low=ReadControlRegister(MPU9250_TEMP_OUT_L);
 526   1          SPI_delay();
 527   1              high=ReadControlRegister(MPU9250_TEMP_OUT_H);
 528   1          SPI_delay();
 529   1      
 530   1              Temp[row][0] = high; 
 531   1              Temp[row][1] = low; 
 532   1              low=0, high=0;
 533   1      }
 534          
C51 COMPILER V9.51   IMU_FUNCTIONS                                                         02/16/2018 15:56:04 PAGE 10  

 535          /********************************** *********************************************
 536          * Function Name: Write Control Register
 537          *********************************************************************************/
 538          void WriteControlRegister(uint8 address, uint8 dta){
 539   1              
 540   1              SPI_IMU_ClearRxBuffer();
 541   1              SPI_IMU_ClearTxBuffer();
 542   1              SPI_IMU_ClearFIFO();
 543   1              SPI_IMU_WriteByte(MPU9250_WCR | address);
 544   1              while(!( SPI_IMU_ReadStatus() & SPI_IMU_STS_TX_FIFO_EMPTY));            
 545   1              SPI_IMU_WriteByte(dta);
 546   1              while(!( SPI_IMU_ReadStatus() & SPI_IMU_STS_TX_FIFO_EMPTY));
 547   1      }
 548          
 549          /*******************************************************************************
 550          * Function Name: Read Control Register
 551          *********************************************************************************/
 552          uint8 ReadControlRegister(uint8 address){
 553   1              uint8 controlreg;
 554   1              
 555   1              SPI_IMU_WriteByte(MPU9250_RCR | address);
 556   1          SPI_IMU_WriteByte(0x00);
 557   1              while(!( SPI_IMU_ReadStatus() & SPI_IMU_STS_SPI_DONE));
 558   1              controlreg = SPI_IMU_ReadByte();        //real data
 559   1              return controlreg;
 560   1      }
 561          
 562          /*******************************************************************************
 563          * Function Name: SPI delay
 564          *********************************************************************************/
 565          void SPI_delay(){
 566   1          switch( c_mem.SPI_read_delay ) {
 567   2              case 1:     // Low
 568   2                  CyDelayUs((uint16)SPI_DELAY_LOW);
 569   2                  break;
 570   2              case 2:     // High
 571   2                  CyDelayUs((uint16)SPI_DELAY_HIGH);
 572   2                  break;
 573   2              default:    // None
 574   2                  break;
 575   2          }
 576   1      }
C51 COMPILER V9.51   IMU_FUNCTIONS                                                         02/16/2018 15:56:04 PAGE 11  

ASSEMBLY LISTING OF GENERATED OBJECT CODE


             ; FUNCTION ImusReset (BEGIN)
                                           ; SOURCE LINE # 56
                                           ; SOURCE LINE # 58
0000 E4                CLR     A
0001 FF                MOV     R7,A
0002 120000      E     LCALL   _Opto_Pin_Write
                                           ; SOURCE LINE # 59
0005 E4                CLR     A
0006 7F0A              MOV     R7,#0AH
0008 FE                MOV     R6,A
0009 FD                MOV     R5,A
000A FC                MOV     R4,A
000B 120000      E     LCALL   _?CyDelay
                                           ; SOURCE LINE # 60
000E 7F01              MOV     R7,#01H
0010 120000      E     LCALL   _Opto_Pin_Write
                                           ; SOURCE LINE # 61
0013 E4                CLR     A
0014 7F0A              MOV     R7,#0AH
0016 FE                MOV     R6,A
0017 FD                MOV     R5,A
0018 FC                MOV     R4,A
0019 120000      E     LCALL   _?CyDelay
                                           ; SOURCE LINE # 62
001C 120000      R     LCALL   InitIMUgeneral
                                           ; SOURCE LINE # 64
001F E4                CLR     A
0020 7F0A              MOV     R7,#0AH
0022 FE                MOV     R6,A
0023 FD                MOV     R5,A
0024 FC                MOV     R4,A
0025 120000      E     LCALL   _?CyDelay
                                           ; SOURCE LINE # 65
0028 22                RET     
             ; FUNCTION ImusReset (END)

             ; FUNCTION InitIMU (BEGIN)
                                           ; SOURCE LINE # 70
                                           ; SOURCE LINE # 72
0000 7D10              MOV     R5,#010H
0002 7F6B              MOV     R7,#06BH
0004 120000      R     LCALL   _WriteControlRegister
                                           ; SOURCE LINE # 73
0007 E4                CLR     A
0008 7F0A              MOV     R7,#0AH
000A FE                MOV     R6,A
000B FD                MOV     R5,A
000C FC                MOV     R4,A
000D 120000      E     LCALL   _?CyDelay
                                           ; SOURCE LINE # 74
0010 7D20              MOV     R5,#020H
0012 7F6A              MOV     R7,#06AH
0014 120000      R     LCALL   _WriteControlRegister
                                           ; SOURCE LINE # 75
0017 E4                CLR     A
0018 7F0A              MOV     R7,#0AH
001A FE                MOV     R6,A
001B FD                MOV     R5,A
001C FC                MOV     R4,A
C51 COMPILER V9.51   IMU_FUNCTIONS                                                         02/16/2018 15:56:04 PAGE 12  

001D 120000      E     LCALL   _?CyDelay
                                           ; SOURCE LINE # 76
0020 7D06              MOV     R5,#06H
0022 7F1A              MOV     R7,#01AH
0024 120000      R     LCALL   _WriteControlRegister
                                           ; SOURCE LINE # 77
0027 E4                CLR     A
0028 7F0A              MOV     R7,#0AH
002A FE                MOV     R6,A
002B FD                MOV     R5,A
002C FC                MOV     R4,A
002D 120000      E     LCALL   _?CyDelay
                                           ; SOURCE LINE # 78
0030 7D18              MOV     R5,#018H
0032 7F1B              MOV     R7,#01BH
0034 120000      R     LCALL   _WriteControlRegister
                                           ; SOURCE LINE # 79
0037 E4                CLR     A
0038 7F0A              MOV     R7,#0AH
003A FE                MOV     R6,A
003B FD                MOV     R5,A
003C FC                MOV     R4,A
003D 120000      E     LCALL   _?CyDelay
                                           ; SOURCE LINE # 80
0040 E4                CLR     A
0041 FD                MOV     R5,A
0042 7F1C              MOV     R7,#01CH
0044 120000      R     LCALL   _WriteControlRegister
                                           ; SOURCE LINE # 81
0047 E4                CLR     A
0048 7F0A              MOV     R7,#0AH
004A FE                MOV     R6,A
004B FD                MOV     R5,A
004C FC                MOV     R4,A
004D 120000      E     LCALL   _?CyDelay
                                           ; SOURCE LINE # 82
0050 7D05              MOV     R5,#05H
0052 7F1D              MOV     R7,#01DH
0054 120000      R     LCALL   _WriteControlRegister
                                           ; SOURCE LINE # 83
0057 E4                CLR     A
0058 7F0A              MOV     R7,#0AH
005A FE                MOV     R6,A
005B FD                MOV     R5,A
005C FC                MOV     R4,A
005D 120000      E     LCALL   _?CyDelay
                                           ; SOURCE LINE # 85
0060 7D0D              MOV     R5,#0DH
0062 7F24              MOV     R7,#024H
0064 120000      R     LCALL   _WriteControlRegister
                                           ; SOURCE LINE # 86
0067 E4                CLR     A
0068 7F0A              MOV     R7,#0AH
006A FE                MOV     R6,A
006B FD                MOV     R5,A
006C FC                MOV     R4,A
006D 120000      E     LCALL   _?CyDelay
                                           ; SOURCE LINE # 88
0070 7D0C              MOV     R5,#0CH
0072 7F25              MOV     R7,#025H
0074 120000      R     LCALL   _WriteControlRegister
                                           ; SOURCE LINE # 89
C51 COMPILER V9.51   IMU_FUNCTIONS                                                         02/16/2018 15:56:04 PAGE 13  

0077 E4                CLR     A
0078 7F0A              MOV     R7,#0AH
007A FE                MOV     R6,A
007B FD                MOV     R5,A
007C FC                MOV     R4,A
007D 120000      E     LCALL   _?CyDelay
                                           ; SOURCE LINE # 90
0080 7D0A              MOV     R5,#0AH
0082 7F26              MOV     R7,#026H
0084 120000      R     LCALL   _WriteControlRegister
                                           ; SOURCE LINE # 91
0087 E4                CLR     A
0088 7F0A              MOV     R7,#0AH
008A FE                MOV     R6,A
008B FD                MOV     R5,A
008C FC                MOV     R4,A
008D 120000      E     LCALL   _?CyDelay
                                           ; SOURCE LINE # 93
0090 7D16              MOV     R5,#016H
0092 7F63              MOV     R7,#063H
0094 120000      R     LCALL   _WriteControlRegister
                                           ; SOURCE LINE # 94
0097 E4                CLR     A
0098 7F0A              MOV     R7,#0AH
009A FE                MOV     R6,A
009B FD                MOV     R5,A
009C FC                MOV     R4,A
009D 120000      E     LCALL   _?CyDelay
                                           ; SOURCE LINE # 95
00A0 7D81              MOV     R5,#081H
00A2 7F27              MOV     R7,#027H
00A4 120000      R     LCALL   _WriteControlRegister
                                           ; SOURCE LINE # 96
00A7 E4                CLR     A
00A8 7F0A              MOV     R7,#0AH
00AA FE                MOV     R6,A
00AB FD                MOV     R5,A
00AC FC                MOV     R4,A
00AD 120000      E     LCALL   _?CyDelay
                                           ; SOURCE LINE # 98
00B0 7D8C              MOV     R5,#08CH
00B2 7F25              MOV     R7,#025H
00B4 120000      R     LCALL   _WriteControlRegister
                                           ; SOURCE LINE # 99
00B7 E4                CLR     A
00B8 7F0A              MOV     R7,#0AH
00BA FE                MOV     R6,A
00BB FD                MOV     R5,A
00BC FC                MOV     R4,A
00BD 120000      E     LCALL   _?CyDelay
                                           ; SOURCE LINE # 101
00C0 7D03              MOV     R5,#03H
00C2 7F26              MOV     R7,#026H
00C4 120000      R     LCALL   _WriteControlRegister
                                           ; SOURCE LINE # 102
00C7 E4                CLR     A
00C8 7F0A              MOV     R7,#0AH
00CA FE                MOV     R6,A
00CB FD                MOV     R5,A
00CC FC                MOV     R4,A
00CD 120000      E     LCALL   _?CyDelay
                                           ; SOURCE LINE # 104
C51 COMPILER V9.51   IMU_FUNCTIONS                                                         02/16/2018 15:56:04 PAGE 14  

00D0 7D8D              MOV     R5,#08DH
00D2 7F27              MOV     R7,#027H
00D4 120000      R     LCALL   _WriteControlRegister
                                           ; SOURCE LINE # 105
00D7 E4                CLR     A
00D8 7F0A              MOV     R7,#0AH
00DA FE                MOV     R6,A
00DB FD                MOV     R5,A
00DC FC                MOV     R4,A
00DD 120000      E     LCALL   _?CyDelay
                                           ; SOURCE LINE # 106
00E0 E4                CLR     A
00E1 FD                MOV     R5,A
00E2 7F6B              MOV     R7,#06BH
00E4 120000      R     LCALL   _WriteControlRegister
                                           ; SOURCE LINE # 107
00E7 E4                CLR     A
00E8 7F14              MOV     R7,#014H
00EA FE                MOV     R6,A
00EB FD                MOV     R5,A
00EC FC                MOV     R4,A
00ED 120000      E     LCALL   _?CyDelay
                                           ; SOURCE LINE # 108
00F0 22                RET     
             ; FUNCTION InitIMU (END)

             ; FUNCTION InitIMUMagCal (BEGIN)
                                           ; SOURCE LINE # 113
                                           ; SOURCE LINE # 115
0000 7D10              MOV     R5,#010H
0002 7F6B              MOV     R7,#06BH
0004 120000      R     LCALL   _WriteControlRegister
                                           ; SOURCE LINE # 116
0007 E4                CLR     A
0008 7F0A              MOV     R7,#0AH
000A FE                MOV     R6,A
000B FD                MOV     R5,A
000C FC                MOV     R4,A
000D 120000      E     LCALL   _?CyDelay
                                           ; SOURCE LINE # 117
0010 7D20              MOV     R5,#020H
0012 7F6A              MOV     R7,#06AH
0014 120000      R     LCALL   _WriteControlRegister
                                           ; SOURCE LINE # 118
0017 E4                CLR     A
0018 7F0A              MOV     R7,#0AH
001A FE                MOV     R6,A
001B FD                MOV     R5,A
001C FC                MOV     R4,A
001D 120000      E     LCALL   _?CyDelay
                                           ; SOURCE LINE # 119
0020 7D06              MOV     R5,#06H
0022 7F1A              MOV     R7,#01AH
0024 120000      R     LCALL   _WriteControlRegister
                                           ; SOURCE LINE # 120
0027 E4                CLR     A
0028 7F0A              MOV     R7,#0AH
002A FE                MOV     R6,A
002B FD                MOV     R5,A
002C FC                MOV     R4,A
002D 120000      E     LCALL   _?CyDelay
                                           ; SOURCE LINE # 121
C51 COMPILER V9.51   IMU_FUNCTIONS                                                         02/16/2018 15:56:04 PAGE 15  

0030 7D18              MOV     R5,#018H
0032 7F1B              MOV     R7,#01BH
0034 120000      R     LCALL   _WriteControlRegister
                                           ; SOURCE LINE # 122
0037 E4                CLR     A
0038 7F0A              MOV     R7,#0AH
003A FE                MOV     R6,A
003B FD                MOV     R5,A
003C FC                MOV     R4,A
003D 120000      E     LCALL   _?CyDelay
                                           ; SOURCE LINE # 123
0040 E4                CLR     A
0041 FD                MOV     R5,A
0042 7F1C              MOV     R7,#01CH
0044 120000      R     LCALL   _WriteControlRegister
                                           ; SOURCE LINE # 124
0047 E4                CLR     A
0048 7F0A              MOV     R7,#0AH
004A FE                MOV     R6,A
004B FD                MOV     R5,A
004C FC                MOV     R4,A
004D 120000      E     LCALL   _?CyDelay
                                           ; SOURCE LINE # 125
0050 7D05              MOV     R5,#05H
0052 7F1D              MOV     R7,#01DH
0054 120000      R     LCALL   _WriteControlRegister
                                           ; SOURCE LINE # 126
0057 E4                CLR     A
0058 7F0A              MOV     R7,#0AH
005A FE                MOV     R6,A
005B FD                MOV     R5,A
005C FC                MOV     R4,A
005D 120000      E     LCALL   _?CyDelay
                                           ; SOURCE LINE # 128
0060 7D0D              MOV     R5,#0DH
0062 7F24              MOV     R7,#024H
0064 120000      R     LCALL   _WriteControlRegister
                                           ; SOURCE LINE # 129
0067 E4                CLR     A
0068 7F0A              MOV     R7,#0AH
006A FE                MOV     R6,A
006B FD                MOV     R5,A
006C FC                MOV     R4,A
006D 120000      E     LCALL   _?CyDelay
                                           ; SOURCE LINE # 131
0070 7D0C              MOV     R5,#0CH
0072 7F25              MOV     R7,#025H
0074 120000      R     LCALL   _WriteControlRegister
                                           ; SOURCE LINE # 132
0077 E4                CLR     A
0078 7F0A              MOV     R7,#0AH
007A FE                MOV     R6,A
007B FD                MOV     R5,A
007C FC                MOV     R4,A
007D 120000      E     LCALL   _?CyDelay
                                           ; SOURCE LINE # 133
0080 7D0A              MOV     R5,#0AH
0082 7F26              MOV     R7,#026H
0084 120000      R     LCALL   _WriteControlRegister
                                           ; SOURCE LINE # 134
0087 E4                CLR     A
0088 7F0A              MOV     R7,#0AH
C51 COMPILER V9.51   IMU_FUNCTIONS                                                         02/16/2018 15:56:04 PAGE 16  

008A FE                MOV     R6,A
008B FD                MOV     R5,A
008C FC                MOV     R4,A
008D 120000      E     LCALL   _?CyDelay
                                           ; SOURCE LINE # 135
0090 7D1F              MOV     R5,#01FH
0092 7F63              MOV     R7,#063H
0094 120000      R     LCALL   _WriteControlRegister
                                           ; SOURCE LINE # 136
0097 E4                CLR     A
0098 7F0A              MOV     R7,#0AH
009A FE                MOV     R6,A
009B FD                MOV     R5,A
009C FC                MOV     R4,A
009D 120000      E     LCALL   _?CyDelay
                                           ; SOURCE LINE # 137
00A0 7D81              MOV     R5,#081H
00A2 7F27              MOV     R7,#027H
00A4 120000      R     LCALL   _WriteControlRegister
                                           ; SOURCE LINE # 138
00A7 E4                CLR     A
00A8 7F0A              MOV     R7,#0AH
00AA FE                MOV     R6,A
00AB FD                MOV     R5,A
00AC FC                MOV     R4,A
00AD 120000      E     LCALL   _?CyDelay
                                           ; SOURCE LINE # 140
00B0 7D8C              MOV     R5,#08CH
00B2 7F25              MOV     R7,#025H
00B4 120000      R     LCALL   _WriteControlRegister
                                           ; SOURCE LINE # 141
00B7 E4                CLR     A
00B8 7F0A              MOV     R7,#0AH
00BA FE                MOV     R6,A
00BB FD                MOV     R5,A
00BC FC                MOV     R4,A
00BD 120000      E     LCALL   _?CyDelay
                                           ; SOURCE LINE # 142
00C0 7D10              MOV     R5,#010H
00C2 7F26              MOV     R7,#026H
00C4 120000      R     LCALL   _WriteControlRegister
                                           ; SOURCE LINE # 143
00C7 E4                CLR     A
00C8 7F0A              MOV     R7,#0AH
00CA FE                MOV     R6,A
00CB FD                MOV     R5,A
00CC FC                MOV     R4,A
00CD 120000      E     LCALL   _?CyDelay
                                           ; SOURCE LINE # 144
00D0 7D83              MOV     R5,#083H
00D2 7F27              MOV     R7,#027H
00D4 120000      R     LCALL   _WriteControlRegister
                                           ; SOURCE LINE # 145
00D7 E4                CLR     A
00D8 7F0A              MOV     R7,#0AH
00DA FE                MOV     R6,A
00DB FD                MOV     R5,A
00DC FC                MOV     R4,A
00DD 120000      E     LCALL   _?CyDelay
                                           ; SOURCE LINE # 146
00E0 E4                CLR     A
00E1 FD                MOV     R5,A
C51 COMPILER V9.51   IMU_FUNCTIONS                                                         02/16/2018 15:56:04 PAGE 17  

00E2 7F6B              MOV     R7,#06BH
00E4 120000      R     LCALL   _WriteControlRegister
                                           ; SOURCE LINE # 147
00E7 E4                CLR     A
00E8 7F14              MOV     R7,#014H
00EA FE                MOV     R6,A
00EB FD                MOV     R5,A
00EC FC                MOV     R4,A
00ED 120000      E     LCALL   _?CyDelay
                                           ; SOURCE LINE # 148
00F0 22                RET     
             ; FUNCTION InitIMUMagCal (END)

             ; FUNCTION _ChipSelector (BEGIN)
                                           ; SOURCE LINE # 153
0000 900000      R     MOV     DPTR,#n
0003 EE                MOV     A,R6
0004 F0                MOVX    @DPTR,A
0005 A3                INC     DPTR
0006 EF                MOV     A,R7
0007 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 154
                                           ; SOURCE LINE # 155
0008 7F0F              MOV     R7,#0FH
000A 120000      E     LCALL   _Chip_Select_A_Write
                                           ; SOURCE LINE # 156
000D 7F03              MOV     R7,#03H
000F 120000      E     LCALL   _Chip_Select_B_Write
                                           ; SOURCE LINE # 158
0012 900000      R     MOV     DPTR,#n
0015 E0                MOVX    A,@DPTR
0016 FE                MOV     R6,A
0017 A3                INC     DPTR
0018 E0                MOVX    A,@DPTR
0019 FF                MOV     R7,A
001A C3                CLR     C
001B 940F              SUBB    A,#0FH
001D EE                MOV     A,R6
001E 6480              XRL     A,#080H
0020 9480              SUBB    A,#080H
0022 5003              JNC     ?C0004
                                           ; SOURCE LINE # 159
0024 120000      E     LCALL   _Chip_Select_A_Write
0027         ?C0004:
                                           ; SOURCE LINE # 160
0027 900000      R     MOV     DPTR,#n
002A E0                MOVX    A,@DPTR
002B 7004              JNZ     ?C0075
002D A3                INC     DPTR
002E E0                MOVX    A,@DPTR
002F 640F              XRL     A,#0FH
0031         ?C0075:
0031 7004              JNZ     ?C0005
                                           ; SOURCE LINE # 161
0033 FF                MOV     R7,A
0034 120000      E     LCALL   _Chip_Select_B_Write
0037         ?C0005:
                                           ; SOURCE LINE # 162
0037 900000      R     MOV     DPTR,#n
003A E0                MOVX    A,@DPTR
003B 7004              JNZ     ?C0076
003D A3                INC     DPTR
C51 COMPILER V9.51   IMU_FUNCTIONS                                                         02/16/2018 15:56:04 PAGE 18  

003E E0                MOVX    A,@DPTR
003F 6410              XRL     A,#010H
0041         ?C0076:
0041 7005              JNZ     ?C0007
                                           ; SOURCE LINE # 163
0043 7F01              MOV     R7,#01H
0045 120000      E     LCALL   _Chip_Select_B_Write
                                           ; SOURCE LINE # 164
0048         ?C0007:
0048 22                RET     
             ; FUNCTION _ChipSelector (END)

             ; FUNCTION InitIMUgeneral (BEGIN)
                                           ; SOURCE LINE # 169
                                           ; SOURCE LINE # 170
                                           ; SOURCE LINE # 172
0000 E4                CLR     A
0001 900000      R     MOV     DPTR,#count
0004 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 177
0005 FE                MOV     R6,A
0006 7F25              MOV     R7,#025H
0008 FD                MOV     R5,A
0009 7B01              MOV     R3,#01H
000B 7A00        E     MOV     R2,#HIGH g_imu
000D 7900        E     MOV     R1,#LOW g_imu
000F 120000      E     LCALL   ?C?MEMSET
                                           ; SOURCE LINE # 178
0012 7E00              MOV     R6,#00H
0014 7F11              MOV     R7,#011H
0016 7D00              MOV     R5,#00H
0018 7B01              MOV     R3,#01H
001A 7A00        E     MOV     R2,#HIGH IMU_connected
001C 7900        E     MOV     R1,#LOW IMU_connected
001E 120000      E     LCALL   ?C?MEMSET
                                           ; SOURCE LINE # 181
0021 E4                CLR     A
0022 FF                MOV     R7,A
0023 FE                MOV     R6,A
0024 120000      R     LCALL   _ChipSelector
                                           ; SOURCE LINE # 182
0027 E4                CLR     A
0028 7F0A              MOV     R7,#0AH
002A FE                MOV     R6,A
002B FD                MOV     R5,A
002C FC                MOV     R4,A
002D 120000      E     LCALL   _?CyDelay
                                           ; SOURCE LINE # 183
0030 7F75              MOV     R7,#075H
0032 120000      R     LCALL   _ReadControlRegister
0035 900000      R     MOV     DPTR,#IMU_ack
0038 E4                CLR     A
0039 F0                MOVX    @DPTR,A
003A A3                INC     DPTR
003B EF                MOV     A,R7
003C F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 184
003D E4                CLR     A
003E 900000      R     MOV     DPTR,#IMU_ack
0041 F0                MOVX    @DPTR,A
0042 A3                INC     DPTR
0043 F0                MOVX    @DPTR,A
C51 COMPILER V9.51   IMU_FUNCTIONS                                                         02/16/2018 15:56:04 PAGE 19  

                                           ; SOURCE LINE # 185
0044 900000      E     MOV     DPTR,#N_IMU_Connected
0047 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 186
0048 900000      R     MOV     DPTR,#k_imu
004B F0                MOVX    @DPTR,A
004C         ?C0008:
004C 900000      R     MOV     DPTR,#k_imu
004F E0                MOVX    A,@DPTR
0050 FF                MOV     R7,A
0051 C3                CLR     C
0052 9411              SUBB    A,#011H
0054 505F              JNC     ?C0009
                                           ; SOURCE LINE # 187
                                           ; SOURCE LINE # 188
0056 7E00              MOV     R6,#00H
0058 120000      R     LCALL   _ChipSelector
                                           ; SOURCE LINE # 189
005B E4                CLR     A
005C 7F0A              MOV     R7,#0AH
005E FE                MOV     R6,A
005F FD                MOV     R5,A
0060 FC                MOV     R4,A
0061 120000      E     LCALL   _?CyDelay
                                           ; SOURCE LINE # 190
0064 7F75              MOV     R7,#075H
0066 120000      R     LCALL   _ReadControlRegister
0069 7E00              MOV     R6,#00H
006B 900000      R     MOV     DPTR,#IMU_ack
006E EE                MOV     A,R6
006F F0                MOVX    @DPTR,A
0070 A3                INC     DPTR
0071 EF                MOV     A,R7
0072 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 191
0073 6471              XRL     A,#071H
0075 7023              JNZ     ?C0011
                                           ; SOURCE LINE # 192
                                           ; SOURCE LINE # 193
0077 900000      E     MOV     DPTR,#N_IMU_Connected
007A E0                MOVX    A,@DPTR
007B 04                INC     A
007C F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 194
007D E4                CLR     A
007E 900000      R     MOV     DPTR,#IMU_ack
0081 F0                MOVX    @DPTR,A
0082 A3                INC     DPTR
0083 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 195
0084 900000      R     MOV     DPTR,#k_imu
0087 E0                MOVX    A,@DPTR
0088 25E0              ADD     A,ACC
008A 2400        R     ADD     A,#LOW tmp
008C F582              MOV     DPL,A
008E E4                CLR     A
008F 3400        R     ADDC    A,#HIGH tmp
0091 F583              MOV     DPH,A
0093 E4                CLR     A
0094 F0                MOVX    @DPTR,A
0095 A3                INC     DPTR
0096 04                INC     A
C51 COMPILER V9.51   IMU_FUNCTIONS                                                         02/16/2018 15:56:04 PAGE 20  

0097 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 196
0098 8013              SJMP    ?C0010
009A         ?C0011:
                                           ; SOURCE LINE # 198
009A 900000      R     MOV     DPTR,#k_imu
009D E0                MOVX    A,@DPTR
009E 25E0              ADD     A,ACC
00A0 2400        R     ADD     A,#LOW tmp
00A2 F582              MOV     DPL,A
00A4 E4                CLR     A
00A5 3400        R     ADDC    A,#HIGH tmp
00A7 F583              MOV     DPH,A
00A9 E4                CLR     A
00AA F0                MOVX    @DPTR,A
00AB A3                INC     DPTR
00AC F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 199
00AD         ?C0010:
00AD 900000      R     MOV     DPTR,#k_imu
00B0 E0                MOVX    A,@DPTR
00B1 04                INC     A
00B2 F0                MOVX    @DPTR,A
00B3 8097              SJMP    ?C0008
00B5         ?C0009:
                                           ; SOURCE LINE # 201
00B5 E4                CLR     A
00B6 900000      R     MOV     DPTR,#k_imu
00B9 F0                MOVX    @DPTR,A
00BA         ?C0013:
00BA 900000      R     MOV     DPTR,#k_imu
00BD E0                MOVX    A,@DPTR
00BE FF                MOV     R7,A
00BF C3                CLR     C
00C0 9411              SUBB    A,#011H
00C2 5034              JNC     ?C0014
                                           ; SOURCE LINE # 202
                                           ; SOURCE LINE # 203
00C4 EF                MOV     A,R7
00C5 25E0              ADD     A,ACC
00C7 2400        R     ADD     A,#LOW tmp
00C9 F582              MOV     DPL,A
00CB E4                CLR     A
00CC 3400        R     ADDC    A,#HIGH tmp
00CE F583              MOV     DPH,A
00D0 E0                MOVX    A,@DPTR
00D1 FE                MOV     R6,A
00D2 A3                INC     DPTR
00D3 E0                MOVX    A,@DPTR
00D4 6401              XRL     A,#01H
00D6 4E                ORL     A,R6
00D7 7017              JNZ     ?C0015
                                           ; SOURCE LINE # 204
                                           ; SOURCE LINE # 205
00D9 900000      R     MOV     DPTR,#k_imu
00DC E0                MOVX    A,@DPTR
00DD A3                INC     DPTR
00DE E0                MOVX    A,@DPTR
00DF 2400        E     ADD     A,#LOW IMU_connected
00E1 F582              MOV     DPL,A
00E3 E4                CLR     A
00E4 3400        E     ADDC    A,#HIGH IMU_connected
C51 COMPILER V9.51   IMU_FUNCTIONS                                                         02/16/2018 15:56:04 PAGE 21  

00E6 F583              MOV     DPH,A
00E8 EF                MOV     A,R7
00E9 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 206
00EA 900000      R     MOV     DPTR,#count
00ED E0                MOVX    A,@DPTR
00EE 04                INC     A
00EF F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 207
                                           ; SOURCE LINE # 208
00F0         ?C0015:
00F0 900000      R     MOV     DPTR,#k_imu
00F3 E0                MOVX    A,@DPTR
00F4 04                INC     A
00F5 F0                MOVX    @DPTR,A
00F6 80C2              SJMP    ?C0013
00F8         ?C0014:
                                           ; SOURCE LINE # 211
00F8 E4                CLR     A
00F9 FF                MOV     R7,A
00FA 120000      E     LCALL   _Opto_Pin_Write
                                           ; SOURCE LINE # 212
00FD E4                CLR     A
00FE 7F0A              MOV     R7,#0AH
0100 FE                MOV     R6,A
0101 FD                MOV     R5,A
0102 FC                MOV     R4,A
0103 120000      E     LCALL   _?CyDelay
                                           ; SOURCE LINE # 213
0106 7F01              MOV     R7,#01H
0108 120000      E     LCALL   _Opto_Pin_Write
                                           ; SOURCE LINE # 214
010B E4                CLR     A
010C 7F0A              MOV     R7,#0AH
010E FE                MOV     R6,A
010F FD                MOV     R5,A
0110 FC                MOV     R4,A
0111 120000      E     LCALL   _?CyDelay
                                           ; SOURCE LINE # 215
0114 E4                CLR     A
0115 900000      R     MOV     DPTR,#k_imu
0118 F0                MOVX    @DPTR,A
0119         ?C0017:
0119 900000      R     MOV     DPTR,#k_imu
011C E0                MOVX    A,@DPTR
011D FF                MOV     R7,A
011E C3                CLR     C
011F 9411              SUBB    A,#011H
0121 502E              JNC     ?C0018
                                           ; SOURCE LINE # 216
                                           ; SOURCE LINE # 217
0123 7E00              MOV     R6,#00H
0125 120000      R     LCALL   _ChipSelector
                                           ; SOURCE LINE # 218
0128 E4                CLR     A
0129 7F0A              MOV     R7,#0AH
012B FE                MOV     R6,A
012C FD                MOV     R5,A
012D FC                MOV     R4,A
012E 120000      E     LCALL   _?CyDelay
                                           ; SOURCE LINE # 219
0131 120000      R     LCALL   InitIMU
C51 COMPILER V9.51   IMU_FUNCTIONS                                                         02/16/2018 15:56:04 PAGE 22  

                                           ; SOURCE LINE # 220
0134 E4                CLR     A
0135 7F0A              MOV     R7,#0AH
0137 FE                MOV     R6,A
0138 FD                MOV     R5,A
0139 FC                MOV     R4,A
013A 120000      E     LCALL   _?CyDelay
                                           ; SOURCE LINE # 221
013D 120000      R     LCALL   InitIMUMagCal
                                           ; SOURCE LINE # 222
0140 E4                CLR     A
0141 7F0A              MOV     R7,#0AH
0143 FE                MOV     R6,A
0144 FD                MOV     R5,A
0145 FC                MOV     R4,A
0146 120000      E     LCALL   _?CyDelay
                                           ; SOURCE LINE # 223
0149 900000      R     MOV     DPTR,#k_imu
014C E0                MOVX    A,@DPTR
014D 04                INC     A
014E F0                MOVX    @DPTR,A
014F 80C8              SJMP    ?C0017
0151         ?C0018:
                                           ; SOURCE LINE # 224
0151 E4                CLR     A
0152 7F32              MOV     R7,#032H
0154 FE                MOV     R6,A
0155 FD                MOV     R5,A
0156 FC                MOV     R4,A
0157 120000      E     LCALL   _?CyDelay
                                           ; SOURCE LINE # 227
015A E4                CLR     A
015B 900000      R     MOV     DPTR,#k_imu
015E F0                MOVX    @DPTR,A
015F         ?C0020:
015F 900000      R     MOV     DPTR,#k_imu
0162 E0                MOVX    A,@DPTR
0163 FF                MOV     R7,A
0164 C3                CLR     C
0165 9411              SUBB    A,#011H
0167 5017              JNC     ?C0021
                                           ; SOURCE LINE # 228
0169 7E00              MOV     R6,#00H
016B 120000      R     LCALL   _ChipSelector
                                           ; SOURCE LINE # 229
016E 900000      R     MOV     DPTR,#k_imu
0171 E0                MOVX    A,@DPTR
0172 FF                MOV     R7,A
0173 7E00              MOV     R6,#00H
0175 120000      R     LCALL   _ReadMagCal
                                           ; SOURCE LINE # 230
0178 900000      R     MOV     DPTR,#k_imu
017B E0                MOVX    A,@DPTR
017C 04                INC     A
017D F0                MOVX    @DPTR,A
017E 80DF              SJMP    ?C0020
0180         ?C0021:
                                           ; SOURCE LINE # 231
0180 E4                CLR     A
0181 7F32              MOV     R7,#032H
0183 FE                MOV     R6,A
0184 FD                MOV     R5,A
C51 COMPILER V9.51   IMU_FUNCTIONS                                                         02/16/2018 15:56:04 PAGE 23  

0185 FC                MOV     R4,A
0186 120000      E     LCALL   _?CyDelay
                                           ; SOURCE LINE # 234
0189 7E00              MOV     R6,#00H
018B 7F22              MOV     R7,#022H
018D 7D00              MOV     R5,#00H
018F 7B01              MOV     R3,#01H
0191 7A00        E     MOV     R2,#HIGH single_imu_size
0193 7900        E     MOV     R1,#LOW single_imu_size
0195 120000      E     LCALL   ?C?MEMSET
                                           ; SOURCE LINE # 235
0198 900000      E     MOV     DPTR,#imus_data_size
019B E4                CLR     A
019C F0                MOVX    @DPTR,A
019D A3                INC     DPTR
019E 04                INC     A
019F F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 236
01A0 E4                CLR     A
01A1 900000      R     MOV     DPTR,#k_imu
01A4 F0                MOVX    @DPTR,A
01A5         ?C0023:
01A5 900000      E     MOV     DPTR,#N_IMU_Connected
01A8 E0                MOVX    A,@DPTR
01A9 FF                MOV     R7,A
01AA 900000      R     MOV     DPTR,#k_imu
01AD E0                MOVX    A,@DPTR
01AE FE                MOV     R6,A
01AF C3                CLR     C
01B0 9F                SUBB    A,R7
01B1 4003              JC      $ + 5H
01B3 020000      R     LJMP    ?C0024
                                           ; SOURCE LINE # 237
                                           ; SOURCE LINE # 238
01B6 E0                MOVX    A,@DPTR
01B7 FF                MOV     R7,A
01B8 2400        E     ADD     A,#LOW IMU_connected
01BA F582              MOV     DPL,A
01BC E4                CLR     A
01BD 3400        E     ADDC    A,#HIGH IMU_connected
01BF F583              MOV     DPH,A
01C1 E0                MOVX    A,@DPTR
01C2 FD                MOV     R5,A
01C3 75F005            MOV     B,#05H
01C6 A4                MUL     AB
01C7 2400        E     ADD     A,#LOW c_mem+05H
01C9 F582              MOV     DPL,A
01CB E4                CLR     A
01CC 3400        E     ADDC    A,#HIGH c_mem+05H
01CE F583              MOV     DPH,A
01D0 E0                MOVX    A,@DPTR
01D1 75F006            MOV     B,#06H
01D4 A4                MUL     AB
01D5 FC                MOV     R4,A
01D6 ED                MOV     A,R5
01D7 75F005            MOV     B,#05H
01DA A4                MUL     AB
01DB 2400        E     ADD     A,#LOW c_mem+04H
01DD F582              MOV     DPL,A
01DF E4                CLR     A
01E0 3400        E     ADDC    A,#HIGH c_mem+04H
01E2 F583              MOV     DPH,A
C51 COMPILER V9.51   IMU_FUNCTIONS                                                         02/16/2018 15:56:04 PAGE 24  

01E4 E0                MOVX    A,@DPTR
01E5 75F006            MOV     B,#06H
01E8 A4                MUL     AB
01E9 2C                ADD     A,R4
01EA FD                MOV     R5,A
01EB 7400        E     MOV     A,#LOW IMU_connected
01ED 2F                ADD     A,R7
01EE F582              MOV     DPL,A
01F0 E4                CLR     A
01F1 3400        E     ADDC    A,#HIGH IMU_connected
01F3 F583              MOV     DPH,A
01F5 E0                MOVX    A,@DPTR
01F6 FF                MOV     R7,A
01F7 75F005            MOV     B,#05H
01FA A4                MUL     AB
01FB 2400        E     ADD     A,#LOW c_mem+06H
01FD F582              MOV     DPL,A
01FF E4                CLR     A
0200 3400        E     ADDC    A,#HIGH c_mem+06H
0202 F583              MOV     DPH,A
0204 E0                MOVX    A,@DPTR
0205 75F006            MOV     B,#06H
0208 A4                MUL     AB
0209 2D                ADD     A,R5
020A FD                MOV     R5,A
020B EF                MOV     A,R7
020C 75F005            MOV     B,#05H
020F A4                MUL     AB
0210 2400        E     ADD     A,#LOW c_mem+07H
0212 F582              MOV     DPL,A
0214 E4                CLR     A
0215 3400        E     ADDC    A,#HIGH c_mem+07H
0217 F583              MOV     DPH,A
0219 E0                MOVX    A,@DPTR
021A C4                SWAP    A
021B 54F0              ANL     A,#0F0H
021D 2D                ADD     A,R5
021E FF                MOV     R7,A
021F 7400        E     MOV     A,#LOW IMU_connected
0221 2E                ADD     A,R6
0222 F582              MOV     DPL,A
0224 E4                CLR     A
0225 3400        E     ADDC    A,#HIGH IMU_connected
0227 F583              MOV     DPH,A
0229 E0                MOVX    A,@DPTR
022A FD                MOV     R5,A
022B 75F005            MOV     B,#05H
022E A4                MUL     AB
022F 2400        E     ADD     A,#LOW c_mem+08H
0231 F582              MOV     DPL,A
0233 E4                CLR     A
0234 3400        E     ADDC    A,#HIGH c_mem+08H
0236 F583              MOV     DPH,A
0238 E0                MOVX    A,@DPTR
0239 25E0              ADD     A,ACC
023B 2F                ADD     A,R7
023C 2402              ADD     A,#02H
023E FB                MOV     R3,A
023F ED                MOV     A,R5
0240 25E0              ADD     A,ACC
0242 2400        E     ADD     A,#LOW single_imu_size
0244 F582              MOV     DPL,A
C51 COMPILER V9.51   IMU_FUNCTIONS                                                         02/16/2018 15:56:04 PAGE 25  

0246 E4                CLR     A
0247 3400        E     ADDC    A,#HIGH single_imu_size
0249 F583              MOV     DPH,A
024B E4                CLR     A
024C F0                MOVX    @DPTR,A
024D A3                INC     DPTR
024E EB                MOV     A,R3
024F F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 239
0250 7400        E     MOV     A,#LOW IMU_connected
0252 2E                ADD     A,R6
0253 F582              MOV     DPL,A
0255 E4                CLR     A
0256 3400        E     ADDC    A,#HIGH IMU_connected
0258 F583              MOV     DPH,A
025A E0                MOVX    A,@DPTR
025B 25E0              ADD     A,ACC
025D 2400        E     ADD     A,#LOW single_imu_size
025F F582              MOV     DPL,A
0261 E4                CLR     A
0262 3400        E     ADDC    A,#HIGH single_imu_size
0264 F583              MOV     DPH,A
0266 E0                MOVX    A,@DPTR
0267 FE                MOV     R6,A
0268 A3                INC     DPTR
0269 E0                MOVX    A,@DPTR
026A FF                MOV     R7,A
026B 900000      E     MOV     DPTR,#imus_data_size+01H
026E E0                MOVX    A,@DPTR
026F 2F                ADD     A,R7
0270 F0                MOVX    @DPTR,A
0271 900000      E     MOV     DPTR,#imus_data_size
0274 E0                MOVX    A,@DPTR
0275 3E                ADDC    A,R6
0276 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 240
0277 900000      R     MOV     DPTR,#k_imu
027A E0                MOVX    A,@DPTR
027B 04                INC     A
027C F0                MOVX    @DPTR,A
027D 020000      R     LJMP    ?C0023
0280         ?C0024:
                                           ; SOURCE LINE # 241
0280 900000      E     MOV     DPTR,#imus_data_size+01H
0283 E0                MOVX    A,@DPTR
0284 04                INC     A
0285 F0                MOVX    @DPTR,A
0286 7006              JNZ     ?C0077
0288 900000      E     MOV     DPTR,#imus_data_size
028B E0                MOVX    A,@DPTR
028C 04                INC     A
028D F0                MOVX    @DPTR,A
028E         ?C0077:
                                           ; SOURCE LINE # 242
028E 22                RET     
             ; FUNCTION InitIMUgeneral (END)

             ; FUNCTION _ReadIMU (BEGIN)
                                           ; SOURCE LINE # 247
0000 900000      R     MOV     DPTR,#n
0003 EE                MOV     A,R6
0004 F0                MOVX    @DPTR,A
C51 COMPILER V9.51   IMU_FUNCTIONS                                                         02/16/2018 15:56:04 PAGE 26  

0005 A3                INC     DPTR
0006 EF                MOV     A,R7
0007 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 248
                                           ; SOURCE LINE # 249
0008 900000      E     MOV     DPTR,#c_mem+04H
000B 75F005            MOV     B,#05H
000E 120000      E     LCALL   ?C?OFFXADD
0011 EE                MOV     A,R6
0012 75F005            MOV     B,#05H
0015 A4                MUL     AB
0016 2583              ADD     A,DPH
0018 F583              MOV     DPH,A
001A E0                MOVX    A,@DPTR
001B 600B              JZ      ?C0027
001D 900000      R     MOV     DPTR,#n
0020 E0                MOVX    A,@DPTR
0021 FE                MOV     R6,A
0022 A3                INC     DPTR
0023 E0                MOVX    A,@DPTR
0024 FF                MOV     R7,A
0025 120000      R     LCALL   _ReadAcc
0028         ?C0027:
                                           ; SOURCE LINE # 250
0028 900000      R     MOV     DPTR,#n
002B E0                MOVX    A,@DPTR
002C FE                MOV     R6,A
002D A3                INC     DPTR
002E E0                MOVX    A,@DPTR
002F FF                MOV     R7,A
0030 900000      E     MOV     DPTR,#c_mem+05H
0033 75F005            MOV     B,#05H
0036 120000      E     LCALL   ?C?OFFXADD
0039 EE                MOV     A,R6
003A 75F005            MOV     B,#05H
003D A4                MUL     AB
003E 2583              ADD     A,DPH
0040 F583              MOV     DPH,A
0042 E0                MOVX    A,@DPTR
0043 6003              JZ      ?C0028
0045 120000      R     LCALL   _ReadGyro
0048         ?C0028:
                                           ; SOURCE LINE # 251
0048 900000      R     MOV     DPTR,#n
004B E0                MOVX    A,@DPTR
004C FE                MOV     R6,A
004D A3                INC     DPTR
004E E0                MOVX    A,@DPTR
004F FF                MOV     R7,A
0050 900000      E     MOV     DPTR,#c_mem+06H
0053 75F005            MOV     B,#05H
0056 120000      E     LCALL   ?C?OFFXADD
0059 EE                MOV     A,R6
005A 75F005            MOV     B,#05H
005D A4                MUL     AB
005E 2583              ADD     A,DPH
0060 F583              MOV     DPH,A
0062 E0                MOVX    A,@DPTR
0063 6003              JZ      ?C0029
0065 120000      R     LCALL   _ReadMag
0068         ?C0029:
                                           ; SOURCE LINE # 252
C51 COMPILER V9.51   IMU_FUNCTIONS                                                         02/16/2018 15:56:04 PAGE 27  

0068 900000      R     MOV     DPTR,#n
006B E0                MOVX    A,@DPTR
006C FE                MOV     R6,A
006D A3                INC     DPTR
006E E0                MOVX    A,@DPTR
006F FF                MOV     R7,A
0070 900000      E     MOV     DPTR,#c_mem+07H
0073 75F005            MOV     B,#05H
0076 120000      E     LCALL   ?C?OFFXADD
0079 EE                MOV     A,R6
007A 75F005            MOV     B,#05H
007D A4                MUL     AB
007E 2583              ADD     A,DPH
0080 F583              MOV     DPH,A
0082 E0                MOVX    A,@DPTR
0083 6003              JZ      ?C0030
0085 120000      R     LCALL   _ReadQuat
0088         ?C0030:
                                           ; SOURCE LINE # 253
0088 900000      R     MOV     DPTR,#n
008B E0                MOVX    A,@DPTR
008C FE                MOV     R6,A
008D A3                INC     DPTR
008E E0                MOVX    A,@DPTR
008F FF                MOV     R7,A
0090 900000      E     MOV     DPTR,#c_mem+08H
0093 75F005            MOV     B,#05H
0096 120000      E     LCALL   ?C?OFFXADD
0099 EE                MOV     A,R6
009A 75F005            MOV     B,#05H
009D A4                MUL     AB
009E 2583              ADD     A,DPH
00A0 F583              MOV     DPH,A
00A2 E0                MOVX    A,@DPTR
00A3 6003              JZ      ?C0032
00A5 120000      R     LCALL   _ReadTemp
                                           ; SOURCE LINE # 254
00A8         ?C0032:
00A8 22                RET     
             ; FUNCTION _ReadIMU (END)

             ; FUNCTION _ReadAcc (BEGIN)
                                           ; SOURCE LINE # 259
;---- Variable 'n' assigned to Register 'R6/R7' ----
                                           ; SOURCE LINE # 260
                                           ; SOURCE LINE # 261
0000 E4                CLR     A
0001 900000      R     MOV     DPTR,#low
0004 F0                MOVX    @DPTR,A
0005 A3                INC     DPTR
0006 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 263
0007 A3                INC     DPTR
0008 EE                MOV     A,R6
0009 F0                MOVX    @DPTR,A
000A A3                INC     DPTR
000B EF                MOV     A,R7
000C F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 266
000D 7F3C              MOV     R7,#03CH
000F 120000      R     LCALL   _ReadControlRegister
0012 900000      R     MOV     DPTR,#low
C51 COMPILER V9.51   IMU_FUNCTIONS                                                         02/16/2018 15:56:04 PAGE 28  

0015 EF                MOV     A,R7
0016 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 267
0017 120000      R     LCALL   SPI_delay
                                           ; SOURCE LINE # 268
001A 7F3B              MOV     R7,#03BH
001C 120000      R     LCALL   _ReadControlRegister
001F 900000      R     MOV     DPTR,#high
0022 EF                MOV     A,R7
0023 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 269
0024 120000      R     LCALL   SPI_delay
                                           ; SOURCE LINE # 271
0027 900000      R     MOV     DPTR,#high
002A E0                MOVX    A,@DPTR
002B FF                MOV     R7,A
002C A3                INC     DPTR
002D E0                MOVX    A,@DPTR
002E FC                MOV     R4,A
002F A3                INC     DPTR
0030 E0                MOVX    A,@DPTR
0031 FD                MOV     R5,A
0032 900000      E     MOV     DPTR,#Accel
0035 75F006            MOV     B,#06H
0038 120000      E     LCALL   ?C?OFFXADD
003B EC                MOV     A,R4
003C 75F006            MOV     B,#06H
003F A4                MUL     AB
0040 2583              ADD     A,DPH
0042 F583              MOV     DPH,A
0044 EF                MOV     A,R7
0045 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 272
0046 900000      R     MOV     DPTR,#low
0049 E0                MOVX    A,@DPTR
004A FF                MOV     R7,A
004B 900000      E     MOV     DPTR,#Accel+01H
004E 75F006            MOV     B,#06H
0051 ED                MOV     A,R5
0052 120000      E     LCALL   ?C?OFFXADD
0055 EC                MOV     A,R4
0056 75F006            MOV     B,#06H
0059 A4                MUL     AB
005A 2583              ADD     A,DPH
005C F583              MOV     DPH,A
005E EF                MOV     A,R7
005F F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 273
0060 E4                CLR     A
0061 900000      R     MOV     DPTR,#low
0064 F0                MOVX    @DPTR,A
0065 A3                INC     DPTR
0066 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 276
0067 7F3E              MOV     R7,#03EH
0069 120000      R     LCALL   _ReadControlRegister
006C 900000      R     MOV     DPTR,#low
006F EF                MOV     A,R7
0070 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 277
0071 120000      R     LCALL   SPI_delay
                                           ; SOURCE LINE # 278
C51 COMPILER V9.51   IMU_FUNCTIONS                                                         02/16/2018 15:56:04 PAGE 29  

0074 7F3D              MOV     R7,#03DH
0076 120000      R     LCALL   _ReadControlRegister
0079 900000      R     MOV     DPTR,#high
007C EF                MOV     A,R7
007D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 279
007E 120000      R     LCALL   SPI_delay
                                           ; SOURCE LINE # 281
0081 900000      R     MOV     DPTR,#high
0084 E0                MOVX    A,@DPTR
0085 FF                MOV     R7,A
0086 A3                INC     DPTR
0087 E0                MOVX    A,@DPTR
0088 FC                MOV     R4,A
0089 A3                INC     DPTR
008A E0                MOVX    A,@DPTR
008B FD                MOV     R5,A
008C 900000      E     MOV     DPTR,#Accel+02H
008F 75F006            MOV     B,#06H
0092 120000      E     LCALL   ?C?OFFXADD
0095 EC                MOV     A,R4
0096 75F006            MOV     B,#06H
0099 A4                MUL     AB
009A 2583              ADD     A,DPH
009C F583              MOV     DPH,A
009E EF                MOV     A,R7
009F F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 282
00A0 900000      R     MOV     DPTR,#low
00A3 E0                MOVX    A,@DPTR
00A4 FF                MOV     R7,A
00A5 900000      E     MOV     DPTR,#Accel+03H
00A8 75F006            MOV     B,#06H
00AB ED                MOV     A,R5
00AC 120000      E     LCALL   ?C?OFFXADD
00AF EC                MOV     A,R4
00B0 75F006            MOV     B,#06H
00B3 A4                MUL     AB
00B4 2583              ADD     A,DPH
00B6 F583              MOV     DPH,A
00B8 EF                MOV     A,R7
00B9 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 283
00BA E4                CLR     A
00BB 900000      R     MOV     DPTR,#low
00BE F0                MOVX    @DPTR,A
00BF A3                INC     DPTR
00C0 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 286
00C1 7F40              MOV     R7,#040H
00C3 120000      R     LCALL   _ReadControlRegister
00C6 900000      R     MOV     DPTR,#low
00C9 EF                MOV     A,R7
00CA F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 287
00CB 120000      R     LCALL   SPI_delay
                                           ; SOURCE LINE # 288
00CE 7F3F              MOV     R7,#03FH
00D0 120000      R     LCALL   _ReadControlRegister
00D3 900000      R     MOV     DPTR,#high
00D6 EF                MOV     A,R7
00D7 F0                MOVX    @DPTR,A
C51 COMPILER V9.51   IMU_FUNCTIONS                                                         02/16/2018 15:56:04 PAGE 30  

                                           ; SOURCE LINE # 289
00D8 120000      R     LCALL   SPI_delay
                                           ; SOURCE LINE # 291
00DB 900000      R     MOV     DPTR,#high
00DE E0                MOVX    A,@DPTR
00DF FF                MOV     R7,A
00E0 A3                INC     DPTR
00E1 E0                MOVX    A,@DPTR
00E2 FC                MOV     R4,A
00E3 A3                INC     DPTR
00E4 E0                MOVX    A,@DPTR
00E5 FD                MOV     R5,A
00E6 900000      E     MOV     DPTR,#Accel+04H
00E9 75F006            MOV     B,#06H
00EC 120000      E     LCALL   ?C?OFFXADD
00EF EC                MOV     A,R4
00F0 75F006            MOV     B,#06H
00F3 A4                MUL     AB
00F4 2583              ADD     A,DPH
00F6 F583              MOV     DPH,A
00F8 EF                MOV     A,R7
00F9 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 292
00FA 900000      R     MOV     DPTR,#low
00FD E0                MOVX    A,@DPTR
00FE FF                MOV     R7,A
00FF 900000      E     MOV     DPTR,#Accel+05H
0102 75F006            MOV     B,#06H
0105 ED                MOV     A,R5
0106 120000      E     LCALL   ?C?OFFXADD
0109 EC                MOV     A,R4
010A 75F006            MOV     B,#06H
010D A4                MUL     AB
010E 2583              ADD     A,DPH
0110 F583              MOV     DPH,A
0112 EF                MOV     A,R7
0113 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 293
0114 E4                CLR     A
0115 900000      R     MOV     DPTR,#low
0118 F0                MOVX    @DPTR,A
0119 A3                INC     DPTR
011A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 294
011B 22                RET     
             ; FUNCTION _ReadAcc (END)

             ; FUNCTION _ReadGyro (BEGIN)
                                           ; SOURCE LINE # 299
;---- Variable 'n' assigned to Register 'R6/R7' ----
                                           ; SOURCE LINE # 300
0000 E4                CLR     A
0001 900000      R     MOV     DPTR,#low
0004 F0                MOVX    @DPTR,A
0005 A3                INC     DPTR
0006 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 302
0007 A3                INC     DPTR
0008 EE                MOV     A,R6
0009 F0                MOVX    @DPTR,A
000A A3                INC     DPTR
000B EF                MOV     A,R7
C51 COMPILER V9.51   IMU_FUNCTIONS                                                         02/16/2018 15:56:04 PAGE 31  

000C F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 305
000D 7F44              MOV     R7,#044H
000F 120000      R     LCALL   _ReadControlRegister
0012 900000      R     MOV     DPTR,#low
0015 EF                MOV     A,R7
0016 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 306
0017 120000      R     LCALL   SPI_delay
                                           ; SOURCE LINE # 307
001A 7F43              MOV     R7,#043H
001C 120000      R     LCALL   _ReadControlRegister
001F 900000      R     MOV     DPTR,#high
0022 EF                MOV     A,R7
0023 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 308
0024 120000      R     LCALL   SPI_delay
                                           ; SOURCE LINE # 310
0027 900000      R     MOV     DPTR,#high
002A E0                MOVX    A,@DPTR
002B FF                MOV     R7,A
002C A3                INC     DPTR
002D E0                MOVX    A,@DPTR
002E FC                MOV     R4,A
002F A3                INC     DPTR
0030 E0                MOVX    A,@DPTR
0031 FD                MOV     R5,A
0032 900000      E     MOV     DPTR,#Gyro
0035 75F006            MOV     B,#06H
0038 120000      E     LCALL   ?C?OFFXADD
003B EC                MOV     A,R4
003C 75F006            MOV     B,#06H
003F A4                MUL     AB
0040 2583              ADD     A,DPH
0042 F583              MOV     DPH,A
0044 EF                MOV     A,R7
0045 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 311
0046 900000      R     MOV     DPTR,#low
0049 E0                MOVX    A,@DPTR
004A FF                MOV     R7,A
004B 900000      E     MOV     DPTR,#Gyro+01H
004E 75F006            MOV     B,#06H
0051 ED                MOV     A,R5
0052 120000      E     LCALL   ?C?OFFXADD
0055 EC                MOV     A,R4
0056 75F006            MOV     B,#06H
0059 A4                MUL     AB
005A 2583              ADD     A,DPH
005C F583              MOV     DPH,A
005E EF                MOV     A,R7
005F F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 312
0060 E4                CLR     A
0061 900000      R     MOV     DPTR,#low
0064 F0                MOVX    @DPTR,A
0065 A3                INC     DPTR
0066 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 315
0067 7F46              MOV     R7,#046H
0069 120000      R     LCALL   _ReadControlRegister
006C 900000      R     MOV     DPTR,#low
C51 COMPILER V9.51   IMU_FUNCTIONS                                                         02/16/2018 15:56:04 PAGE 32  

006F EF                MOV     A,R7
0070 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 316
0071 120000      R     LCALL   SPI_delay
                                           ; SOURCE LINE # 317
0074 7F45              MOV     R7,#045H
0076 120000      R     LCALL   _ReadControlRegister
0079 900000      R     MOV     DPTR,#high
007C EF                MOV     A,R7
007D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 318
007E 120000      R     LCALL   SPI_delay
                                           ; SOURCE LINE # 320
0081 900000      R     MOV     DPTR,#high
0084 E0                MOVX    A,@DPTR
0085 FF                MOV     R7,A
0086 A3                INC     DPTR
0087 E0                MOVX    A,@DPTR
0088 FC                MOV     R4,A
0089 A3                INC     DPTR
008A E0                MOVX    A,@DPTR
008B FD                MOV     R5,A
008C 900000      E     MOV     DPTR,#Gyro+02H
008F 75F006            MOV     B,#06H
0092 120000      E     LCALL   ?C?OFFXADD
0095 EC                MOV     A,R4
0096 75F006            MOV     B,#06H
0099 A4                MUL     AB
009A 2583              ADD     A,DPH
009C F583              MOV     DPH,A
009E EF                MOV     A,R7
009F F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 321
00A0 900000      R     MOV     DPTR,#low
00A3 E0                MOVX    A,@DPTR
00A4 FF                MOV     R7,A
00A5 900000      E     MOV     DPTR,#Gyro+03H
00A8 75F006            MOV     B,#06H
00AB ED                MOV     A,R5
00AC 120000      E     LCALL   ?C?OFFXADD
00AF EC                MOV     A,R4
00B0 75F006            MOV     B,#06H
00B3 A4                MUL     AB
00B4 2583              ADD     A,DPH
00B6 F583              MOV     DPH,A
00B8 EF                MOV     A,R7
00B9 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 322
00BA E4                CLR     A
00BB 900000      R     MOV     DPTR,#low
00BE F0                MOVX    @DPTR,A
00BF A3                INC     DPTR
00C0 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 325
00C1 7F48              MOV     R7,#048H
00C3 120000      R     LCALL   _ReadControlRegister
00C6 900000      R     MOV     DPTR,#low
00C9 EF                MOV     A,R7
00CA F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 326
00CB 120000      R     LCALL   SPI_delay
                                           ; SOURCE LINE # 327
C51 COMPILER V9.51   IMU_FUNCTIONS                                                         02/16/2018 15:56:04 PAGE 33  

00CE 7F47              MOV     R7,#047H
00D0 120000      R     LCALL   _ReadControlRegister
00D3 900000      R     MOV     DPTR,#high
00D6 EF                MOV     A,R7
00D7 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 328
00D8 120000      R     LCALL   SPI_delay
                                           ; SOURCE LINE # 330
00DB 900000      R     MOV     DPTR,#high
00DE E0                MOVX    A,@DPTR
00DF FF                MOV     R7,A
00E0 A3                INC     DPTR
00E1 E0                MOVX    A,@DPTR
00E2 FC                MOV     R4,A
00E3 A3                INC     DPTR
00E4 E0                MOVX    A,@DPTR
00E5 FD                MOV     R5,A
00E6 900000      E     MOV     DPTR,#Gyro+04H
00E9 75F006            MOV     B,#06H
00EC 120000      E     LCALL   ?C?OFFXADD
00EF EC                MOV     A,R4
00F0 75F006            MOV     B,#06H
00F3 A4                MUL     AB
00F4 2583              ADD     A,DPH
00F6 F583              MOV     DPH,A
00F8 EF                MOV     A,R7
00F9 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 331
00FA 900000      R     MOV     DPTR,#low
00FD E0                MOVX    A,@DPTR
00FE FF                MOV     R7,A
00FF 900000      E     MOV     DPTR,#Gyro+05H
0102 75F006            MOV     B,#06H
0105 ED                MOV     A,R5
0106 120000      E     LCALL   ?C?OFFXADD
0109 EC                MOV     A,R4
010A 75F006            MOV     B,#06H
010D A4                MUL     AB
010E 2583              ADD     A,DPH
0110 F583              MOV     DPH,A
0112 EF                MOV     A,R7
0113 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 333
0114 E4                CLR     A
0115 900000      R     MOV     DPTR,#low
0118 F0                MOVX    @DPTR,A
0119 A3                INC     DPTR
011A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 334
011B 22                RET     
             ; FUNCTION _ReadGyro (END)

             ; FUNCTION _ReadMag (BEGIN)
                                           ; SOURCE LINE # 339
;---- Variable 'n' assigned to Register 'R6/R7' ----
                                           ; SOURCE LINE # 342
0000 900000      R     MOV     DPTR,#row
0003 EE                MOV     A,R6
0004 F0                MOVX    @DPTR,A
0005 A3                INC     DPTR
0006 EF                MOV     A,R7
0007 F0                MOVX    @DPTR,A
C51 COMPILER V9.51   IMU_FUNCTIONS                                                         02/16/2018 15:56:04 PAGE 34  

                                           ; SOURCE LINE # 344
0008 7F49              MOV     R7,#049H
000A 120000      R     LCALL   _ReadControlRegister
000D 900000      R     MOV     DPTR,#low
0010 EF                MOV     A,R7
0011 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 345
0012 120000      R     LCALL   SPI_delay
                                           ; SOURCE LINE # 346
0015 7F4A              MOV     R7,#04AH
0017 120000      R     LCALL   _ReadControlRegister
001A 900000      R     MOV     DPTR,#high
001D EF                MOV     A,R7
001E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 347
001F 120000      R     LCALL   SPI_delay
                                           ; SOURCE LINE # 349
0022 900000      R     MOV     DPTR,#high
0025 E0                MOVX    A,@DPTR
0026 FF                MOV     R7,A
0027 A3                INC     DPTR
0028 E0                MOVX    A,@DPTR
0029 FC                MOV     R4,A
002A A3                INC     DPTR
002B E0                MOVX    A,@DPTR
002C FD                MOV     R5,A
002D 900000      E     MOV     DPTR,#Mag
0030 75F006            MOV     B,#06H
0033 120000      E     LCALL   ?C?OFFXADD
0036 EC                MOV     A,R4
0037 75F006            MOV     B,#06H
003A A4                MUL     AB
003B 2583              ADD     A,DPH
003D F583              MOV     DPH,A
003F EF                MOV     A,R7
0040 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 350
0041 900000      R     MOV     DPTR,#low
0044 E0                MOVX    A,@DPTR
0045 FF                MOV     R7,A
0046 900000      E     MOV     DPTR,#Mag+01H
0049 75F006            MOV     B,#06H
004C ED                MOV     A,R5
004D 120000      E     LCALL   ?C?OFFXADD
0050 EC                MOV     A,R4
0051 75F006            MOV     B,#06H
0054 A4                MUL     AB
0055 2583              ADD     A,DPH
0057 F583              MOV     DPH,A
0059 EF                MOV     A,R7
005A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 351
005B E4                CLR     A
005C 900000      R     MOV     DPTR,#low
005F F0                MOVX    @DPTR,A
0060 A3                INC     DPTR
0061 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 354
0062 7F4B              MOV     R7,#04BH
0064 120000      R     LCALL   _ReadControlRegister
0067 900000      R     MOV     DPTR,#low
006A EF                MOV     A,R7
C51 COMPILER V9.51   IMU_FUNCTIONS                                                         02/16/2018 15:56:04 PAGE 35  

006B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 355
006C 120000      R     LCALL   SPI_delay
                                           ; SOURCE LINE # 356
006F 7F4C              MOV     R7,#04CH
0071 120000      R     LCALL   _ReadControlRegister
0074 900000      R     MOV     DPTR,#high
0077 EF                MOV     A,R7
0078 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 357
0079 120000      R     LCALL   SPI_delay
                                           ; SOURCE LINE # 359
007C 900000      R     MOV     DPTR,#high
007F E0                MOVX    A,@DPTR
0080 FF                MOV     R7,A
0081 A3                INC     DPTR
0082 E0                MOVX    A,@DPTR
0083 FC                MOV     R4,A
0084 A3                INC     DPTR
0085 E0                MOVX    A,@DPTR
0086 FD                MOV     R5,A
0087 900000      E     MOV     DPTR,#Mag+02H
008A 75F006            MOV     B,#06H
008D 120000      E     LCALL   ?C?OFFXADD
0090 EC                MOV     A,R4
0091 75F006            MOV     B,#06H
0094 A4                MUL     AB
0095 2583              ADD     A,DPH
0097 F583              MOV     DPH,A
0099 EF                MOV     A,R7
009A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 360
009B 900000      R     MOV     DPTR,#low
009E E0                MOVX    A,@DPTR
009F FF                MOV     R7,A
00A0 900000      E     MOV     DPTR,#Mag+03H
00A3 75F006            MOV     B,#06H
00A6 ED                MOV     A,R5
00A7 120000      E     LCALL   ?C?OFFXADD
00AA EC                MOV     A,R4
00AB 75F006            MOV     B,#06H
00AE A4                MUL     AB
00AF 2583              ADD     A,DPH
00B1 F583              MOV     DPH,A
00B3 EF                MOV     A,R7
00B4 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 361
00B5 E4                CLR     A
00B6 900000      R     MOV     DPTR,#low
00B9 F0                MOVX    @DPTR,A
00BA A3                INC     DPTR
00BB F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 364
00BC 7F4D              MOV     R7,#04DH
00BE 120000      R     LCALL   _ReadControlRegister
00C1 900000      R     MOV     DPTR,#low
00C4 EF                MOV     A,R7
00C5 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 365
00C6 120000      R     LCALL   SPI_delay
                                           ; SOURCE LINE # 366
00C9 7F4E              MOV     R7,#04EH
C51 COMPILER V9.51   IMU_FUNCTIONS                                                         02/16/2018 15:56:04 PAGE 36  

00CB 120000      R     LCALL   _ReadControlRegister
00CE 900000      R     MOV     DPTR,#high
00D1 EF                MOV     A,R7
00D2 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 367
00D3 120000      R     LCALL   SPI_delay
                                           ; SOURCE LINE # 369
00D6 900000      R     MOV     DPTR,#high
00D9 E0                MOVX    A,@DPTR
00DA FF                MOV     R7,A
00DB A3                INC     DPTR
00DC E0                MOVX    A,@DPTR
00DD FC                MOV     R4,A
00DE A3                INC     DPTR
00DF E0                MOVX    A,@DPTR
00E0 FD                MOV     R5,A
00E1 900000      E     MOV     DPTR,#Mag+04H
00E4 75F006            MOV     B,#06H
00E7 120000      E     LCALL   ?C?OFFXADD
00EA EC                MOV     A,R4
00EB 75F006            MOV     B,#06H
00EE A4                MUL     AB
00EF 2583              ADD     A,DPH
00F1 F583              MOV     DPH,A
00F3 EF                MOV     A,R7
00F4 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 370
00F5 900000      R     MOV     DPTR,#low
00F8 E0                MOVX    A,@DPTR
00F9 FF                MOV     R7,A
00FA 900000      E     MOV     DPTR,#Mag+05H
00FD 75F006            MOV     B,#06H
0100 ED                MOV     A,R5
0101 120000      E     LCALL   ?C?OFFXADD
0104 EC                MOV     A,R4
0105 75F006            MOV     B,#06H
0108 A4                MUL     AB
0109 2583              ADD     A,DPH
010B F583              MOV     DPH,A
010D EF                MOV     A,R7
010E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 371
010F E4                CLR     A
0110 900000      R     MOV     DPTR,#low
0113 F0                MOVX    @DPTR,A
0114 A3                INC     DPTR
0115 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 372
0116 22                RET     
             ; FUNCTION _ReadMag (END)

             ; FUNCTION _ReadMagCal (BEGIN)
                                           ; SOURCE LINE # 377
;---- Variable 'n' assigned to Register 'R6/R7' ----
                                           ; SOURCE LINE # 379
0000 E4                CLR     A
0001 900000      R     MOV     DPTR,#read
0004 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 380
0005 A3                INC     DPTR
0006 EE                MOV     A,R6
0007 F0                MOVX    @DPTR,A
C51 COMPILER V9.51   IMU_FUNCTIONS                                                         02/16/2018 15:56:04 PAGE 37  

0008 A3                INC     DPTR
0009 EF                MOV     A,R7
000A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 382
000B 7F49              MOV     R7,#049H
000D 120000      R     LCALL   _ReadControlRegister
0010 900000      R     MOV     DPTR,#read
0013 EF                MOV     A,R7
0014 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 383
0015 A3                INC     DPTR
0016 E0                MOVX    A,@DPTR
0017 FC                MOV     R4,A
0018 A3                INC     DPTR
0019 E0                MOVX    A,@DPTR
001A 900000      E     MOV     DPTR,#MagCal
001D 75F003            MOV     B,#03H
0020 120000      E     LCALL   ?C?OFFXADD
0023 EC                MOV     A,R4
0024 75F003            MOV     B,#03H
0027 A4                MUL     AB
0028 2583              ADD     A,DPH
002A F583              MOV     DPH,A
002C EF                MOV     A,R7
002D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 384
002E E4                CLR     A
002F 900000      R     MOV     DPTR,#read
0032 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 387
0033 7F4A              MOV     R7,#04AH
0035 120000      R     LCALL   _ReadControlRegister
0038 900000      R     MOV     DPTR,#read
003B EF                MOV     A,R7
003C F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 388
003D A3                INC     DPTR
003E E0                MOVX    A,@DPTR
003F FC                MOV     R4,A
0040 A3                INC     DPTR
0041 E0                MOVX    A,@DPTR
0042 900000      E     MOV     DPTR,#MagCal+01H
0045 75F003            MOV     B,#03H
0048 120000      E     LCALL   ?C?OFFXADD
004B EC                MOV     A,R4
004C 75F003            MOV     B,#03H
004F A4                MUL     AB
0050 2583              ADD     A,DPH
0052 F583              MOV     DPH,A
0054 EF                MOV     A,R7
0055 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 389
0056 E4                CLR     A
0057 900000      R     MOV     DPTR,#read
005A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 392
005B 7F4B              MOV     R7,#04BH
005D 120000      R     LCALL   _ReadControlRegister
0060 900000      R     MOV     DPTR,#read
0063 EF                MOV     A,R7
0064 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 393
C51 COMPILER V9.51   IMU_FUNCTIONS                                                         02/16/2018 15:56:04 PAGE 38  

0065 A3                INC     DPTR
0066 E0                MOVX    A,@DPTR
0067 FC                MOV     R4,A
0068 A3                INC     DPTR
0069 E0                MOVX    A,@DPTR
006A 900000      E     MOV     DPTR,#MagCal+02H
006D 75F003            MOV     B,#03H
0070 120000      E     LCALL   ?C?OFFXADD
0073 EC                MOV     A,R4
0074 75F003            MOV     B,#03H
0077 A4                MUL     AB
0078 2583              ADD     A,DPH
007A F583              MOV     DPH,A
007C EF                MOV     A,R7
007D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 394
007E E4                CLR     A
007F 900000      R     MOV     DPTR,#read
0082 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 396
0083 22                RET     
             ; FUNCTION _ReadMagCal (END)

             ; FUNCTION _ReadQuat (BEGIN)
                                           ; SOURCE LINE # 401
0000 900000      R     MOV     DPTR,#n
0003 EE                MOV     A,R6
0004 F0                MOVX    @DPTR,A
0005 A3                INC     DPTR
0006 EF                MOV     A,R7
0007 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 402
                                           ; SOURCE LINE # 403
0008 E4                CLR     A
0009 A3                INC     DPTR
000A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 408
000B FF                MOV     R7,A
000C FE                MOV     R6,A
000D FD                MOV     R5,A
000E FC                MOV     R4,A
000F 900000      R     MOV     DPTR,#time
0012 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 410
0015 900000      E     MOV     DPTR,#N_IMU_Connected
0018 E0                MOVX    A,@DPTR
0019 6401              XRL     A,#01H
001B 6003              JZ      $ + 5H
001D 020000      R     LJMP    ?C0044
                                           ; SOURCE LINE # 413
0020 900000      R     MOV     DPTR,#n
0023 E0                MOVX    A,@DPTR
0024 FE                MOV     R6,A
0025 A3                INC     DPTR
0026 E0                MOVX    A,@DPTR
0027 FF                MOV     R7,A
0028 900000      E     MOV     DPTR,#c_mem+04H
002B 75F005            MOV     B,#05H
002E 120000      E     LCALL   ?C?OFFXADD
0031 EE                MOV     A,R6
0032 75F005            MOV     B,#05H
0035 A4                MUL     AB
C51 COMPILER V9.51   IMU_FUNCTIONS                                                         02/16/2018 15:56:04 PAGE 39  

0036 2583              ADD     A,DPH
0038 F583              MOV     DPH,A
003A E0                MOVX    A,@DPTR
003B 7003              JNZ     ?C0038
003D 120000      R     LCALL   _ReadAcc
0040         ?C0038:
                                           ; SOURCE LINE # 414
0040 900000      R     MOV     DPTR,#n
0043 E0                MOVX    A,@DPTR
0044 FE                MOV     R6,A
0045 A3                INC     DPTR
0046 E0                MOVX    A,@DPTR
0047 FF                MOV     R7,A
0048 900000      E     MOV     DPTR,#c_mem+05H
004B 75F005            MOV     B,#05H
004E 120000      E     LCALL   ?C?OFFXADD
0051 EE                MOV     A,R6
0052 75F005            MOV     B,#05H
0055 A4                MUL     AB
0056 2583              ADD     A,DPH
0058 F583              MOV     DPH,A
005A E0                MOVX    A,@DPTR
005B 7003              JNZ     ?C0039
005D 120000      R     LCALL   _ReadGyro
0060         ?C0039:
                                           ; SOURCE LINE # 418
0060 900000      E     MOV     DPTR,#timer_value
0063 E0                MOVX    A,@DPTR
0064 F8                MOV     R0,A
0065 A3                INC     DPTR
0066 E0                MOVX    A,@DPTR
0067 F9                MOV     R1,A
0068 A3                INC     DPTR
0069 E0                MOVX    A,@DPTR
006A FA                MOV     R2,A
006B A3                INC     DPTR
006C E0                MOVX    A,@DPTR
006D FB                MOV     R3,A
006E 900000      E     MOV     DPTR,#timer_value0
0071 E0                MOVX    A,@DPTR
0072 FC                MOV     R4,A
0073 A3                INC     DPTR
0074 E0                MOVX    A,@DPTR
0075 FD                MOV     R5,A
0076 A3                INC     DPTR
0077 E0                MOVX    A,@DPTR
0078 FE                MOV     R6,A
0079 A3                INC     DPTR
007A E0                MOVX    A,@DPTR
007B C3                CLR     C
007C 9B                SUBB    A,R3
007D FF                MOV     R7,A
007E EE                MOV     A,R6
007F 9A                SUBB    A,R2
0080 FE                MOV     R6,A
0081 ED                MOV     A,R5
0082 99                SUBB    A,R1
0083 FD                MOV     R5,A
0084 EC                MOV     A,R4
0085 98                SUBB    A,R0
0086 FC                MOV     R4,A
0087 E4                CLR     A
C51 COMPILER V9.51   IMU_FUNCTIONS                                                         02/16/2018 15:56:04 PAGE 40  

0088 120000      E     LCALL   ?C?FCASTL
008B 7B00              MOV     R3,#00H
008D 7A24              MOV     R2,#024H
008F 7974              MOV     R1,#074H
0091 7849              MOV     R0,#049H
0093 120000      E     LCALL   ?C?FPDIV
0096 900000      R     MOV     DPTR,#time
0099 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 423
009C 900000      R     MOV     DPTR,#n
009F E0                MOVX    A,@DPTR
00A0 FE                MOV     R6,A
00A1 A3                INC     DPTR
00A2 E0                MOVX    A,@DPTR
00A3 FF                MOV     R7,A
00A4 900000      E     MOV     DPTR,#Accel
00A7 75F006            MOV     B,#06H
00AA 120000      E     LCALL   ?C?OFFXADD
00AD EE                MOV     A,R6
00AE 75F006            MOV     B,#06H
00B1 A4                MUL     AB
00B2 2583              ADD     A,DPH
00B4 F583              MOV     DPH,A
00B6 E0                MOVX    A,@DPTR
00B7 FD                MOV     R5,A
00B8 900000      R     MOV     DPTR,#var_h
00BB E4                CLR     A
00BC F0                MOVX    @DPTR,A
00BD A3                INC     DPTR
00BE ED                MOV     A,R5
00BF F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 424
00C0 900000      E     MOV     DPTR,#Accel+01H
00C3 75F006            MOV     B,#06H
00C6 EF                MOV     A,R7
00C7 120000      E     LCALL   ?C?OFFXADD
00CA EE                MOV     A,R6
00CB 75F006            MOV     B,#06H
00CE A4                MUL     AB
00CF 2583              ADD     A,DPH
00D1 F583              MOV     DPH,A
00D3 E0                MOVX    A,@DPTR
00D4 FD                MOV     R5,A
00D5 900000      R     MOV     DPTR,#var_h+01H
00D8 E0                MOVX    A,@DPTR
00D9 FC                MOV     R4,A
00DA ED                MOV     A,R5
00DB EC                MOV     A,R4
00DC 120000      E     LCALL   ?C?FCASTI
00DF 900000      R     MOV     DPTR,#aP
00E2 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 425
00E5 900000      R     MOV     DPTR,#n
00E8 E0                MOVX    A,@DPTR
00E9 FE                MOV     R6,A
00EA A3                INC     DPTR
00EB E0                MOVX    A,@DPTR
00EC FF                MOV     R7,A
00ED 900000      E     MOV     DPTR,#Accel+02H
00F0 75F006            MOV     B,#06H
00F3 120000      E     LCALL   ?C?OFFXADD
00F6 EE                MOV     A,R6
C51 COMPILER V9.51   IMU_FUNCTIONS                                                         02/16/2018 15:56:04 PAGE 41  

00F7 75F006            MOV     B,#06H
00FA A4                MUL     AB
00FB 2583              ADD     A,DPH
00FD F583              MOV     DPH,A
00FF E0                MOVX    A,@DPTR
0100 FD                MOV     R5,A
0101 900000      R     MOV     DPTR,#var_h
0104 E4                CLR     A
0105 F0                MOVX    @DPTR,A
0106 A3                INC     DPTR
0107 ED                MOV     A,R5
0108 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 426
0109 900000      E     MOV     DPTR,#Accel+03H
010C 75F006            MOV     B,#06H
010F EF                MOV     A,R7
0110 120000      E     LCALL   ?C?OFFXADD
0113 EE                MOV     A,R6
0114 75F006            MOV     B,#06H
0117 A4                MUL     AB
0118 2583              ADD     A,DPH
011A F583              MOV     DPH,A
011C E0                MOVX    A,@DPTR
011D FD                MOV     R5,A
011E 900000      R     MOV     DPTR,#var_h+01H
0121 E0                MOVX    A,@DPTR
0122 FC                MOV     R4,A
0123 ED                MOV     A,R5
0124 EC                MOV     A,R4
0125 120000      E     LCALL   ?C?FCASTI
0128 900000      R     MOV     DPTR,#aP+04H
012B 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 427
012E 900000      R     MOV     DPTR,#n
0131 E0                MOVX    A,@DPTR
0132 FE                MOV     R6,A
0133 A3                INC     DPTR
0134 E0                MOVX    A,@DPTR
0135 FF                MOV     R7,A
0136 900000      E     MOV     DPTR,#Accel+04H
0139 75F006            MOV     B,#06H
013C 120000      E     LCALL   ?C?OFFXADD
013F EE                MOV     A,R6
0140 75F006            MOV     B,#06H
0143 A4                MUL     AB
0144 2583              ADD     A,DPH
0146 F583              MOV     DPH,A
0148 E0                MOVX    A,@DPTR
0149 FD                MOV     R5,A
014A 900000      R     MOV     DPTR,#var_h
014D E4                CLR     A
014E F0                MOVX    @DPTR,A
014F A3                INC     DPTR
0150 ED                MOV     A,R5
0151 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 428
0152 900000      E     MOV     DPTR,#Accel+05H
0155 75F006            MOV     B,#06H
0158 EF                MOV     A,R7
0159 120000      E     LCALL   ?C?OFFXADD
015C EE                MOV     A,R6
015D 75F006            MOV     B,#06H
C51 COMPILER V9.51   IMU_FUNCTIONS                                                         02/16/2018 15:56:04 PAGE 42  

0160 A4                MUL     AB
0161 2583              ADD     A,DPH
0163 F583              MOV     DPH,A
0165 E0                MOVX    A,@DPTR
0166 FD                MOV     R5,A
0167 900000      R     MOV     DPTR,#var_h+01H
016A E0                MOVX    A,@DPTR
016B FC                MOV     R4,A
016C ED                MOV     A,R5
016D EC                MOV     A,R4
016E 120000      E     LCALL   ?C?FCASTI
0171 900000      R     MOV     DPTR,#aP+08H
0174 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 430
0177 E4                CLR     A
0178 FF                MOV     R7,A
0179 FE                MOV     R6,A
017A FD                MOV     R5,A
017B FC                MOV     R4,A
017C 900000      R     MOV     DPTR,#g
017F 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 431
0182 900000      R     MOV     DPTR,#n
0185 E0                MOVX    A,@DPTR
0186 FE                MOV     R6,A
0187 A3                INC     DPTR
0188 E0                MOVX    A,@DPTR
0189 FF                MOV     R7,A
018A 900000      E     MOV     DPTR,#Gyro
018D 75F006            MOV     B,#06H
0190 120000      E     LCALL   ?C?OFFXADD
0193 EE                MOV     A,R6
0194 75F006            MOV     B,#06H
0197 A4                MUL     AB
0198 2583              ADD     A,DPH
019A F583              MOV     DPH,A
019C E0                MOVX    A,@DPTR
019D FD                MOV     R5,A
019E 900000      R     MOV     DPTR,#var_h
01A1 E4                CLR     A
01A2 F0                MOVX    @DPTR,A
01A3 A3                INC     DPTR
01A4 ED                MOV     A,R5
01A5 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 432
01A6 900000      E     MOV     DPTR,#Gyro+01H
01A9 75F006            MOV     B,#06H
01AC EF                MOV     A,R7
01AD 120000      E     LCALL   ?C?OFFXADD
01B0 EE                MOV     A,R6
01B1 75F006            MOV     B,#06H
01B4 A4                MUL     AB
01B5 2583              ADD     A,DPH
01B7 F583              MOV     DPH,A
01B9 E0                MOVX    A,@DPTR
01BA FD                MOV     R5,A
01BB 900000      R     MOV     DPTR,#var_h+01H
01BE E0                MOVX    A,@DPTR
01BF FC                MOV     R4,A
01C0 ED                MOV     A,R5
01C1 EC                MOV     A,R4
01C2 120000      E     LCALL   ?C?FCASTI
C51 COMPILER V9.51   IMU_FUNCTIONS                                                         02/16/2018 15:56:04 PAGE 43  

01C5 7B54              MOV     R3,#054H
01C7 7AA0              MOV     R2,#0A0H
01C9 790B              MOV     R1,#0BH
01CB 7839              MOV     R0,#039H
01CD 120000      E     LCALL   ?C?FPMUL
01D0 900000      R     MOV     DPTR,#g+04H
01D3 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 433
01D6 900000      R     MOV     DPTR,#g+04H
01D9 E0                MOVX    A,@DPTR
01DA FC                MOV     R4,A
01DB A3                INC     DPTR
01DC E0                MOVX    A,@DPTR
01DD FD                MOV     R5,A
01DE A3                INC     DPTR
01DF E0                MOVX    A,@DPTR
01E0 FE                MOV     R6,A
01E1 A3                INC     DPTR
01E2 E0                MOVX    A,@DPTR
01E3 FF                MOV     R7,A
01E4 120000      E     LCALL   _fabs
01E7 7BA6              MOV     R3,#0A6H
01E9 7A0A              MOV     R2,#0AH
01EB 7986              MOV     R1,#086H
01ED 783E              MOV     R0,#03EH
01EF 120000      E     LCALL   ?C?FPCMP3
01F2 600D              JZ      ?C0040
01F4 400B              JC      ?C0040
01F6 E4                CLR     A
01F7 FF                MOV     R7,A
01F8 FE                MOV     R6,A
01F9 FD                MOV     R5,A
01FA FC                MOV     R4,A
01FB 900000      R     MOV     DPTR,#g+04H
01FE 120000      E     LCALL   ?C?LSTXDATA
0201         ?C0040:
                                           ; SOURCE LINE # 434
0201 900000      R     MOV     DPTR,#n
0204 E0                MOVX    A,@DPTR
0205 FE                MOV     R6,A
0206 A3                INC     DPTR
0207 E0                MOVX    A,@DPTR
0208 FF                MOV     R7,A
0209 900000      E     MOV     DPTR,#Gyro+02H
020C 75F006            MOV     B,#06H
020F 120000      E     LCALL   ?C?OFFXADD
0212 EE                MOV     A,R6
0213 75F006            MOV     B,#06H
0216 A4                MUL     AB
0217 2583              ADD     A,DPH
0219 F583              MOV     DPH,A
021B E0                MOVX    A,@DPTR
021C FD                MOV     R5,A
021D 900000      R     MOV     DPTR,#var_h
0220 E4                CLR     A
0221 F0                MOVX    @DPTR,A
0222 A3                INC     DPTR
0223 ED                MOV     A,R5
0224 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 435
0225 900000      E     MOV     DPTR,#Gyro+03H
0228 75F006            MOV     B,#06H
C51 COMPILER V9.51   IMU_FUNCTIONS                                                         02/16/2018 15:56:04 PAGE 44  

022B EF                MOV     A,R7
022C 120000      E     LCALL   ?C?OFFXADD
022F EE                MOV     A,R6
0230 75F006            MOV     B,#06H
0233 A4                MUL     AB
0234 2583              ADD     A,DPH
0236 F583              MOV     DPH,A
0238 E0                MOVX    A,@DPTR
0239 FD                MOV     R5,A
023A 900000      R     MOV     DPTR,#var_h+01H
023D E0                MOVX    A,@DPTR
023E FC                MOV     R4,A
023F ED                MOV     A,R5
0240 EC                MOV     A,R4
0241 120000      E     LCALL   ?C?FCASTI
0244 7B54              MOV     R3,#054H
0246 7AA0              MOV     R2,#0A0H
0248 790B              MOV     R1,#0BH
024A 7839              MOV     R0,#039H
024C 120000      E     LCALL   ?C?FPMUL
024F 900000      R     MOV     DPTR,#g+08H
0252 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 436
0255 900000      R     MOV     DPTR,#g+08H
0258 E0                MOVX    A,@DPTR
0259 FC                MOV     R4,A
025A A3                INC     DPTR
025B E0                MOVX    A,@DPTR
025C FD                MOV     R5,A
025D A3                INC     DPTR
025E E0                MOVX    A,@DPTR
025F FE                MOV     R6,A
0260 A3                INC     DPTR
0261 E0                MOVX    A,@DPTR
0262 FF                MOV     R7,A
0263 120000      E     LCALL   _fabs
0266 7BA6              MOV     R3,#0A6H
0268 7A0A              MOV     R2,#0AH
026A 7986              MOV     R1,#086H
026C 783E              MOV     R0,#03EH
026E 120000      E     LCALL   ?C?FPCMP3
0271 600D              JZ      ?C0041
0273 400B              JC      ?C0041
0275 E4                CLR     A
0276 FF                MOV     R7,A
0277 FE                MOV     R6,A
0278 FD                MOV     R5,A
0279 FC                MOV     R4,A
027A 900000      R     MOV     DPTR,#g+08H
027D 120000      E     LCALL   ?C?LSTXDATA
0280         ?C0041:
                                           ; SOURCE LINE # 437
0280 900000      R     MOV     DPTR,#n
0283 E0                MOVX    A,@DPTR
0284 FE                MOV     R6,A
0285 A3                INC     DPTR
0286 E0                MOVX    A,@DPTR
0287 FF                MOV     R7,A
0288 900000      E     MOV     DPTR,#Gyro+04H
028B 75F006            MOV     B,#06H
028E 120000      E     LCALL   ?C?OFFXADD
0291 EE                MOV     A,R6
C51 COMPILER V9.51   IMU_FUNCTIONS                                                         02/16/2018 15:56:04 PAGE 45  

0292 75F006            MOV     B,#06H
0295 A4                MUL     AB
0296 2583              ADD     A,DPH
0298 F583              MOV     DPH,A
029A E0                MOVX    A,@DPTR
029B FD                MOV     R5,A
029C 900000      R     MOV     DPTR,#var_h
029F E4                CLR     A
02A0 F0                MOVX    @DPTR,A
02A1 A3                INC     DPTR
02A2 ED                MOV     A,R5
02A3 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 438
02A4 900000      E     MOV     DPTR,#Gyro+05H
02A7 75F006            MOV     B,#06H
02AA EF                MOV     A,R7
02AB 120000      E     LCALL   ?C?OFFXADD
02AE EE                MOV     A,R6
02AF 75F006            MOV     B,#06H
02B2 A4                MUL     AB
02B3 2583              ADD     A,DPH
02B5 F583              MOV     DPH,A
02B7 E0                MOVX    A,@DPTR
02B8 FD                MOV     R5,A
02B9 900000      R     MOV     DPTR,#var_h+01H
02BC E0                MOVX    A,@DPTR
02BD FC                MOV     R4,A
02BE ED                MOV     A,R5
02BF EC                MOV     A,R4
02C0 120000      E     LCALL   ?C?FCASTI
02C3 7B54              MOV     R3,#054H
02C5 7AA0              MOV     R2,#0A0H
02C7 790B              MOV     R1,#0BH
02C9 7839              MOV     R0,#039H
02CB 120000      E     LCALL   ?C?FPMUL
02CE 900000      R     MOV     DPTR,#g+0CH
02D1 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 439
02D4 900000      R     MOV     DPTR,#g+0CH
02D7 E0                MOVX    A,@DPTR
02D8 FC                MOV     R4,A
02D9 A3                INC     DPTR
02DA E0                MOVX    A,@DPTR
02DB FD                MOV     R5,A
02DC A3                INC     DPTR
02DD E0                MOVX    A,@DPTR
02DE FE                MOV     R6,A
02DF A3                INC     DPTR
02E0 E0                MOVX    A,@DPTR
02E1 FF                MOV     R7,A
02E2 120000      E     LCALL   _fabs
02E5 7BA6              MOV     R3,#0A6H
02E7 7A0A              MOV     R2,#0AH
02E9 7986              MOV     R1,#086H
02EB 783E              MOV     R0,#03EH
02ED 120000      E     LCALL   ?C?FPCMP3
02F0 600D              JZ      ?C0042
02F2 400B              JC      ?C0042
02F4 E4                CLR     A
02F5 FF                MOV     R7,A
02F6 FE                MOV     R6,A
02F7 FD                MOV     R5,A
C51 COMPILER V9.51   IMU_FUNCTIONS                                                         02/16/2018 15:56:04 PAGE 46  

02F8 FC                MOV     R4,A
02F9 900000      R     MOV     DPTR,#g+0CH
02FC 120000      E     LCALL   ?C?LSTXDATA
02FF         ?C0042:
                                           ; SOURCE LINE # 442
02FF 7B01              MOV     R3,#01H
0301 7A00        R     MOV     R2,#HIGH aP
0303 7900        R     MOV     R1,#LOW aP
0305 120000      E     LCALL   _v3_normalize
                                           ; SOURCE LINE # 445
0308 900000      E     MOV     DPTR,#Quat
030B E0                MOVX    A,@DPTR
030C FC                MOV     R4,A
030D A3                INC     DPTR
030E E0                MOVX    A,@DPTR
030F FD                MOV     R5,A
0310 A3                INC     DPTR
0311 E0                MOVX    A,@DPTR
0312 FE                MOV     R6,A
0313 A3                INC     DPTR
0314 E0                MOVX    A,@DPTR
0315 FF                MOV     R7,A
0316 900000      R     MOV     DPTR,#qL
0319 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 446
031C 900000      E     MOV     DPTR,#Quat+04H
031F E0                MOVX    A,@DPTR
0320 FC                MOV     R4,A
0321 A3                INC     DPTR
0322 E0                MOVX    A,@DPTR
0323 FD                MOV     R5,A
0324 A3                INC     DPTR
0325 E0                MOVX    A,@DPTR
0326 FE                MOV     R6,A
0327 A3                INC     DPTR
0328 E0                MOVX    A,@DPTR
0329 FF                MOV     R7,A
032A 900000      R     MOV     DPTR,#qL+04H
032D 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 447
0330 900000      E     MOV     DPTR,#Quat+08H
0333 E0                MOVX    A,@DPTR
0334 FC                MOV     R4,A
0335 A3                INC     DPTR
0336 E0                MOVX    A,@DPTR
0337 FD                MOV     R5,A
0338 A3                INC     DPTR
0339 E0                MOVX    A,@DPTR
033A FE                MOV     R6,A
033B A3                INC     DPTR
033C E0                MOVX    A,@DPTR
033D FF                MOV     R7,A
033E 900000      R     MOV     DPTR,#qL+08H
0341 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 448
0344 900000      E     MOV     DPTR,#Quat+0CH
0347 E0                MOVX    A,@DPTR
0348 FC                MOV     R4,A
0349 A3                INC     DPTR
034A E0                MOVX    A,@DPTR
034B FD                MOV     R5,A
034C A3                INC     DPTR
C51 COMPILER V9.51   IMU_FUNCTIONS                                                         02/16/2018 15:56:04 PAGE 47  

034D E0                MOVX    A,@DPTR
034E FE                MOV     R6,A
034F A3                INC     DPTR
0350 E0                MOVX    A,@DPTR
0351 FF                MOV     R7,A
0352 900000      R     MOV     DPTR,#qL+0CH
0355 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 451
0358 900000      R     MOV     DPTR,#qL+08H
035B E0                MOVX    A,@DPTR
035C FC                MOV     R4,A
035D A3                INC     DPTR
035E E0                MOVX    A,@DPTR
035F FD                MOV     R5,A
0360 A3                INC     DPTR
0361 E0                MOVX    A,@DPTR
0362 FE                MOV     R6,A
0363 A3                INC     DPTR
0364 E0                MOVX    A,@DPTR
0365 FF                MOV     R7,A
0366 900000      R     MOV     DPTR,#qL
0369 E0                MOVX    A,@DPTR
036A F8                MOV     R0,A
036B A3                INC     DPTR
036C E0                MOVX    A,@DPTR
036D F9                MOV     R1,A
036E A3                INC     DPTR
036F E0                MOVX    A,@DPTR
0370 FA                MOV     R2,A
0371 A3                INC     DPTR
0372 E0                MOVX    A,@DPTR
0373 FB                MOV     R3,A
0374 120000      E     LCALL   ?C?FPMUL
0377 C004              PUSH    AR4
0379 C005              PUSH    AR5
037B C006              PUSH    AR6
037D C007              PUSH    AR7
037F 900000      R     MOV     DPTR,#qL+0CH
0382 E0                MOVX    A,@DPTR
0383 FC                MOV     R4,A
0384 A3                INC     DPTR
0385 E0                MOVX    A,@DPTR
0386 FD                MOV     R5,A
0387 A3                INC     DPTR
0388 E0                MOVX    A,@DPTR
0389 FE                MOV     R6,A
038A A3                INC     DPTR
038B E0                MOVX    A,@DPTR
038C FF                MOV     R7,A
038D 900000      R     MOV     DPTR,#qL+04H
0390 E0                MOVX    A,@DPTR
0391 F8                MOV     R0,A
0392 A3                INC     DPTR
0393 E0                MOVX    A,@DPTR
0394 F9                MOV     R1,A
0395 A3                INC     DPTR
0396 E0                MOVX    A,@DPTR
0397 FA                MOV     R2,A
0398 A3                INC     DPTR
0399 E0                MOVX    A,@DPTR
039A FB                MOV     R3,A
039B 120000      E     LCALL   ?C?FPMUL
C51 COMPILER V9.51   IMU_FUNCTIONS                                                         02/16/2018 15:56:04 PAGE 48  

039E D003              POP     AR3
03A0 D002              POP     AR2
03A2 D001              POP     AR1
03A4 D000              POP     AR0
03A6 120000      E     LCALL   ?C?FPSUB
03A9 E4                CLR     A
03AA FB                MOV     R3,A
03AB FA                MOV     R2,A
03AC F9                MOV     R1,A
03AD 7840              MOV     R0,#040H
03AF 120000      E     LCALL   ?C?FPMUL
03B2 900000      R     MOV     DPTR,#aP
03B5 E0                MOVX    A,@DPTR
03B6 F8                MOV     R0,A
03B7 A3                INC     DPTR
03B8 E0                MOVX    A,@DPTR
03B9 F9                MOV     R1,A
03BA A3                INC     DPTR
03BB E0                MOVX    A,@DPTR
03BC FA                MOV     R2,A
03BD A3                INC     DPTR
03BE E0                MOVX    A,@DPTR
03BF FB                MOV     R3,A
03C0 120000      E     LCALL   ?C?FPSUB
03C3 C004              PUSH    AR4
03C5 C005              PUSH    AR5
03C7 C006              PUSH    AR6
03C9 C007              PUSH    AR7
03CB 900000      R     MOV     DPTR,#qL+08H
03CE E0                MOVX    A,@DPTR
03CF FC                MOV     R4,A
03D0 A3                INC     DPTR
03D1 E0                MOVX    A,@DPTR
03D2 FD                MOV     R5,A
03D3 A3                INC     DPTR
03D4 E0                MOVX    A,@DPTR
03D5 FE                MOV     R6,A
03D6 A3                INC     DPTR
03D7 E0                MOVX    A,@DPTR
03D8 FF                MOV     R7,A
03D9 120000      E     LCALL   ?C?FPNEG
03DC D003              POP     AR3
03DE D002              POP     AR2
03E0 D001              POP     AR1
03E2 D000              POP     AR0
03E4 120000      E     LCALL   ?C?FPMUL
03E7 C004              PUSH    AR4
03E9 C005              PUSH    AR5
03EB C006              PUSH    AR6
03ED C007              PUSH    AR7
03EF 900000      R     MOV     DPTR,#qL+0CH
03F2 E0                MOVX    A,@DPTR
03F3 FC                MOV     R4,A
03F4 A3                INC     DPTR
03F5 E0                MOVX    A,@DPTR
03F6 FD                MOV     R5,A
03F7 A3                INC     DPTR
03F8 E0                MOVX    A,@DPTR
03F9 FE                MOV     R6,A
03FA A3                INC     DPTR
03FB E0                MOVX    A,@DPTR
03FC FF                MOV     R7,A
C51 COMPILER V9.51   IMU_FUNCTIONS                                                         02/16/2018 15:56:04 PAGE 49  

03FD 900000      R     MOV     DPTR,#qL+08H
0400 E0                MOVX    A,@DPTR
0401 F8                MOV     R0,A
0402 A3                INC     DPTR
0403 E0                MOVX    A,@DPTR
0404 F9                MOV     R1,A
0405 A3                INC     DPTR
0406 E0                MOVX    A,@DPTR
0407 FA                MOV     R2,A
0408 A3                INC     DPTR
0409 E0                MOVX    A,@DPTR
040A FB                MOV     R3,A
040B 120000      E     LCALL   ?C?FPMUL
040E C004              PUSH    AR4
0410 C005              PUSH    AR5
0412 C006              PUSH    AR6
0414 C007              PUSH    AR7
0416 900000      R     MOV     DPTR,#qL+04H
0419 E0                MOVX    A,@DPTR
041A FC                MOV     R4,A
041B A3                INC     DPTR
041C E0                MOVX    A,@DPTR
041D FD                MOV     R5,A
041E A3                INC     DPTR
041F E0                MOVX    A,@DPTR
0420 FE                MOV     R6,A
0421 A3                INC     DPTR
0422 E0                MOVX    A,@DPTR
0423 FF                MOV     R7,A
0424 900000      R     MOV     DPTR,#qL
0427 E0                MOVX    A,@DPTR
0428 F8                MOV     R0,A
0429 A3                INC     DPTR
042A E0                MOVX    A,@DPTR
042B F9                MOV     R1,A
042C A3                INC     DPTR
042D E0                MOVX    A,@DPTR
042E FA                MOV     R2,A
042F A3                INC     DPTR
0430 E0                MOVX    A,@DPTR
0431 FB                MOV     R3,A
0432 120000      E     LCALL   ?C?FPMUL
0435 D003              POP     AR3
0437 D002              POP     AR2
0439 D001              POP     AR1
043B D000              POP     AR0
043D 120000      E     LCALL   ?C?FPADD
0440 E4                CLR     A
0441 FB                MOV     R3,A
0442 FA                MOV     R2,A
0443 F9                MOV     R1,A
0444 7840              MOV     R0,#040H
0446 120000      E     LCALL   ?C?FPMUL
0449 900000      R     MOV     DPTR,#aP+04H
044C E0                MOVX    A,@DPTR
044D F8                MOV     R0,A
044E A3                INC     DPTR
044F E0                MOVX    A,@DPTR
0450 F9                MOV     R1,A
0451 A3                INC     DPTR
0452 E0                MOVX    A,@DPTR
0453 FA                MOV     R2,A
C51 COMPILER V9.51   IMU_FUNCTIONS                                                         02/16/2018 15:56:04 PAGE 50  

0454 A3                INC     DPTR
0455 E0                MOVX    A,@DPTR
0456 FB                MOV     R3,A
0457 120000      E     LCALL   ?C?FPSUB
045A 900000      R     MOV     DPTR,#qL+04H
045D E0                MOVX    A,@DPTR
045E F8                MOV     R0,A
045F A3                INC     DPTR
0460 E0                MOVX    A,@DPTR
0461 F9                MOV     R1,A
0462 A3                INC     DPTR
0463 E0                MOVX    A,@DPTR
0464 FA                MOV     R2,A
0465 A3                INC     DPTR
0466 E0                MOVX    A,@DPTR
0467 FB                MOV     R3,A
0468 120000      E     LCALL   ?C?FPMUL
046B D003              POP     AR3
046D D002              POP     AR2
046F D001              POP     AR1
0471 D000              POP     AR0
0473 120000      E     LCALL   ?C?FPADD
0476 7B82              MOV     R3,#082H
0478 7A51              MOV     R2,#051H
047A 79C3              MOV     R1,#0C3H
047C 7840              MOV     R0,#040H
047E 120000      E     LCALL   ?C?FPMUL
0481 900000      R     MOV     DPTR,#Napla
0484 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 452
0487 900000      R     MOV     DPTR,#qL+0CH
048A E0                MOVX    A,@DPTR
048B FC                MOV     R4,A
048C A3                INC     DPTR
048D E0                MOVX    A,@DPTR
048E FD                MOV     R5,A
048F A3                INC     DPTR
0490 E0                MOVX    A,@DPTR
0491 FE                MOV     R6,A
0492 A3                INC     DPTR
0493 E0                MOVX    A,@DPTR
0494 FF                MOV     R7,A
0495 900000      R     MOV     DPTR,#qL+08H
0498 E0                MOVX    A,@DPTR
0499 F8                MOV     R0,A
049A A3                INC     DPTR
049B E0                MOVX    A,@DPTR
049C F9                MOV     R1,A
049D A3                INC     DPTR
049E E0                MOVX    A,@DPTR
049F FA                MOV     R2,A
04A0 A3                INC     DPTR
04A1 E0                MOVX    A,@DPTR
04A2 FB                MOV     R3,A
04A3 120000      E     LCALL   ?C?FPMUL
04A6 C004              PUSH    AR4
04A8 C005              PUSH    AR5
04AA C006              PUSH    AR6
04AC C007              PUSH    AR7
04AE 900000      R     MOV     DPTR,#qL+04H
04B1 E0                MOVX    A,@DPTR
04B2 FC                MOV     R4,A
C51 COMPILER V9.51   IMU_FUNCTIONS                                                         02/16/2018 15:56:04 PAGE 51  

04B3 A3                INC     DPTR
04B4 E0                MOVX    A,@DPTR
04B5 FD                MOV     R5,A
04B6 A3                INC     DPTR
04B7 E0                MOVX    A,@DPTR
04B8 FE                MOV     R6,A
04B9 A3                INC     DPTR
04BA E0                MOVX    A,@DPTR
04BB FF                MOV     R7,A
04BC 900000      R     MOV     DPTR,#qL
04BF E0                MOVX    A,@DPTR
04C0 F8                MOV     R0,A
04C1 A3                INC     DPTR
04C2 E0                MOVX    A,@DPTR
04C3 F9                MOV     R1,A
04C4 A3                INC     DPTR
04C5 E0                MOVX    A,@DPTR
04C6 FA                MOV     R2,A
04C7 A3                INC     DPTR
04C8 E0                MOVX    A,@DPTR
04C9 FB                MOV     R3,A
04CA 120000      E     LCALL   ?C?FPMUL
04CD D003              POP     AR3
04CF D002              POP     AR2
04D1 D001              POP     AR1
04D3 D000              POP     AR0
04D5 120000      E     LCALL   ?C?FPADD
04D8 E4                CLR     A
04D9 FB                MOV     R3,A
04DA FA                MOV     R2,A
04DB F9                MOV     R1,A
04DC 7840              MOV     R0,#040H
04DE 120000      E     LCALL   ?C?FPMUL
04E1 900000      R     MOV     DPTR,#aP+04H
04E4 E0                MOVX    A,@DPTR
04E5 F8                MOV     R0,A
04E6 A3                INC     DPTR
04E7 E0                MOVX    A,@DPTR
04E8 F9                MOV     R1,A
04E9 A3                INC     DPTR
04EA E0                MOVX    A,@DPTR
04EB FA                MOV     R2,A
04EC A3                INC     DPTR
04ED E0                MOVX    A,@DPTR
04EE FB                MOV     R3,A
04EF 120000      E     LCALL   ?C?FPSUB
04F2 900000      R     MOV     DPTR,#qL
04F5 E0                MOVX    A,@DPTR
04F6 F8                MOV     R0,A
04F7 A3                INC     DPTR
04F8 E0                MOVX    A,@DPTR
04F9 F9                MOV     R1,A
04FA A3                INC     DPTR
04FB E0                MOVX    A,@DPTR
04FC FA                MOV     R2,A
04FD A3                INC     DPTR
04FE E0                MOVX    A,@DPTR
04FF FB                MOV     R3,A
0500 120000      E     LCALL   ?C?FPMUL
0503 C004              PUSH    AR4
0505 C005              PUSH    AR5
0507 C006              PUSH    AR6
C51 COMPILER V9.51   IMU_FUNCTIONS                                                         02/16/2018 15:56:04 PAGE 52  

0509 C007              PUSH    AR7
050B 900000      R     MOV     DPTR,#qL+08H
050E E0                MOVX    A,@DPTR
050F FC                MOV     R4,A
0510 A3                INC     DPTR
0511 E0                MOVX    A,@DPTR
0512 FD                MOV     R5,A
0513 A3                INC     DPTR
0514 E0                MOVX    A,@DPTR
0515 FE                MOV     R6,A
0516 A3                INC     DPTR
0517 E0                MOVX    A,@DPTR
0518 FF                MOV     R7,A
0519 900000      R     MOV     DPTR,#qL
051C E0                MOVX    A,@DPTR
051D F8                MOV     R0,A
051E A3                INC     DPTR
051F E0                MOVX    A,@DPTR
0520 F9                MOV     R1,A
0521 A3                INC     DPTR
0522 E0                MOVX    A,@DPTR
0523 FA                MOV     R2,A
0524 A3                INC     DPTR
0525 E0                MOVX    A,@DPTR
0526 FB                MOV     R3,A
0527 120000      E     LCALL   ?C?FPMUL
052A C004              PUSH    AR4
052C C005              PUSH    AR5
052E C006              PUSH    AR6
0530 C007              PUSH    AR7
0532 900000      R     MOV     DPTR,#qL+0CH
0535 E0                MOVX    A,@DPTR
0536 FC                MOV     R4,A
0537 A3                INC     DPTR
0538 E0                MOVX    A,@DPTR
0539 FD                MOV     R5,A
053A A3                INC     DPTR
053B E0                MOVX    A,@DPTR
053C FE                MOV     R6,A
053D A3                INC     DPTR
053E E0                MOVX    A,@DPTR
053F FF                MOV     R7,A
0540 900000      R     MOV     DPTR,#qL+04H
0543 E0                MOVX    A,@DPTR
0544 F8                MOV     R0,A
0545 A3                INC     DPTR
0546 E0                MOVX    A,@DPTR
0547 F9                MOV     R1,A
0548 A3                INC     DPTR
0549 E0                MOVX    A,@DPTR
054A FA                MOV     R2,A
054B A3                INC     DPTR
054C E0                MOVX    A,@DPTR
054D FB                MOV     R3,A
054E 120000      E     LCALL   ?C?FPMUL
0551 D003              POP     AR3
0553 D002              POP     AR2
0555 D001              POP     AR1
0557 D000              POP     AR0
0559 120000      E     LCALL   ?C?FPSUB
055C E4                CLR     A
055D FB                MOV     R3,A
C51 COMPILER V9.51   IMU_FUNCTIONS                                                         02/16/2018 15:56:04 PAGE 53  

055E FA                MOV     R2,A
055F F9                MOV     R1,A
0560 7840              MOV     R0,#040H
0562 120000      E     LCALL   ?C?FPMUL
0565 900000      R     MOV     DPTR,#aP
0568 E0                MOVX    A,@DPTR
0569 F8                MOV     R0,A
056A A3                INC     DPTR
056B E0                MOVX    A,@DPTR
056C F9                MOV     R1,A
056D A3                INC     DPTR
056E E0                MOVX    A,@DPTR
056F FA                MOV     R2,A
0570 A3                INC     DPTR
0571 E0                MOVX    A,@DPTR
0572 FB                MOV     R3,A
0573 120000      E     LCALL   ?C?FPSUB
0576 900000      R     MOV     DPTR,#qL+0CH
0579 E0                MOVX    A,@DPTR
057A F8                MOV     R0,A
057B A3                INC     DPTR
057C E0                MOVX    A,@DPTR
057D F9                MOV     R1,A
057E A3                INC     DPTR
057F E0                MOVX    A,@DPTR
0580 FA                MOV     R2,A
0581 A3                INC     DPTR
0582 E0                MOVX    A,@DPTR
0583 FB                MOV     R3,A
0584 120000      E     LCALL   ?C?FPMUL
0587 D003              POP     AR3
0589 D002              POP     AR2
058B D001              POP     AR1
058D D000              POP     AR0
058F 120000      E     LCALL   ?C?FPADD
0592 C004              PUSH    AR4
0594 C005              PUSH    AR5
0596 C006              PUSH    AR6
0598 C007              PUSH    AR7
059A 900000      R     MOV     DPTR,#qL+04H
059D E0                MOVX    A,@DPTR
059E FC                MOV     R4,A
059F A3                INC     DPTR
05A0 E0                MOVX    A,@DPTR
05A1 FD                MOV     R5,A
05A2 A3                INC     DPTR
05A3 E0                MOVX    A,@DPTR
05A4 FE                MOV     R6,A
05A5 A3                INC     DPTR
05A6 E0                MOVX    A,@DPTR
05A7 FF                MOV     R7,A
05A8 900000      R     MOV     DPTR,#qL+04H
05AB E0                MOVX    A,@DPTR
05AC F8                MOV     R0,A
05AD A3                INC     DPTR
05AE E0                MOVX    A,@DPTR
05AF F9                MOV     R1,A
05B0 A3                INC     DPTR
05B1 E0                MOVX    A,@DPTR
05B2 FA                MOV     R2,A
05B3 A3                INC     DPTR
05B4 E0                MOVX    A,@DPTR
C51 COMPILER V9.51   IMU_FUNCTIONS                                                         02/16/2018 15:56:04 PAGE 54  

05B5 FB                MOV     R3,A
05B6 120000      E     LCALL   ?C?FPMUL
05B9 A804              MOV     R0,AR4
05BB A905              MOV     R1,AR5
05BD AA06              MOV     R2,AR6
05BF AB07              MOV     R3,AR7
05C1 E4                CLR     A
05C2 FF                MOV     R7,A
05C3 FE                MOV     R6,A
05C4 FD                MOV     R5,A
05C5 7C3F              MOV     R4,#03FH
05C7 120000      E     LCALL   ?C?FPSUB
05CA C004              PUSH    AR4
05CC C005              PUSH    AR5
05CE C006              PUSH    AR6
05D0 C007              PUSH    AR7
05D2 900000      R     MOV     DPTR,#qL+08H
05D5 E0                MOVX    A,@DPTR
05D6 FC                MOV     R4,A
05D7 A3                INC     DPTR
05D8 E0                MOVX    A,@DPTR
05D9 FD                MOV     R5,A
05DA A3                INC     DPTR
05DB E0                MOVX    A,@DPTR
05DC FE                MOV     R6,A
05DD A3                INC     DPTR
05DE E0                MOVX    A,@DPTR
05DF FF                MOV     R7,A
05E0 900000      R     MOV     DPTR,#qL+08H
05E3 E0                MOVX    A,@DPTR
05E4 F8                MOV     R0,A
05E5 A3                INC     DPTR
05E6 E0                MOVX    A,@DPTR
05E7 F9                MOV     R1,A
05E8 A3                INC     DPTR
05E9 E0                MOVX    A,@DPTR
05EA FA                MOV     R2,A
05EB A3                INC     DPTR
05EC E0                MOVX    A,@DPTR
05ED FB                MOV     R3,A
05EE 120000      E     LCALL   ?C?FPMUL
05F1 A804              MOV     R0,AR4
05F3 A905              MOV     R1,AR5
05F5 AA06              MOV     R2,AR6
05F7 AB07              MOV     R3,AR7
05F9 D007              POP     AR7
05FB D006              POP     AR6
05FD D005              POP     AR5
05FF D004              POP     AR4
0601 120000      E     LCALL   ?C?FPSUB
0604 E4                CLR     A
0605 FB                MOV     R3,A
0606 FA                MOV     R2,A
0607 F9                MOV     R1,A
0608 7840              MOV     R0,#040H
060A 120000      E     LCALL   ?C?FPMUL
060D 900000      R     MOV     DPTR,#aP+08H
0610 E0                MOVX    A,@DPTR
0611 F8                MOV     R0,A
0612 A3                INC     DPTR
0613 E0                MOVX    A,@DPTR
0614 F9                MOV     R1,A
C51 COMPILER V9.51   IMU_FUNCTIONS                                                         02/16/2018 15:56:04 PAGE 55  

0615 A3                INC     DPTR
0616 E0                MOVX    A,@DPTR
0617 FA                MOV     R2,A
0618 A3                INC     DPTR
0619 E0                MOVX    A,@DPTR
061A FB                MOV     R3,A
061B 120000      E     LCALL   ?C?FPSUB
061E C004              PUSH    AR4
0620 C005              PUSH    AR5
0622 C006              PUSH    AR6
0624 C007              PUSH    AR7
0626 E4                CLR     A
0627 FF                MOV     R7,A
0628 FE                MOV     R6,A
0629 FD                MOV     R5,A
062A 7C40              MOV     R4,#040H
062C 900000      R     MOV     DPTR,#qL+04H
062F E0                MOVX    A,@DPTR
0630 F8                MOV     R0,A
0631 A3                INC     DPTR
0632 E0                MOVX    A,@DPTR
0633 F9                MOV     R1,A
0634 A3                INC     DPTR
0635 E0                MOVX    A,@DPTR
0636 FA                MOV     R2,A
0637 A3                INC     DPTR
0638 E0                MOVX    A,@DPTR
0639 FB                MOV     R3,A
063A 120000      E     LCALL   ?C?FPMUL
063D D003              POP     AR3
063F D002              POP     AR2
0641 D001              POP     AR1
0643 D000              POP     AR0
0645 120000      E     LCALL   ?C?FPMUL
0648 A804              MOV     R0,AR4
064A A905              MOV     R1,AR5
064C AA06              MOV     R2,AR6
064E AB07              MOV     R3,AR7
0650 D007              POP     AR7
0652 D006              POP     AR6
0654 D005              POP     AR5
0656 D004              POP     AR4
0658 120000      E     LCALL   ?C?FPSUB
065B 7B82              MOV     R3,#082H
065D 7A51              MOV     R2,#051H
065F 79C3              MOV     R1,#0C3H
0661 7840              MOV     R0,#040H
0663 120000      E     LCALL   ?C?FPMUL
0666 900000      R     MOV     DPTR,#Napla+04H
0669 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 453
066C 900000      R     MOV     DPTR,#qL+08H
066F E0                MOVX    A,@DPTR
0670 FC                MOV     R4,A
0671 A3                INC     DPTR
0672 E0                MOVX    A,@DPTR
0673 FD                MOV     R5,A
0674 A3                INC     DPTR
0675 E0                MOVX    A,@DPTR
0676 FE                MOV     R6,A
0677 A3                INC     DPTR
0678 E0                MOVX    A,@DPTR
C51 COMPILER V9.51   IMU_FUNCTIONS                                                         02/16/2018 15:56:04 PAGE 56  

0679 FF                MOV     R7,A
067A 900000      R     MOV     DPTR,#qL
067D E0                MOVX    A,@DPTR
067E F8                MOV     R0,A
067F A3                INC     DPTR
0680 E0                MOVX    A,@DPTR
0681 F9                MOV     R1,A
0682 A3                INC     DPTR
0683 E0                MOVX    A,@DPTR
0684 FA                MOV     R2,A
0685 A3                INC     DPTR
0686 E0                MOVX    A,@DPTR
0687 FB                MOV     R3,A
0688 120000      E     LCALL   ?C?FPMUL
068B C004              PUSH    AR4
068D C005              PUSH    AR5
068F C006              PUSH    AR6
0691 C007              PUSH    AR7
0693 900000      R     MOV     DPTR,#qL+0CH
0696 E0                MOVX    A,@DPTR
0697 FC                MOV     R4,A
0698 A3                INC     DPTR
0699 E0                MOVX    A,@DPTR
069A FD                MOV     R5,A
069B A3                INC     DPTR
069C E0                MOVX    A,@DPTR
069D FE                MOV     R6,A
069E A3                INC     DPTR
069F E0                MOVX    A,@DPTR
06A0 FF                MOV     R7,A
06A1 900000      R     MOV     DPTR,#qL+04H
06A4 E0                MOVX    A,@DPTR
06A5 F8                MOV     R0,A
06A6 A3                INC     DPTR
06A7 E0                MOVX    A,@DPTR
06A8 F9                MOV     R1,A
06A9 A3                INC     DPTR
06AA E0                MOVX    A,@DPTR
06AB FA                MOV     R2,A
06AC A3                INC     DPTR
06AD E0                MOVX    A,@DPTR
06AE FB                MOV     R3,A
06AF 120000      E     LCALL   ?C?FPMUL
06B2 D003              POP     AR3
06B4 D002              POP     AR2
06B6 D001              POP     AR1
06B8 D000              POP     AR0
06BA 120000      E     LCALL   ?C?FPSUB
06BD E4                CLR     A
06BE FB                MOV     R3,A
06BF FA                MOV     R2,A
06C0 F9                MOV     R1,A
06C1 7840              MOV     R0,#040H
06C3 120000      E     LCALL   ?C?FPMUL
06C6 900000      R     MOV     DPTR,#aP
06C9 E0                MOVX    A,@DPTR
06CA F8                MOV     R0,A
06CB A3                INC     DPTR
06CC E0                MOVX    A,@DPTR
06CD F9                MOV     R1,A
06CE A3                INC     DPTR
06CF E0                MOVX    A,@DPTR
C51 COMPILER V9.51   IMU_FUNCTIONS                                                         02/16/2018 15:56:04 PAGE 57  

06D0 FA                MOV     R2,A
06D1 A3                INC     DPTR
06D2 E0                MOVX    A,@DPTR
06D3 FB                MOV     R3,A
06D4 120000      E     LCALL   ?C?FPSUB
06D7 C004              PUSH    AR4
06D9 C005              PUSH    AR5
06DB C006              PUSH    AR6
06DD C007              PUSH    AR7
06DF 900000      R     MOV     DPTR,#qL
06E2 E0                MOVX    A,@DPTR
06E3 FC                MOV     R4,A
06E4 A3                INC     DPTR
06E5 E0                MOVX    A,@DPTR
06E6 FD                MOV     R5,A
06E7 A3                INC     DPTR
06E8 E0                MOVX    A,@DPTR
06E9 FE                MOV     R6,A
06EA A3                INC     DPTR
06EB E0                MOVX    A,@DPTR
06EC FF                MOV     R7,A
06ED 120000      E     LCALL   ?C?FPNEG
06F0 D003              POP     AR3
06F2 D002              POP     AR2
06F4 D001              POP     AR1
06F6 D000              POP     AR0
06F8 120000      E     LCALL   ?C?FPMUL
06FB C004              PUSH    AR4
06FD C005              PUSH    AR5
06FF C006              PUSH    AR6
0701 C007              PUSH    AR7
0703 900000      R     MOV     DPTR,#qL+0CH
0706 E0                MOVX    A,@DPTR
0707 FC                MOV     R4,A
0708 A3                INC     DPTR
0709 E0                MOVX    A,@DPTR
070A FD                MOV     R5,A
070B A3                INC     DPTR
070C E0                MOVX    A,@DPTR
070D FE                MOV     R6,A
070E A3                INC     DPTR
070F E0                MOVX    A,@DPTR
0710 FF                MOV     R7,A
0711 900000      R     MOV     DPTR,#qL+08H
0714 E0                MOVX    A,@DPTR
0715 F8                MOV     R0,A
0716 A3                INC     DPTR
0717 E0                MOVX    A,@DPTR
0718 F9                MOV     R1,A
0719 A3                INC     DPTR
071A E0                MOVX    A,@DPTR
071B FA                MOV     R2,A
071C A3                INC     DPTR
071D E0                MOVX    A,@DPTR
071E FB                MOV     R3,A
071F 120000      E     LCALL   ?C?FPMUL
0722 C004              PUSH    AR4
0724 C005              PUSH    AR5
0726 C006              PUSH    AR6
0728 C007              PUSH    AR7
072A 900000      R     MOV     DPTR,#qL+04H
072D E0                MOVX    A,@DPTR
C51 COMPILER V9.51   IMU_FUNCTIONS                                                         02/16/2018 15:56:04 PAGE 58  

072E FC                MOV     R4,A
072F A3                INC     DPTR
0730 E0                MOVX    A,@DPTR
0731 FD                MOV     R5,A
0732 A3                INC     DPTR
0733 E0                MOVX    A,@DPTR
0734 FE                MOV     R6,A
0735 A3                INC     DPTR
0736 E0                MOVX    A,@DPTR
0737 FF                MOV     R7,A
0738 900000      R     MOV     DPTR,#qL
073B E0                MOVX    A,@DPTR
073C F8                MOV     R0,A
073D A3                INC     DPTR
073E E0                MOVX    A,@DPTR
073F F9                MOV     R1,A
0740 A3                INC     DPTR
0741 E0                MOVX    A,@DPTR
0742 FA                MOV     R2,A
0743 A3                INC     DPTR
0744 E0                MOVX    A,@DPTR
0745 FB                MOV     R3,A
0746 120000      E     LCALL   ?C?FPMUL
0749 D003              POP     AR3
074B D002              POP     AR2
074D D001              POP     AR1
074F D000              POP     AR0
0751 120000      E     LCALL   ?C?FPADD
0754 E4                CLR     A
0755 FB                MOV     R3,A
0756 FA                MOV     R2,A
0757 F9                MOV     R1,A
0758 7840              MOV     R0,#040H
075A 120000      E     LCALL   ?C?FPMUL
075D 900000      R     MOV     DPTR,#aP+04H
0760 E0                MOVX    A,@DPTR
0761 F8                MOV     R0,A
0762 A3                INC     DPTR
0763 E0                MOVX    A,@DPTR
0764 F9                MOV     R1,A
0765 A3                INC     DPTR
0766 E0                MOVX    A,@DPTR
0767 FA                MOV     R2,A
0768 A3                INC     DPTR
0769 E0                MOVX    A,@DPTR
076A FB                MOV     R3,A
076B 120000      E     LCALL   ?C?FPSUB
076E 900000      R     MOV     DPTR,#qL+0CH
0771 E0                MOVX    A,@DPTR
0772 F8                MOV     R0,A
0773 A3                INC     DPTR
0774 E0                MOVX    A,@DPTR
0775 F9                MOV     R1,A
0776 A3                INC     DPTR
0777 E0                MOVX    A,@DPTR
0778 FA                MOV     R2,A
0779 A3                INC     DPTR
077A E0                MOVX    A,@DPTR
077B FB                MOV     R3,A
077C 120000      E     LCALL   ?C?FPMUL
077F D003              POP     AR3
0781 D002              POP     AR2
C51 COMPILER V9.51   IMU_FUNCTIONS                                                         02/16/2018 15:56:04 PAGE 59  

0783 D001              POP     AR1
0785 D000              POP     AR0
0787 120000      E     LCALL   ?C?FPADD
078A C004              PUSH    AR4
078C C005              PUSH    AR5
078E C006              PUSH    AR6
0790 C007              PUSH    AR7
0792 900000      R     MOV     DPTR,#qL+04H
0795 E0                MOVX    A,@DPTR
0796 FC                MOV     R4,A
0797 A3                INC     DPTR
0798 E0                MOVX    A,@DPTR
0799 FD                MOV     R5,A
079A A3                INC     DPTR
079B E0                MOVX    A,@DPTR
079C FE                MOV     R6,A
079D A3                INC     DPTR
079E E0                MOVX    A,@DPTR
079F FF                MOV     R7,A
07A0 900000      R     MOV     DPTR,#qL+04H
07A3 E0                MOVX    A,@DPTR
07A4 F8                MOV     R0,A
07A5 A3                INC     DPTR
07A6 E0                MOVX    A,@DPTR
07A7 F9                MOV     R1,A
07A8 A3                INC     DPTR
07A9 E0                MOVX    A,@DPTR
07AA FA                MOV     R2,A
07AB A3                INC     DPTR
07AC E0                MOVX    A,@DPTR
07AD FB                MOV     R3,A
07AE 120000      E     LCALL   ?C?FPMUL
07B1 A804              MOV     R0,AR4
07B3 A905              MOV     R1,AR5
07B5 AA06              MOV     R2,AR6
07B7 AB07              MOV     R3,AR7
07B9 E4                CLR     A
07BA FF                MOV     R7,A
07BB FE                MOV     R6,A
07BC FD                MOV     R5,A
07BD 7C3F              MOV     R4,#03FH
07BF 120000      E     LCALL   ?C?FPSUB
07C2 C004              PUSH    AR4
07C4 C005              PUSH    AR5
07C6 C006              PUSH    AR6
07C8 C007              PUSH    AR7
07CA 900000      R     MOV     DPTR,#qL+08H
07CD E0                MOVX    A,@DPTR
07CE FC                MOV     R4,A
07CF A3                INC     DPTR
07D0 E0                MOVX    A,@DPTR
07D1 FD                MOV     R5,A
07D2 A3                INC     DPTR
07D3 E0                MOVX    A,@DPTR
07D4 FE                MOV     R6,A
07D5 A3                INC     DPTR
07D6 E0                MOVX    A,@DPTR
07D7 FF                MOV     R7,A
07D8 900000      R     MOV     DPTR,#qL+08H
07DB E0                MOVX    A,@DPTR
07DC F8                MOV     R0,A
07DD A3                INC     DPTR
C51 COMPILER V9.51   IMU_FUNCTIONS                                                         02/16/2018 15:56:04 PAGE 60  

07DE E0                MOVX    A,@DPTR
07DF F9                MOV     R1,A
07E0 A3                INC     DPTR
07E1 E0                MOVX    A,@DPTR
07E2 FA                MOV     R2,A
07E3 A3                INC     DPTR
07E4 E0                MOVX    A,@DPTR
07E5 FB                MOV     R3,A
07E6 120000      E     LCALL   ?C?FPMUL
07E9 A804              MOV     R0,AR4
07EB A905              MOV     R1,AR5
07ED AA06              MOV     R2,AR6
07EF AB07              MOV     R3,AR7
07F1 D007              POP     AR7
07F3 D006              POP     AR6
07F5 D005              POP     AR5
07F7 D004              POP     AR4
07F9 120000      E     LCALL   ?C?FPSUB
07FC E4                CLR     A
07FD FB                MOV     R3,A
07FE FA                MOV     R2,A
07FF F9                MOV     R1,A
0800 7840              MOV     R0,#040H
0802 120000      E     LCALL   ?C?FPMUL
0805 900000      R     MOV     DPTR,#aP+08H
0808 E0                MOVX    A,@DPTR
0809 F8                MOV     R0,A
080A A3                INC     DPTR
080B E0                MOVX    A,@DPTR
080C F9                MOV     R1,A
080D A3                INC     DPTR
080E E0                MOVX    A,@DPTR
080F FA                MOV     R2,A
0810 A3                INC     DPTR
0811 E0                MOVX    A,@DPTR
0812 FB                MOV     R3,A
0813 120000      E     LCALL   ?C?FPSUB
0816 C004              PUSH    AR4
0818 C005              PUSH    AR5
081A C006              PUSH    AR6
081C C007              PUSH    AR7
081E E4                CLR     A
081F FF                MOV     R7,A
0820 FE                MOV     R6,A
0821 FD                MOV     R5,A
0822 7C40              MOV     R4,#040H
0824 900000      R     MOV     DPTR,#qL+08H
0827 E0                MOVX    A,@DPTR
0828 F8                MOV     R0,A
0829 A3                INC     DPTR
082A E0                MOVX    A,@DPTR
082B F9                MOV     R1,A
082C A3                INC     DPTR
082D E0                MOVX    A,@DPTR
082E FA                MOV     R2,A
082F A3                INC     DPTR
0830 E0                MOVX    A,@DPTR
0831 FB                MOV     R3,A
0832 120000      E     LCALL   ?C?FPMUL
0835 D003              POP     AR3
0837 D002              POP     AR2
0839 D001              POP     AR1
C51 COMPILER V9.51   IMU_FUNCTIONS                                                         02/16/2018 15:56:04 PAGE 61  

083B D000              POP     AR0
083D 120000      E     LCALL   ?C?FPMUL
0840 A804              MOV     R0,AR4
0842 A905              MOV     R1,AR5
0844 AA06              MOV     R2,AR6
0846 AB07              MOV     R3,AR7
0848 D007              POP     AR7
084A D006              POP     AR6
084C D005              POP     AR5
084E D004              POP     AR4
0850 120000      E     LCALL   ?C?FPSUB
0853 7B82              MOV     R3,#082H
0855 7A51              MOV     R2,#051H
0857 79C3              MOV     R1,#0C3H
0859 7840              MOV     R0,#040H
085B 120000      E     LCALL   ?C?FPMUL
085E 900000      R     MOV     DPTR,#Napla+08H
0861 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 454
0864 900000      R     MOV     DPTR,#qL+0CH
0867 E0                MOVX    A,@DPTR
0868 FC                MOV     R4,A
0869 A3                INC     DPTR
086A E0                MOVX    A,@DPTR
086B FD                MOV     R5,A
086C A3                INC     DPTR
086D E0                MOVX    A,@DPTR
086E FE                MOV     R6,A
086F A3                INC     DPTR
0870 E0                MOVX    A,@DPTR
0871 FF                MOV     R7,A
0872 900000      R     MOV     DPTR,#qL+08H
0875 E0                MOVX    A,@DPTR
0876 F8                MOV     R0,A
0877 A3                INC     DPTR
0878 E0                MOVX    A,@DPTR
0879 F9                MOV     R1,A
087A A3                INC     DPTR
087B E0                MOVX    A,@DPTR
087C FA                MOV     R2,A
087D A3                INC     DPTR
087E E0                MOVX    A,@DPTR
087F FB                MOV     R3,A
0880 120000      E     LCALL   ?C?FPMUL
0883 C004              PUSH    AR4
0885 C005              PUSH    AR5
0887 C006              PUSH    AR6
0889 C007              PUSH    AR7
088B 900000      R     MOV     DPTR,#qL+04H
088E E0                MOVX    A,@DPTR
088F FC                MOV     R4,A
0890 A3                INC     DPTR
0891 E0                MOVX    A,@DPTR
0892 FD                MOV     R5,A
0893 A3                INC     DPTR
0894 E0                MOVX    A,@DPTR
0895 FE                MOV     R6,A
0896 A3                INC     DPTR
0897 E0                MOVX    A,@DPTR
0898 FF                MOV     R7,A
0899 900000      R     MOV     DPTR,#qL
089C E0                MOVX    A,@DPTR
C51 COMPILER V9.51   IMU_FUNCTIONS                                                         02/16/2018 15:56:04 PAGE 62  

089D F8                MOV     R0,A
089E A3                INC     DPTR
089F E0                MOVX    A,@DPTR
08A0 F9                MOV     R1,A
08A1 A3                INC     DPTR
08A2 E0                MOVX    A,@DPTR
08A3 FA                MOV     R2,A
08A4 A3                INC     DPTR
08A5 E0                MOVX    A,@DPTR
08A6 FB                MOV     R3,A
08A7 120000      E     LCALL   ?C?FPMUL
08AA D003              POP     AR3
08AC D002              POP     AR2
08AE D001              POP     AR1
08B0 D000              POP     AR0
08B2 120000      E     LCALL   ?C?FPADD
08B5 E4                CLR     A
08B6 FB                MOV     R3,A
08B7 FA                MOV     R2,A
08B8 F9                MOV     R1,A
08B9 7840              MOV     R0,#040H
08BB 120000      E     LCALL   ?C?FPMUL
08BE 900000      R     MOV     DPTR,#aP+04H
08C1 E0                MOVX    A,@DPTR
08C2 F8                MOV     R0,A
08C3 A3                INC     DPTR
08C4 E0                MOVX    A,@DPTR
08C5 F9                MOV     R1,A
08C6 A3                INC     DPTR
08C7 E0                MOVX    A,@DPTR
08C8 FA                MOV     R2,A
08C9 A3                INC     DPTR
08CA E0                MOVX    A,@DPTR
08CB FB                MOV     R3,A
08CC 120000      E     LCALL   ?C?FPSUB
08CF 900000      R     MOV     DPTR,#qL+08H
08D2 E0                MOVX    A,@DPTR
08D3 F8                MOV     R0,A
08D4 A3                INC     DPTR
08D5 E0                MOVX    A,@DPTR
08D6 F9                MOV     R1,A
08D7 A3                INC     DPTR
08D8 E0                MOVX    A,@DPTR
08D9 FA                MOV     R2,A
08DA A3                INC     DPTR
08DB E0                MOVX    A,@DPTR
08DC FB                MOV     R3,A
08DD 120000      E     LCALL   ?C?FPMUL
08E0 C004              PUSH    AR4
08E2 C005              PUSH    AR5
08E4 C006              PUSH    AR6
08E6 C007              PUSH    AR7
08E8 900000      R     MOV     DPTR,#qL+08H
08EB E0                MOVX    A,@DPTR
08EC FC                MOV     R4,A
08ED A3                INC     DPTR
08EE E0                MOVX    A,@DPTR
08EF FD                MOV     R5,A
08F0 A3                INC     DPTR
08F1 E0                MOVX    A,@DPTR
08F2 FE                MOV     R6,A
08F3 A3                INC     DPTR
C51 COMPILER V9.51   IMU_FUNCTIONS                                                         02/16/2018 15:56:04 PAGE 63  

08F4 E0                MOVX    A,@DPTR
08F5 FF                MOV     R7,A
08F6 900000      R     MOV     DPTR,#qL
08F9 E0                MOVX    A,@DPTR
08FA F8                MOV     R0,A
08FB A3                INC     DPTR
08FC E0                MOVX    A,@DPTR
08FD F9                MOV     R1,A
08FE A3                INC     DPTR
08FF E0                MOVX    A,@DPTR
0900 FA                MOV     R2,A
0901 A3                INC     DPTR
0902 E0                MOVX    A,@DPTR
0903 FB                MOV     R3,A
0904 120000      E     LCALL   ?C?FPMUL
0907 C004              PUSH    AR4
0909 C005              PUSH    AR5
090B C006              PUSH    AR6
090D C007              PUSH    AR7
090F 900000      R     MOV     DPTR,#qL+0CH
0912 E0                MOVX    A,@DPTR
0913 FC                MOV     R4,A
0914 A3                INC     DPTR
0915 E0                MOVX    A,@DPTR
0916 FD                MOV     R5,A
0917 A3                INC     DPTR
0918 E0                MOVX    A,@DPTR
0919 FE                MOV     R6,A
091A A3                INC     DPTR
091B E0                MOVX    A,@DPTR
091C FF                MOV     R7,A
091D 900000      R     MOV     DPTR,#qL+04H
0920 E0                MOVX    A,@DPTR
0921 F8                MOV     R0,A
0922 A3                INC     DPTR
0923 E0                MOVX    A,@DPTR
0924 F9                MOV     R1,A
0925 A3                INC     DPTR
0926 E0                MOVX    A,@DPTR
0927 FA                MOV     R2,A
0928 A3                INC     DPTR
0929 E0                MOVX    A,@DPTR
092A FB                MOV     R3,A
092B 120000      E     LCALL   ?C?FPMUL
092E D003              POP     AR3
0930 D002              POP     AR2
0932 D001              POP     AR1
0934 D000              POP     AR0
0936 120000      E     LCALL   ?C?FPSUB
0939 E4                CLR     A
093A FB                MOV     R3,A
093B FA                MOV     R2,A
093C F9                MOV     R1,A
093D 7840              MOV     R0,#040H
093F 120000      E     LCALL   ?C?FPMUL
0942 900000      R     MOV     DPTR,#aP
0945 E0                MOVX    A,@DPTR
0946 F8                MOV     R0,A
0947 A3                INC     DPTR
0948 E0                MOVX    A,@DPTR
0949 F9                MOV     R1,A
094A A3                INC     DPTR
C51 COMPILER V9.51   IMU_FUNCTIONS                                                         02/16/2018 15:56:04 PAGE 64  

094B E0                MOVX    A,@DPTR
094C FA                MOV     R2,A
094D A3                INC     DPTR
094E E0                MOVX    A,@DPTR
094F FB                MOV     R3,A
0950 120000      E     LCALL   ?C?FPSUB
0953 900000      R     MOV     DPTR,#qL+04H
0956 E0                MOVX    A,@DPTR
0957 F8                MOV     R0,A
0958 A3                INC     DPTR
0959 E0                MOVX    A,@DPTR
095A F9                MOV     R1,A
095B A3                INC     DPTR
095C E0                MOVX    A,@DPTR
095D FA                MOV     R2,A
095E A3                INC     DPTR
095F E0                MOVX    A,@DPTR
0960 FB                MOV     R3,A
0961 120000      E     LCALL   ?C?FPMUL
0964 D003              POP     AR3
0966 D002              POP     AR2
0968 D001              POP     AR1
096A D000              POP     AR0
096C 120000      E     LCALL   ?C?FPADD
096F 7B82              MOV     R3,#082H
0971 7A51              MOV     R2,#051H
0973 79C3              MOV     R1,#0C3H
0975 7840              MOV     R0,#040H
0977 120000      E     LCALL   ?C?FPMUL
097A 900000      R     MOV     DPTR,#Napla+0CH
097D 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 456
0980 900000      R     MOV     DPTR,#g+08H
0983 E0                MOVX    A,@DPTR
0984 FC                MOV     R4,A
0985 A3                INC     DPTR
0986 E0                MOVX    A,@DPTR
0987 FD                MOV     R5,A
0988 A3                INC     DPTR
0989 E0                MOVX    A,@DPTR
098A FE                MOV     R6,A
098B A3                INC     DPTR
098C E0                MOVX    A,@DPTR
098D FF                MOV     R7,A
098E 900000      R     MOV     DPTR,#qL+08H
0991 E0                MOVX    A,@DPTR
0992 F8                MOV     R0,A
0993 A3                INC     DPTR
0994 E0                MOVX    A,@DPTR
0995 F9                MOV     R1,A
0996 A3                INC     DPTR
0997 E0                MOVX    A,@DPTR
0998 FA                MOV     R2,A
0999 A3                INC     DPTR
099A E0                MOVX    A,@DPTR
099B FB                MOV     R3,A
099C 120000      E     LCALL   ?C?FPMUL
099F C004              PUSH    AR4
09A1 C005              PUSH    AR5
09A3 C006              PUSH    AR6
09A5 C007              PUSH    AR7
09A7 900000      R     MOV     DPTR,#g+04H
C51 COMPILER V9.51   IMU_FUNCTIONS                                                         02/16/2018 15:56:04 PAGE 65  

09AA E0                MOVX    A,@DPTR
09AB FC                MOV     R4,A
09AC A3                INC     DPTR
09AD E0                MOVX    A,@DPTR
09AE FD                MOV     R5,A
09AF A3                INC     DPTR
09B0 E0                MOVX    A,@DPTR
09B1 FE                MOV     R6,A
09B2 A3                INC     DPTR
09B3 E0                MOVX    A,@DPTR
09B4 FF                MOV     R7,A
09B5 900000      R     MOV     DPTR,#qL+04H
09B8 E0                MOVX    A,@DPTR
09B9 F8                MOV     R0,A
09BA A3                INC     DPTR
09BB E0                MOVX    A,@DPTR
09BC F9                MOV     R1,A
09BD A3                INC     DPTR
09BE E0                MOVX    A,@DPTR
09BF FA                MOV     R2,A
09C0 A3                INC     DPTR
09C1 E0                MOVX    A,@DPTR
09C2 FB                MOV     R3,A
09C3 120000      E     LCALL   ?C?FPMUL
09C6 D003              POP     AR3
09C8 D002              POP     AR2
09CA D001              POP     AR1
09CC D000              POP     AR0
09CE 120000      E     LCALL   ?C?FPADD
09D1 C004              PUSH    AR4
09D3 C005              PUSH    AR5
09D5 C006              PUSH    AR6
09D7 C007              PUSH    AR7
09D9 900000      R     MOV     DPTR,#g+0CH
09DC E0                MOVX    A,@DPTR
09DD FC                MOV     R4,A
09DE A3                INC     DPTR
09DF E0                MOVX    A,@DPTR
09E0 FD                MOV     R5,A
09E1 A3                INC     DPTR
09E2 E0                MOVX    A,@DPTR
09E3 FE                MOV     R6,A
09E4 A3                INC     DPTR
09E5 E0                MOVX    A,@DPTR
09E6 FF                MOV     R7,A
09E7 900000      R     MOV     DPTR,#qL+0CH
09EA E0                MOVX    A,@DPTR
09EB F8                MOV     R0,A
09EC A3                INC     DPTR
09ED E0                MOVX    A,@DPTR
09EE F9                MOV     R1,A
09EF A3                INC     DPTR
09F0 E0                MOVX    A,@DPTR
09F1 FA                MOV     R2,A
09F2 A3                INC     DPTR
09F3 E0                MOVX    A,@DPTR
09F4 FB                MOV     R3,A
09F5 120000      E     LCALL   ?C?FPMUL
09F8 D003              POP     AR3
09FA D002              POP     AR2
09FC D001              POP     AR1
09FE D000              POP     AR0
C51 COMPILER V9.51   IMU_FUNCTIONS                                                         02/16/2018 15:56:04 PAGE 66  

0A00 120000      E     LCALL   ?C?FPADD
0A03 120000      E     LCALL   ?C?FPNEG
0A06 E4                CLR     A
0A07 FB                MOV     R3,A
0A08 FA                MOV     R2,A
0A09 F9                MOV     R1,A
0A0A 783F              MOV     R0,#03FH
0A0C 120000      E     LCALL   ?C?FPMUL
0A0F 900000      R     MOV     DPTR,#Napla
0A12 E0                MOVX    A,@DPTR
0A13 F8                MOV     R0,A
0A14 A3                INC     DPTR
0A15 E0                MOVX    A,@DPTR
0A16 F9                MOV     R1,A
0A17 A3                INC     DPTR
0A18 E0                MOVX    A,@DPTR
0A19 FA                MOV     R2,A
0A1A A3                INC     DPTR
0A1B E0                MOVX    A,@DPTR
0A1C FB                MOV     R3,A
0A1D 120000      E     LCALL   ?C?FPSUB
0A20 900000      R     MOV     DPTR,#qd0
0A23 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 457
0A26 900000      R     MOV     DPTR,#g+08H
0A29 E0                MOVX    A,@DPTR
0A2A FC                MOV     R4,A
0A2B A3                INC     DPTR
0A2C E0                MOVX    A,@DPTR
0A2D FD                MOV     R5,A
0A2E A3                INC     DPTR
0A2F E0                MOVX    A,@DPTR
0A30 FE                MOV     R6,A
0A31 A3                INC     DPTR
0A32 E0                MOVX    A,@DPTR
0A33 FF                MOV     R7,A
0A34 900000      R     MOV     DPTR,#qL+0CH
0A37 E0                MOVX    A,@DPTR
0A38 F8                MOV     R0,A
0A39 A3                INC     DPTR
0A3A E0                MOVX    A,@DPTR
0A3B F9                MOV     R1,A
0A3C A3                INC     DPTR
0A3D E0                MOVX    A,@DPTR
0A3E FA                MOV     R2,A
0A3F A3                INC     DPTR
0A40 E0                MOVX    A,@DPTR
0A41 FB                MOV     R3,A
0A42 120000      E     LCALL   ?C?FPMUL
0A45 C004              PUSH    AR4
0A47 C005              PUSH    AR5
0A49 C006              PUSH    AR6
0A4B C007              PUSH    AR7
0A4D 900000      R     MOV     DPTR,#g+0CH
0A50 E0                MOVX    A,@DPTR
0A51 FC                MOV     R4,A
0A52 A3                INC     DPTR
0A53 E0                MOVX    A,@DPTR
0A54 FD                MOV     R5,A
0A55 A3                INC     DPTR
0A56 E0                MOVX    A,@DPTR
0A57 FE                MOV     R6,A
C51 COMPILER V9.51   IMU_FUNCTIONS                                                         02/16/2018 15:56:04 PAGE 67  

0A58 A3                INC     DPTR
0A59 E0                MOVX    A,@DPTR
0A5A FF                MOV     R7,A
0A5B 900000      R     MOV     DPTR,#qL+08H
0A5E E0                MOVX    A,@DPTR
0A5F F8                MOV     R0,A
0A60 A3                INC     DPTR
0A61 E0                MOVX    A,@DPTR
0A62 F9                MOV     R1,A
0A63 A3                INC     DPTR
0A64 E0                MOVX    A,@DPTR
0A65 FA                MOV     R2,A
0A66 A3                INC     DPTR
0A67 E0                MOVX    A,@DPTR
0A68 FB                MOV     R3,A
0A69 120000      E     LCALL   ?C?FPMUL
0A6C D003              POP     AR3
0A6E D002              POP     AR2
0A70 D001              POP     AR1
0A72 D000              POP     AR0
0A74 120000      E     LCALL   ?C?FPSUB
0A77 C004              PUSH    AR4
0A79 C005              PUSH    AR5
0A7B C006              PUSH    AR6
0A7D C007              PUSH    AR7
0A7F 900000      R     MOV     DPTR,#g+04H
0A82 E0                MOVX    A,@DPTR
0A83 FC                MOV     R4,A
0A84 A3                INC     DPTR
0A85 E0                MOVX    A,@DPTR
0A86 FD                MOV     R5,A
0A87 A3                INC     DPTR
0A88 E0                MOVX    A,@DPTR
0A89 FE                MOV     R6,A
0A8A A3                INC     DPTR
0A8B E0                MOVX    A,@DPTR
0A8C FF                MOV     R7,A
0A8D 900000      R     MOV     DPTR,#qL
0A90 E0                MOVX    A,@DPTR
0A91 F8                MOV     R0,A
0A92 A3                INC     DPTR
0A93 E0                MOVX    A,@DPTR
0A94 F9                MOV     R1,A
0A95 A3                INC     DPTR
0A96 E0                MOVX    A,@DPTR
0A97 FA                MOV     R2,A
0A98 A3                INC     DPTR
0A99 E0                MOVX    A,@DPTR
0A9A FB                MOV     R3,A
0A9B 120000      E     LCALL   ?C?FPMUL
0A9E D003              POP     AR3
0AA0 D002              POP     AR2
0AA2 D001              POP     AR1
0AA4 D000              POP     AR0
0AA6 120000      E     LCALL   ?C?FPADD
0AA9 E4                CLR     A
0AAA FB                MOV     R3,A
0AAB FA                MOV     R2,A
0AAC F9                MOV     R1,A
0AAD 783F              MOV     R0,#03FH
0AAF 120000      E     LCALL   ?C?FPMUL
0AB2 900000      R     MOV     DPTR,#Napla+04H
C51 COMPILER V9.51   IMU_FUNCTIONS                                                         02/16/2018 15:56:04 PAGE 68  

0AB5 E0                MOVX    A,@DPTR
0AB6 F8                MOV     R0,A
0AB7 A3                INC     DPTR
0AB8 E0                MOVX    A,@DPTR
0AB9 F9                MOV     R1,A
0ABA A3                INC     DPTR
0ABB E0                MOVX    A,@DPTR
0ABC FA                MOV     R2,A
0ABD A3                INC     DPTR
0ABE E0                MOVX    A,@DPTR
0ABF FB                MOV     R3,A
0AC0 120000      E     LCALL   ?C?FPSUB
0AC3 900000      R     MOV     DPTR,#qd1
0AC6 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 458
0AC9 900000      R     MOV     DPTR,#g+0CH
0ACC E0                MOVX    A,@DPTR
0ACD FC                MOV     R4,A
0ACE A3                INC     DPTR
0ACF E0                MOVX    A,@DPTR
0AD0 FD                MOV     R5,A
0AD1 A3                INC     DPTR
0AD2 E0                MOVX    A,@DPTR
0AD3 FE                MOV     R6,A
0AD4 A3                INC     DPTR
0AD5 E0                MOVX    A,@DPTR
0AD6 FF                MOV     R7,A
0AD7 900000      R     MOV     DPTR,#qL+04H
0ADA E0                MOVX    A,@DPTR
0ADB F8                MOV     R0,A
0ADC A3                INC     DPTR
0ADD E0                MOVX    A,@DPTR
0ADE F9                MOV     R1,A
0ADF A3                INC     DPTR
0AE0 E0                MOVX    A,@DPTR
0AE1 FA                MOV     R2,A
0AE2 A3                INC     DPTR
0AE3 E0                MOVX    A,@DPTR
0AE4 FB                MOV     R3,A
0AE5 120000      E     LCALL   ?C?FPMUL
0AE8 C004              PUSH    AR4
0AEA C005              PUSH    AR5
0AEC C006              PUSH    AR6
0AEE C007              PUSH    AR7
0AF0 900000      R     MOV     DPTR,#g+04H
0AF3 E0                MOVX    A,@DPTR
0AF4 FC                MOV     R4,A
0AF5 A3                INC     DPTR
0AF6 E0                MOVX    A,@DPTR
0AF7 FD                MOV     R5,A
0AF8 A3                INC     DPTR
0AF9 E0                MOVX    A,@DPTR
0AFA FE                MOV     R6,A
0AFB A3                INC     DPTR
0AFC E0                MOVX    A,@DPTR
0AFD FF                MOV     R7,A
0AFE 900000      R     MOV     DPTR,#qL+0CH
0B01 E0                MOVX    A,@DPTR
0B02 F8                MOV     R0,A
0B03 A3                INC     DPTR
0B04 E0                MOVX    A,@DPTR
0B05 F9                MOV     R1,A
C51 COMPILER V9.51   IMU_FUNCTIONS                                                         02/16/2018 15:56:04 PAGE 69  

0B06 A3                INC     DPTR
0B07 E0                MOVX    A,@DPTR
0B08 FA                MOV     R2,A
0B09 A3                INC     DPTR
0B0A E0                MOVX    A,@DPTR
0B0B FB                MOV     R3,A
0B0C 120000      E     LCALL   ?C?FPMUL
0B0F D003              POP     AR3
0B11 D002              POP     AR2
0B13 D001              POP     AR1
0B15 D000              POP     AR0
0B17 120000      E     LCALL   ?C?FPSUB
0B1A C004              PUSH    AR4
0B1C C005              PUSH    AR5
0B1E C006              PUSH    AR6
0B20 C007              PUSH    AR7
0B22 900000      R     MOV     DPTR,#g+08H
0B25 E0                MOVX    A,@DPTR
0B26 FC                MOV     R4,A
0B27 A3                INC     DPTR
0B28 E0                MOVX    A,@DPTR
0B29 FD                MOV     R5,A
0B2A A3                INC     DPTR
0B2B E0                MOVX    A,@DPTR
0B2C FE                MOV     R6,A
0B2D A3                INC     DPTR
0B2E E0                MOVX    A,@DPTR
0B2F FF                MOV     R7,A
0B30 900000      R     MOV     DPTR,#qL
0B33 E0                MOVX    A,@DPTR
0B34 F8                MOV     R0,A
0B35 A3                INC     DPTR
0B36 E0                MOVX    A,@DPTR
0B37 F9                MOV     R1,A
0B38 A3                INC     DPTR
0B39 E0                MOVX    A,@DPTR
0B3A FA                MOV     R2,A
0B3B A3                INC     DPTR
0B3C E0                MOVX    A,@DPTR
0B3D FB                MOV     R3,A
0B3E 120000      E     LCALL   ?C?FPMUL
0B41 D003              POP     AR3
0B43 D002              POP     AR2
0B45 D001              POP     AR1
0B47 D000              POP     AR0
0B49 120000      E     LCALL   ?C?FPADD
0B4C E4                CLR     A
0B4D FB                MOV     R3,A
0B4E FA                MOV     R2,A
0B4F F9                MOV     R1,A
0B50 783F              MOV     R0,#03FH
0B52 120000      E     LCALL   ?C?FPMUL
0B55 900000      R     MOV     DPTR,#Napla+08H
0B58 E0                MOVX    A,@DPTR
0B59 F8                MOV     R0,A
0B5A A3                INC     DPTR
0B5B E0                MOVX    A,@DPTR
0B5C F9                MOV     R1,A
0B5D A3                INC     DPTR
0B5E E0                MOVX    A,@DPTR
0B5F FA                MOV     R2,A
0B60 A3                INC     DPTR
C51 COMPILER V9.51   IMU_FUNCTIONS                                                         02/16/2018 15:56:04 PAGE 70  

0B61 E0                MOVX    A,@DPTR
0B62 FB                MOV     R3,A
0B63 120000      E     LCALL   ?C?FPSUB
0B66 900000      R     MOV     DPTR,#qd2
0B69 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 459
0B6C 900000      R     MOV     DPTR,#g+04H
0B6F E0                MOVX    A,@DPTR
0B70 FC                MOV     R4,A
0B71 A3                INC     DPTR
0B72 E0                MOVX    A,@DPTR
0B73 FD                MOV     R5,A
0B74 A3                INC     DPTR
0B75 E0                MOVX    A,@DPTR
0B76 FE                MOV     R6,A
0B77 A3                INC     DPTR
0B78 E0                MOVX    A,@DPTR
0B79 FF                MOV     R7,A
0B7A 900000      R     MOV     DPTR,#qL+08H
0B7D E0                MOVX    A,@DPTR
0B7E F8                MOV     R0,A
0B7F A3                INC     DPTR
0B80 E0                MOVX    A,@DPTR
0B81 F9                MOV     R1,A
0B82 A3                INC     DPTR
0B83 E0                MOVX    A,@DPTR
0B84 FA                MOV     R2,A
0B85 A3                INC     DPTR
0B86 E0                MOVX    A,@DPTR
0B87 FB                MOV     R3,A
0B88 120000      E     LCALL   ?C?FPMUL
0B8B C004              PUSH    AR4
0B8D C005              PUSH    AR5
0B8F C006              PUSH    AR6
0B91 C007              PUSH    AR7
0B93 900000      R     MOV     DPTR,#g+08H
0B96 E0                MOVX    A,@DPTR
0B97 FC                MOV     R4,A
0B98 A3                INC     DPTR
0B99 E0                MOVX    A,@DPTR
0B9A FD                MOV     R5,A
0B9B A3                INC     DPTR
0B9C E0                MOVX    A,@DPTR
0B9D FE                MOV     R6,A
0B9E A3                INC     DPTR
0B9F E0                MOVX    A,@DPTR
0BA0 FF                MOV     R7,A
0BA1 900000      R     MOV     DPTR,#qL+04H
0BA4 E0                MOVX    A,@DPTR
0BA5 F8                MOV     R0,A
0BA6 A3                INC     DPTR
0BA7 E0                MOVX    A,@DPTR
0BA8 F9                MOV     R1,A
0BA9 A3                INC     DPTR
0BAA E0                MOVX    A,@DPTR
0BAB FA                MOV     R2,A
0BAC A3                INC     DPTR
0BAD E0                MOVX    A,@DPTR
0BAE FB                MOV     R3,A
0BAF 120000      E     LCALL   ?C?FPMUL
0BB2 D003              POP     AR3
0BB4 D002              POP     AR2
C51 COMPILER V9.51   IMU_FUNCTIONS                                                         02/16/2018 15:56:04 PAGE 71  

0BB6 D001              POP     AR1
0BB8 D000              POP     AR0
0BBA 120000      E     LCALL   ?C?FPSUB
0BBD C004              PUSH    AR4
0BBF C005              PUSH    AR5
0BC1 C006              PUSH    AR6
0BC3 C007              PUSH    AR7
0BC5 900000      R     MOV     DPTR,#g+0CH
0BC8 E0                MOVX    A,@DPTR
0BC9 FC                MOV     R4,A
0BCA A3                INC     DPTR
0BCB E0                MOVX    A,@DPTR
0BCC FD                MOV     R5,A
0BCD A3                INC     DPTR
0BCE E0                MOVX    A,@DPTR
0BCF FE                MOV     R6,A
0BD0 A3                INC     DPTR
0BD1 E0                MOVX    A,@DPTR
0BD2 FF                MOV     R7,A
0BD3 A3                INC     DPTR
0BD4 E0                MOVX    A,@DPTR
0BD5 F8                MOV     R0,A
0BD6 A3                INC     DPTR
0BD7 E0                MOVX    A,@DPTR
0BD8 F9                MOV     R1,A
0BD9 A3                INC     DPTR
0BDA E0                MOVX    A,@DPTR
0BDB FA                MOV     R2,A
0BDC A3                INC     DPTR
0BDD E0                MOVX    A,@DPTR
0BDE FB                MOV     R3,A
0BDF 120000      E     LCALL   ?C?FPMUL
0BE2 D003              POP     AR3
0BE4 D002              POP     AR2
0BE6 D001              POP     AR1
0BE8 D000              POP     AR0
0BEA 120000      E     LCALL   ?C?FPADD
0BED E4                CLR     A
0BEE FB                MOV     R3,A
0BEF FA                MOV     R2,A
0BF0 F9                MOV     R1,A
0BF1 783F              MOV     R0,#03FH
0BF3 120000      E     LCALL   ?C?FPMUL
0BF6 900000      R     MOV     DPTR,#Napla+0CH
0BF9 E0                MOVX    A,@DPTR
0BFA F8                MOV     R0,A
0BFB A3                INC     DPTR
0BFC E0                MOVX    A,@DPTR
0BFD F9                MOV     R1,A
0BFE A3                INC     DPTR
0BFF E0                MOVX    A,@DPTR
0C00 FA                MOV     R2,A
0C01 A3                INC     DPTR
0C02 E0                MOVX    A,@DPTR
0C03 FB                MOV     R3,A
0C04 120000      E     LCALL   ?C?FPSUB
0C07 900000      R     MOV     DPTR,#qd3
0C0A 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 461
0C0D 900000      R     MOV     DPTR,#qL
0C10 E0                MOVX    A,@DPTR
0C11 F8                MOV     R0,A
C51 COMPILER V9.51   IMU_FUNCTIONS                                                         02/16/2018 15:56:04 PAGE 72  

0C12 A3                INC     DPTR
0C13 E0                MOVX    A,@DPTR
0C14 F9                MOV     R1,A
0C15 A3                INC     DPTR
0C16 E0                MOVX    A,@DPTR
0C17 FA                MOV     R2,A
0C18 A3                INC     DPTR
0C19 E0                MOVX    A,@DPTR
0C1A FB                MOV     R3,A
0C1B C000              PUSH    AR0
0C1D C001              PUSH    AR1
0C1F C002              PUSH    AR2
0C21 C003              PUSH    AR3
0C23 900000      R     MOV     DPTR,#time
0C26 E0                MOVX    A,@DPTR
0C27 FC                MOV     R4,A
0C28 A3                INC     DPTR
0C29 E0                MOVX    A,@DPTR
0C2A FD                MOV     R5,A
0C2B A3                INC     DPTR
0C2C E0                MOVX    A,@DPTR
0C2D FE                MOV     R6,A
0C2E A3                INC     DPTR
0C2F E0                MOVX    A,@DPTR
0C30 FF                MOV     R7,A
0C31 900000      R     MOV     DPTR,#qd0
0C34 E0                MOVX    A,@DPTR
0C35 F8                MOV     R0,A
0C36 A3                INC     DPTR
0C37 E0                MOVX    A,@DPTR
0C38 F9                MOV     R1,A
0C39 A3                INC     DPTR
0C3A E0                MOVX    A,@DPTR
0C3B FA                MOV     R2,A
0C3C A3                INC     DPTR
0C3D E0                MOVX    A,@DPTR
0C3E FB                MOV     R3,A
0C3F 120000      E     LCALL   ?C?FPMUL
0C42 D003              POP     AR3
0C44 D002              POP     AR2
0C46 D001              POP     AR1
0C48 D000              POP     AR0
0C4A 120000      E     LCALL   ?C?FPADD
0C4D 900000      R     MOV     DPTR,#qL
0C50 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 462
0C53 900000      R     MOV     DPTR,#qL+04H
0C56 E0                MOVX    A,@DPTR
0C57 F8                MOV     R0,A
0C58 A3                INC     DPTR
0C59 E0                MOVX    A,@DPTR
0C5A F9                MOV     R1,A
0C5B A3                INC     DPTR
0C5C E0                MOVX    A,@DPTR
0C5D FA                MOV     R2,A
0C5E A3                INC     DPTR
0C5F E0                MOVX    A,@DPTR
0C60 FB                MOV     R3,A
0C61 C000              PUSH    AR0
0C63 C001              PUSH    AR1
0C65 C002              PUSH    AR2
0C67 C003              PUSH    AR3
C51 COMPILER V9.51   IMU_FUNCTIONS                                                         02/16/2018 15:56:04 PAGE 73  

0C69 900000      R     MOV     DPTR,#time
0C6C E0                MOVX    A,@DPTR
0C6D FC                MOV     R4,A
0C6E A3                INC     DPTR
0C6F E0                MOVX    A,@DPTR
0C70 FD                MOV     R5,A
0C71 A3                INC     DPTR
0C72 E0                MOVX    A,@DPTR
0C73 FE                MOV     R6,A
0C74 A3                INC     DPTR
0C75 E0                MOVX    A,@DPTR
0C76 FF                MOV     R7,A
0C77 900000      R     MOV     DPTR,#qd1
0C7A E0                MOVX    A,@DPTR
0C7B F8                MOV     R0,A
0C7C A3                INC     DPTR
0C7D E0                MOVX    A,@DPTR
0C7E F9                MOV     R1,A
0C7F A3                INC     DPTR
0C80 E0                MOVX    A,@DPTR
0C81 FA                MOV     R2,A
0C82 A3                INC     DPTR
0C83 E0                MOVX    A,@DPTR
0C84 FB                MOV     R3,A
0C85 120000      E     LCALL   ?C?FPMUL
0C88 D003              POP     AR3
0C8A D002              POP     AR2
0C8C D001              POP     AR1
0C8E D000              POP     AR0
0C90 120000      E     LCALL   ?C?FPADD
0C93 900000      R     MOV     DPTR,#qL+04H
0C96 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 463
0C99 900000      R     MOV     DPTR,#qL+08H
0C9C E0                MOVX    A,@DPTR
0C9D F8                MOV     R0,A
0C9E A3                INC     DPTR
0C9F E0                MOVX    A,@DPTR
0CA0 F9                MOV     R1,A
0CA1 A3                INC     DPTR
0CA2 E0                MOVX    A,@DPTR
0CA3 FA                MOV     R2,A
0CA4 A3                INC     DPTR
0CA5 E0                MOVX    A,@DPTR
0CA6 FB                MOV     R3,A
0CA7 C000              PUSH    AR0
0CA9 C001              PUSH    AR1
0CAB C002              PUSH    AR2
0CAD C003              PUSH    AR3
0CAF 900000      R     MOV     DPTR,#time
0CB2 E0                MOVX    A,@DPTR
0CB3 FC                MOV     R4,A
0CB4 A3                INC     DPTR
0CB5 E0                MOVX    A,@DPTR
0CB6 FD                MOV     R5,A
0CB7 A3                INC     DPTR
0CB8 E0                MOVX    A,@DPTR
0CB9 FE                MOV     R6,A
0CBA A3                INC     DPTR
0CBB E0                MOVX    A,@DPTR
0CBC FF                MOV     R7,A
0CBD 900000      R     MOV     DPTR,#qd2
C51 COMPILER V9.51   IMU_FUNCTIONS                                                         02/16/2018 15:56:04 PAGE 74  

0CC0 E0                MOVX    A,@DPTR
0CC1 F8                MOV     R0,A
0CC2 A3                INC     DPTR
0CC3 E0                MOVX    A,@DPTR
0CC4 F9                MOV     R1,A
0CC5 A3                INC     DPTR
0CC6 E0                MOVX    A,@DPTR
0CC7 FA                MOV     R2,A
0CC8 A3                INC     DPTR
0CC9 E0                MOVX    A,@DPTR
0CCA FB                MOV     R3,A
0CCB 120000      E     LCALL   ?C?FPMUL
0CCE D003              POP     AR3
0CD0 D002              POP     AR2
0CD2 D001              POP     AR1
0CD4 D000              POP     AR0
0CD6 120000      E     LCALL   ?C?FPADD
0CD9 900000      R     MOV     DPTR,#qL+08H
0CDC 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 464
0CDF 900000      R     MOV     DPTR,#qL+0CH
0CE2 E0                MOVX    A,@DPTR
0CE3 F8                MOV     R0,A
0CE4 A3                INC     DPTR
0CE5 E0                MOVX    A,@DPTR
0CE6 F9                MOV     R1,A
0CE7 A3                INC     DPTR
0CE8 E0                MOVX    A,@DPTR
0CE9 FA                MOV     R2,A
0CEA A3                INC     DPTR
0CEB E0                MOVX    A,@DPTR
0CEC FB                MOV     R3,A
0CED C000              PUSH    AR0
0CEF C001              PUSH    AR1
0CF1 C002              PUSH    AR2
0CF3 C003              PUSH    AR3
0CF5 A3                INC     DPTR
0CF6 E0                MOVX    A,@DPTR
0CF7 FC                MOV     R4,A
0CF8 A3                INC     DPTR
0CF9 E0                MOVX    A,@DPTR
0CFA FD                MOV     R5,A
0CFB A3                INC     DPTR
0CFC E0                MOVX    A,@DPTR
0CFD FE                MOV     R6,A
0CFE A3                INC     DPTR
0CFF E0                MOVX    A,@DPTR
0D00 FF                MOV     R7,A
0D01 900000      R     MOV     DPTR,#qd3
0D04 E0                MOVX    A,@DPTR
0D05 F8                MOV     R0,A
0D06 A3                INC     DPTR
0D07 E0                MOVX    A,@DPTR
0D08 F9                MOV     R1,A
0D09 A3                INC     DPTR
0D0A E0                MOVX    A,@DPTR
0D0B FA                MOV     R2,A
0D0C A3                INC     DPTR
0D0D E0                MOVX    A,@DPTR
0D0E FB                MOV     R3,A
0D0F 120000      E     LCALL   ?C?FPMUL
0D12 D003              POP     AR3
C51 COMPILER V9.51   IMU_FUNCTIONS                                                         02/16/2018 15:56:04 PAGE 75  

0D14 D002              POP     AR2
0D16 D001              POP     AR1
0D18 D000              POP     AR0
0D1A 120000      E     LCALL   ?C?FPADD
0D1D 900000      R     MOV     DPTR,#qL+0CH
0D20 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 465
0D23 7B01              MOV     R3,#01H
0D25 7A00        R     MOV     R2,#HIGH qL
0D27 7900        R     MOV     R1,#LOW qL
0D29 120000      E     LCALL   _v4_normalize
                                           ; SOURCE LINE # 468
0D2C 900000      R     MOV     DPTR,#qL
0D2F E0                MOVX    A,@DPTR
0D30 FC                MOV     R4,A
0D31 A3                INC     DPTR
0D32 E0                MOVX    A,@DPTR
0D33 FD                MOV     R5,A
0D34 A3                INC     DPTR
0D35 E0                MOVX    A,@DPTR
0D36 FE                MOV     R6,A
0D37 A3                INC     DPTR
0D38 E0                MOVX    A,@DPTR
0D39 FF                MOV     R7,A
0D3A 900000      E     MOV     DPTR,#Quat
0D3D 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 469
0D40 900000      R     MOV     DPTR,#qL+04H
0D43 E0                MOVX    A,@DPTR
0D44 FC                MOV     R4,A
0D45 A3                INC     DPTR
0D46 E0                MOVX    A,@DPTR
0D47 FD                MOV     R5,A
0D48 A3                INC     DPTR
0D49 E0                MOVX    A,@DPTR
0D4A FE                MOV     R6,A
0D4B A3                INC     DPTR
0D4C E0                MOVX    A,@DPTR
0D4D FF                MOV     R7,A
0D4E 900000      E     MOV     DPTR,#Quat+04H
0D51 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 470
0D54 900000      R     MOV     DPTR,#qL+08H
0D57 E0                MOVX    A,@DPTR
0D58 FC                MOV     R4,A
0D59 A3                INC     DPTR
0D5A E0                MOVX    A,@DPTR
0D5B FD                MOV     R5,A
0D5C A3                INC     DPTR
0D5D E0                MOVX    A,@DPTR
0D5E FE                MOV     R6,A
0D5F A3                INC     DPTR
0D60 E0                MOVX    A,@DPTR
0D61 FF                MOV     R7,A
0D62 900000      E     MOV     DPTR,#Quat+08H
0D65 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 471
0D68 900000      R     MOV     DPTR,#qL+0CH
0D6B E0                MOVX    A,@DPTR
0D6C FC                MOV     R4,A
0D6D A3                INC     DPTR
0D6E E0                MOVX    A,@DPTR
C51 COMPILER V9.51   IMU_FUNCTIONS                                                         02/16/2018 15:56:04 PAGE 76  

0D6F FD                MOV     R5,A
0D70 A3                INC     DPTR
0D71 E0                MOVX    A,@DPTR
0D72 FE                MOV     R6,A
0D73 A3                INC     DPTR
0D74 E0                MOVX    A,@DPTR
0D75 FF                MOV     R7,A
0D76 900000      E     MOV     DPTR,#Quat+0CH
0D79 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 472
                                           ; SOURCE LINE # 473
                                           ; SOURCE LINE # 475
                                           ; SOURCE LINE # 476
0D7C         ?C0044:
0D7C 22                RET     
             ; FUNCTION _ReadQuat (END)

             ; FUNCTION ReadAllIMUs (BEGIN)
                                           ; SOURCE LINE # 481
                                           ; SOURCE LINE # 483
0000 E4                CLR     A
0001 900000      R     MOV     DPTR,#tmp
0004 F0                MOVX    @DPTR,A
0005 A3                INC     DPTR
0006 F0                MOVX    @DPTR,A
0007 A3                INC     DPTR
0008 F0                MOVX    @DPTR,A
0009 A3                INC     DPTR
000A F0                MOVX    @DPTR,A
000B A3                INC     DPTR
000C F0                MOVX    @DPTR,A
000D A3                INC     DPTR
000E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 484
000F A3                INC     DPTR
0010 F0                MOVX    @DPTR,A
0011 A3                INC     DPTR
0012 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 486
0013 900000      R     MOV     DPTR,#k_imu
0016 F0                MOVX    @DPTR,A
0017         ?C0045:
0017 900000      E     MOV     DPTR,#N_IMU_Connected
001A E0                MOVX    A,@DPTR
001B FF                MOV     R7,A
001C 900000      R     MOV     DPTR,#k_imu
001F E0                MOVX    A,@DPTR
0020 FE                MOV     R6,A
0021 C3                CLR     C
0022 9F                SUBB    A,R7
0023 4003              JC      $ + 5H
0025 020000      R     LJMP    ?C0060
                                           ; SOURCE LINE # 488
0028 7400        E     MOV     A,#LOW IMU_connected
002A 2E                ADD     A,R6
002B F582              MOV     DPL,A
002D E4                CLR     A
002E 3400        E     ADDC    A,#HIGH IMU_connected
0030 F583              MOV     DPH,A
0032 E0                MOVX    A,@DPTR
0033 FF                MOV     R7,A
0034 7E00              MOV     R6,#00H
C51 COMPILER V9.51   IMU_FUNCTIONS                                                         02/16/2018 15:56:04 PAGE 77  

0036 120000      R     LCALL   _ChipSelector
                                           ; SOURCE LINE # 489
0039 900000      R     MOV     DPTR,#k_imu
003C E0                MOVX    A,@DPTR
003D 2400        E     ADD     A,#LOW IMU_connected
003F F582              MOV     DPL,A
0041 E4                CLR     A
0042 3400        E     ADDC    A,#HIGH IMU_connected
0044 F583              MOV     DPH,A
0046 E0                MOVX    A,@DPTR
0047 FF                MOV     R7,A
0048 7E00              MOV     R6,#00H
004A 120000      R     LCALL   _ReadIMU
                                           ; SOURCE LINE # 491
004D E4                CLR     A
004E 900000      R     MOV     DPTR,#j
0051 F0                MOVX    @DPTR,A
0052 A3                INC     DPTR
0053 F0                MOVX    @DPTR,A
0054         ?C0048:
0054 900000      R     MOV     DPTR,#j
0057 E0                MOVX    A,@DPTR
0058 FE                MOV     R6,A
0059 A3                INC     DPTR
005A E0                MOVX    A,@DPTR
005B FF                MOV     R7,A
005C C3                CLR     C
005D 9403              SUBB    A,#03H
005F EE                MOV     A,R6
0060 9400              SUBB    A,#00H
0062 4003              JC      $ + 5H
0064 020000      R     LJMP    ?C0049
                                           ; SOURCE LINE # 492
0067 EF                MOV     A,R7
0068 25E0              ADD     A,ACC
006A FF                MOV     R7,A
006B EE                MOV     A,R6
006C 33                RLC     A
006D FE                MOV     R6,A
006E 900000      R     MOV     DPTR,#k_imu
0071 E0                MOVX    A,@DPTR
0072 F9                MOV     R1,A
0073 2400        E     ADD     A,#LOW IMU_connected
0075 F582              MOV     DPL,A
0077 E4                CLR     A
0078 3400        E     ADDC    A,#HIGH IMU_connected
007A F583              MOV     DPH,A
007C E0                MOVX    A,@DPTR
007D FD                MOV     R5,A
007E 75F006            MOV     B,#06H
0081 A4                MUL     AB
0082 2400        E     ADD     A,#LOW Accel
0084 F582              MOV     DPL,A
0086 E4                CLR     A
0087 3400        E     ADDC    A,#HIGH Accel
0089 F583              MOV     DPH,A
008B E582              MOV     A,DPL
008D 2F                ADD     A,R7
008E F582              MOV     DPL,A
0090 E583              MOV     A,DPH
0092 3E                ADDC    A,R6
0093 F583              MOV     DPH,A
C51 COMPILER V9.51   IMU_FUNCTIONS                                                         02/16/2018 15:56:04 PAGE 78  

0095 E0                MOVX    A,@DPTR
0096 FB                MOV     R3,A
0097 900000      R     MOV     DPTR,#tmp
009A E4                CLR     A
009B F0                MOVX    @DPTR,A
009C A3                INC     DPTR
009D EB                MOV     A,R3
009E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 493
009F ED                MOV     A,R5
00A0 75F006            MOV     B,#06H
00A3 A4                MUL     AB
00A4 2400        E     ADD     A,#LOW Accel+01H
00A6 F582              MOV     DPL,A
00A8 E4                CLR     A
00A9 3400        E     ADDC    A,#HIGH Accel+01H
00AB F583              MOV     DPH,A
00AD E582              MOV     A,DPL
00AF 2F                ADD     A,R7
00B0 F582              MOV     DPL,A
00B2 E583              MOV     A,DPH
00B4 3E                ADDC    A,R6
00B5 F583              MOV     DPH,A
00B7 E0                MOVX    A,@DPTR
00B8 FD                MOV     R5,A
00B9 900000      R     MOV     DPTR,#tmp+01H
00BC E0                MOVX    A,@DPTR
00BD FC                MOV     R4,A
00BE ED                MOV     A,R5
00BF 900000      R     MOV     DPTR,#j+01H
00C2 E0                MOVX    A,@DPTR
00C3 25E0              ADD     A,ACC
00C5 FF                MOV     R7,A
00C6 900000      R     MOV     DPTR,#j
00C9 E0                MOVX    A,@DPTR
00CA 33                RLC     A
00CB FE                MOV     R6,A
00CC 75F025            MOV     B,#025H
00CF E9                MOV     A,R1
00D0 A4                MUL     AB
00D1 2400        E     ADD     A,#LOW g_imuNew+01H
00D3 F582              MOV     DPL,A
00D5 E5F0              MOV     A,B
00D7 3400        E     ADDC    A,#HIGH g_imuNew+01H
00D9 F583              MOV     DPH,A
00DB E582              MOV     A,DPL
00DD 2F                ADD     A,R7
00DE F582              MOV     DPL,A
00E0 E583              MOV     A,DPH
00E2 3E                ADDC    A,R6
00E3 F583              MOV     DPH,A
00E5 EC                MOV     A,R4
00E6 F0                MOVX    @DPTR,A
00E7 A3                INC     DPTR
00E8 ED                MOV     A,R5
00E9 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 494
00EA 900000      R     MOV     DPTR,#j+01H
00ED E0                MOVX    A,@DPTR
00EE 04                INC     A
00EF F0                MOVX    @DPTR,A
00F0 7006              JNZ     ?C0078
C51 COMPILER V9.51   IMU_FUNCTIONS                                                         02/16/2018 15:56:04 PAGE 79  

00F2 900000      R     MOV     DPTR,#j
00F5 E0                MOVX    A,@DPTR
00F6 04                INC     A
00F7 F0                MOVX    @DPTR,A
00F8         ?C0078:
00F8 020000      R     LJMP    ?C0048
00FB         ?C0049:
                                           ; SOURCE LINE # 496
00FB E4                CLR     A
00FC 900000      R     MOV     DPTR,#j
00FF F0                MOVX    @DPTR,A
0100 A3                INC     DPTR
0101 F0                MOVX    @DPTR,A
0102         ?C0051:
0102 900000      R     MOV     DPTR,#j
0105 E0                MOVX    A,@DPTR
0106 FE                MOV     R6,A
0107 A3                INC     DPTR
0108 E0                MOVX    A,@DPTR
0109 FF                MOV     R7,A
010A C3                CLR     C
010B 9403              SUBB    A,#03H
010D EE                MOV     A,R6
010E 9400              SUBB    A,#00H
0110 4003              JC      $ + 5H
0112 020000      R     LJMP    ?C0052
                                           ; SOURCE LINE # 497
0115 EF                MOV     A,R7
0116 25E0              ADD     A,ACC
0118 FF                MOV     R7,A
0119 EE                MOV     A,R6
011A 33                RLC     A
011B FE                MOV     R6,A
011C 900000      R     MOV     DPTR,#k_imu
011F E0                MOVX    A,@DPTR
0120 F9                MOV     R1,A
0121 2400        E     ADD     A,#LOW IMU_connected
0123 F582              MOV     DPL,A
0125 E4                CLR     A
0126 3400        E     ADDC    A,#HIGH IMU_connected
0128 F583              MOV     DPH,A
012A E0                MOVX    A,@DPTR
012B FD                MOV     R5,A
012C 75F006            MOV     B,#06H
012F A4                MUL     AB
0130 2400        E     ADD     A,#LOW Gyro
0132 F582              MOV     DPL,A
0134 E4                CLR     A
0135 3400        E     ADDC    A,#HIGH Gyro
0137 F583              MOV     DPH,A
0139 E582              MOV     A,DPL
013B 2F                ADD     A,R7
013C F582              MOV     DPL,A
013E E583              MOV     A,DPH
0140 3E                ADDC    A,R6
0141 F583              MOV     DPH,A
0143 E0                MOVX    A,@DPTR
0144 FB                MOV     R3,A
0145 900000      R     MOV     DPTR,#tmp
0148 E4                CLR     A
0149 F0                MOVX    @DPTR,A
014A A3                INC     DPTR
C51 COMPILER V9.51   IMU_FUNCTIONS                                                         02/16/2018 15:56:04 PAGE 80  

014B EB                MOV     A,R3
014C F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 498
014D ED                MOV     A,R5
014E 75F006            MOV     B,#06H
0151 A4                MUL     AB
0152 2400        E     ADD     A,#LOW Gyro+01H
0154 F582              MOV     DPL,A
0156 E4                CLR     A
0157 3400        E     ADDC    A,#HIGH Gyro+01H
0159 F583              MOV     DPH,A
015B E582              MOV     A,DPL
015D 2F                ADD     A,R7
015E F582              MOV     DPL,A
0160 E583              MOV     A,DPH
0162 3E                ADDC    A,R6
0163 F583              MOV     DPH,A
0165 E0                MOVX    A,@DPTR
0166 FD                MOV     R5,A
0167 900000      R     MOV     DPTR,#tmp+01H
016A E0                MOVX    A,@DPTR
016B FC                MOV     R4,A
016C ED                MOV     A,R5
016D 900000      R     MOV     DPTR,#j+01H
0170 E0                MOVX    A,@DPTR
0171 25E0              ADD     A,ACC
0173 FF                MOV     R7,A
0174 900000      R     MOV     DPTR,#j
0177 E0                MOVX    A,@DPTR
0178 33                RLC     A
0179 FE                MOV     R6,A
017A 75F025            MOV     B,#025H
017D E9                MOV     A,R1
017E A4                MUL     AB
017F 2400        E     ADD     A,#LOW g_imuNew+07H
0181 F582              MOV     DPL,A
0183 E5F0              MOV     A,B
0185 3400        E     ADDC    A,#HIGH g_imuNew+07H
0187 F583              MOV     DPH,A
0189 E582              MOV     A,DPL
018B 2F                ADD     A,R7
018C F582              MOV     DPL,A
018E E583              MOV     A,DPH
0190 3E                ADDC    A,R6
0191 F583              MOV     DPH,A
0193 EC                MOV     A,R4
0194 F0                MOVX    @DPTR,A
0195 A3                INC     DPTR
0196 ED                MOV     A,R5
0197 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 499
0198 900000      R     MOV     DPTR,#j+01H
019B E0                MOVX    A,@DPTR
019C 04                INC     A
019D F0                MOVX    @DPTR,A
019E 7006              JNZ     ?C0079
01A0 900000      R     MOV     DPTR,#j
01A3 E0                MOVX    A,@DPTR
01A4 04                INC     A
01A5 F0                MOVX    @DPTR,A
01A6         ?C0079:
01A6 020000      R     LJMP    ?C0051
C51 COMPILER V9.51   IMU_FUNCTIONS                                                         02/16/2018 15:56:04 PAGE 81  

01A9         ?C0052:
                                           ; SOURCE LINE # 501
01A9 E4                CLR     A
01AA 900000      R     MOV     DPTR,#j
01AD F0                MOVX    @DPTR,A
01AE A3                INC     DPTR
01AF F0                MOVX    @DPTR,A
01B0         ?C0054:
01B0 900000      R     MOV     DPTR,#j
01B3 E0                MOVX    A,@DPTR
01B4 FE                MOV     R6,A
01B5 A3                INC     DPTR
01B6 E0                MOVX    A,@DPTR
01B7 FF                MOV     R7,A
01B8 C3                CLR     C
01B9 9403              SUBB    A,#03H
01BB EE                MOV     A,R6
01BC 9400              SUBB    A,#00H
01BE 4003              JC      $ + 5H
01C0 020000      R     LJMP    ?C0055
                                           ; SOURCE LINE # 502
01C3 EF                MOV     A,R7
01C4 25E0              ADD     A,ACC
01C6 FF                MOV     R7,A
01C7 EE                MOV     A,R6
01C8 33                RLC     A
01C9 FE                MOV     R6,A
01CA 900000      R     MOV     DPTR,#k_imu
01CD E0                MOVX    A,@DPTR
01CE F9                MOV     R1,A
01CF 2400        E     ADD     A,#LOW IMU_connected
01D1 F582              MOV     DPL,A
01D3 E4                CLR     A
01D4 3400        E     ADDC    A,#HIGH IMU_connected
01D6 F583              MOV     DPH,A
01D8 E0                MOVX    A,@DPTR
01D9 FD                MOV     R5,A
01DA 75F006            MOV     B,#06H
01DD A4                MUL     AB
01DE 2400        E     ADD     A,#LOW Mag
01E0 F582              MOV     DPL,A
01E2 E4                CLR     A
01E3 3400        E     ADDC    A,#HIGH Mag
01E5 F583              MOV     DPH,A
01E7 E582              MOV     A,DPL
01E9 2F                ADD     A,R7
01EA F582              MOV     DPL,A
01EC E583              MOV     A,DPH
01EE 3E                ADDC    A,R6
01EF F583              MOV     DPH,A
01F1 E0                MOVX    A,@DPTR
01F2 FB                MOV     R3,A
01F3 900000      R     MOV     DPTR,#tmp
01F6 E4                CLR     A
01F7 F0                MOVX    @DPTR,A
01F8 A3                INC     DPTR
01F9 EB                MOV     A,R3
01FA F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 503
01FB ED                MOV     A,R5
01FC 75F006            MOV     B,#06H
01FF A4                MUL     AB
C51 COMPILER V9.51   IMU_FUNCTIONS                                                         02/16/2018 15:56:04 PAGE 82  

0200 2400        E     ADD     A,#LOW Mag+01H
0202 F582              MOV     DPL,A
0204 E4                CLR     A
0205 3400        E     ADDC    A,#HIGH Mag+01H
0207 F583              MOV     DPH,A
0209 E582              MOV     A,DPL
020B 2F                ADD     A,R7
020C F582              MOV     DPL,A
020E E583              MOV     A,DPH
0210 3E                ADDC    A,R6
0211 F583              MOV     DPH,A
0213 E0                MOVX    A,@DPTR
0214 FD                MOV     R5,A
0215 900000      R     MOV     DPTR,#tmp+01H
0218 E0                MOVX    A,@DPTR
0219 FC                MOV     R4,A
021A ED                MOV     A,R5
021B 900000      R     MOV     DPTR,#j+01H
021E E0                MOVX    A,@DPTR
021F 25E0              ADD     A,ACC
0221 FF                MOV     R7,A
0222 900000      R     MOV     DPTR,#j
0225 E0                MOVX    A,@DPTR
0226 33                RLC     A
0227 FE                MOV     R6,A
0228 75F025            MOV     B,#025H
022B E9                MOV     A,R1
022C A4                MUL     AB
022D 2400        E     ADD     A,#LOW g_imuNew+0DH
022F F582              MOV     DPL,A
0231 E5F0              MOV     A,B
0233 3400        E     ADDC    A,#HIGH g_imuNew+0DH
0235 F583              MOV     DPH,A
0237 E582              MOV     A,DPL
0239 2F                ADD     A,R7
023A F582              MOV     DPL,A
023C E583              MOV     A,DPH
023E 3E                ADDC    A,R6
023F F583              MOV     DPH,A
0241 EC                MOV     A,R4
0242 F0                MOVX    @DPTR,A
0243 A3                INC     DPTR
0244 ED                MOV     A,R5
0245 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 504
0246 900000      R     MOV     DPTR,#j+01H
0249 E0                MOVX    A,@DPTR
024A 04                INC     A
024B F0                MOVX    @DPTR,A
024C 7006              JNZ     ?C0080
024E 900000      R     MOV     DPTR,#j
0251 E0                MOVX    A,@DPTR
0252 04                INC     A
0253 F0                MOVX    @DPTR,A
0254         ?C0080:
0254 020000      R     LJMP    ?C0054
0257         ?C0055:
                                           ; SOURCE LINE # 507
0257 E4                CLR     A
0258 900000      R     MOV     DPTR,#j
025B F0                MOVX    @DPTR,A
025C A3                INC     DPTR
C51 COMPILER V9.51   IMU_FUNCTIONS                                                         02/16/2018 15:56:04 PAGE 83  

025D F0                MOVX    @DPTR,A
025E         ?C0057:
025E 900000      R     MOV     DPTR,#k_imu
0261 E0                MOVX    A,@DPTR
0262 707F              JNZ     ?C0058
0264 900000      R     MOV     DPTR,#j
0267 E0                MOVX    A,@DPTR
0268 FE                MOV     R6,A
0269 A3                INC     DPTR
026A E0                MOVX    A,@DPTR
026B FF                MOV     R7,A
026C C3                CLR     C
026D 9404              SUBB    A,#04H
026F EE                MOV     A,R6
0270 9400              SUBB    A,#00H
0272 506F              JNC     ?C0058
                                           ; SOURCE LINE # 508
0274 EF                MOV     A,R7
0275 7802              MOV     R0,#02H
0277         ?C0081:
0277 C3                CLR     C
0278 33                RLC     A
0279 CE                XCH     A,R6
027A 33                RLC     A
027B CE                XCH     A,R6
027C D8F9              DJNZ    R0,?C0081
027E 2400        E     ADD     A,#LOW Quat
0280 F582              MOV     DPL,A
0282 7400        E     MOV     A,#HIGH Quat
0284 3E                ADDC    A,R6
0285 F583              MOV     DPH,A
0287 E0                MOVX    A,@DPTR
0288 FC                MOV     R4,A
0289 A3                INC     DPTR
028A E0                MOVX    A,@DPTR
028B FD                MOV     R5,A
028C A3                INC     DPTR
028D E0                MOVX    A,@DPTR
028E FE                MOV     R6,A
028F A3                INC     DPTR
0290 E0                MOVX    A,@DPTR
0291 FF                MOV     R7,A
0292 C004              PUSH    AR4
0294 C005              PUSH    AR5
0296 C006              PUSH    AR6
0298 C007              PUSH    AR7
029A 900000      R     MOV     DPTR,#j
029D E0                MOVX    A,@DPTR
029E FE                MOV     R6,A
029F A3                INC     DPTR
02A0 E0                MOVX    A,@DPTR
02A1 7802              MOV     R0,#02H
02A3         ?C0082:
02A3 C3                CLR     C
02A4 33                RLC     A
02A5 CE                XCH     A,R6
02A6 33                RLC     A
02A7 CE                XCH     A,R6
02A8 D8F9              DJNZ    R0,?C0082
02AA FF                MOV     R7,A
02AB 900000      R     MOV     DPTR,#k_imu
02AE E0                MOVX    A,@DPTR
C51 COMPILER V9.51   IMU_FUNCTIONS                                                         02/16/2018 15:56:04 PAGE 84  

02AF 75F025            MOV     B,#025H
02B2 A4                MUL     AB
02B3 2400        E     ADD     A,#LOW g_imuNew+013H
02B5 F582              MOV     DPL,A
02B7 E5F0              MOV     A,B
02B9 3400        E     ADDC    A,#HIGH g_imuNew+013H
02BB F583              MOV     DPH,A
02BD E582              MOV     A,DPL
02BF 2F                ADD     A,R7
02C0 F582              MOV     DPL,A
02C2 E583              MOV     A,DPH
02C4 3E                ADDC    A,R6
02C5 F583              MOV     DPH,A
02C7 D007              POP     AR7
02C9 D006              POP     AR6
02CB D005              POP     AR5
02CD D004              POP     AR4
02CF 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 509
02D2 900000      R     MOV     DPTR,#j+01H
02D5 E0                MOVX    A,@DPTR
02D6 04                INC     A
02D7 F0                MOVX    @DPTR,A
02D8 7006              JNZ     ?C0083
02DA 900000      R     MOV     DPTR,#j
02DD E0                MOVX    A,@DPTR
02DE 04                INC     A
02DF F0                MOVX    @DPTR,A
02E0         ?C0083:
02E0 020000      R     LJMP    ?C0057
02E3         ?C0058:
                                           ; SOURCE LINE # 511
02E3 900000      R     MOV     DPTR,#k_imu
02E6 E0                MOVX    A,@DPTR
02E7 FD                MOV     R5,A
02E8 2400        E     ADD     A,#LOW IMU_connected
02EA F582              MOV     DPL,A
02EC E4                CLR     A
02ED 3400        E     ADDC    A,#HIGH IMU_connected
02EF F583              MOV     DPH,A
02F1 E0                MOVX    A,@DPTR
02F2 FF                MOV     R7,A
02F3 25E0              ADD     A,ACC
02F5 2400        E     ADD     A,#LOW Temp
02F7 F582              MOV     DPL,A
02F9 E4                CLR     A
02FA 3400        E     ADDC    A,#HIGH Temp
02FC F583              MOV     DPH,A
02FE E0                MOVX    A,@DPTR
02FF FB                MOV     R3,A
0300 900000      R     MOV     DPTR,#tmp
0303 E4                CLR     A
0304 F0                MOVX    @DPTR,A
0305 A3                INC     DPTR
0306 EB                MOV     A,R3
0307 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 512
0308 EF                MOV     A,R7
0309 25E0              ADD     A,ACC
030B 2400        E     ADD     A,#LOW Temp+01H
030D F582              MOV     DPL,A
030F E4                CLR     A
C51 COMPILER V9.51   IMU_FUNCTIONS                                                         02/16/2018 15:56:04 PAGE 85  

0310 3400        E     ADDC    A,#HIGH Temp+01H
0312 F583              MOV     DPH,A
0314 E0                MOVX    A,@DPTR
0315 FB                MOV     R3,A
0316 900000      R     MOV     DPTR,#tmp+01H
0319 E0                MOVX    A,@DPTR
031A FE                MOV     R6,A
031B EB                MOV     A,R3
031C FF                MOV     R7,A
031D 75F025            MOV     B,#025H
0320 ED                MOV     A,R5
0321 A4                MUL     AB
0322 2400        E     ADD     A,#LOW g_imuNew+023H
0324 F582              MOV     DPL,A
0326 E5F0              MOV     A,B
0328 3400        E     ADDC    A,#HIGH g_imuNew+023H
032A F583              MOV     DPH,A
032C EE                MOV     A,R6
032D F0                MOVX    @DPTR,A
032E A3                INC     DPTR
032F EF                MOV     A,R7
0330 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 513
0331 900000      R     MOV     DPTR,#k_imu
0334 E0                MOVX    A,@DPTR
0335 04                INC     A
0336 F0                MOVX    @DPTR,A
0337 020000      R     LJMP    ?C0045
                                           ; SOURCE LINE # 514
033A         ?C0060:
033A 22                RET     
             ; FUNCTION ReadAllIMUs (END)

             ; FUNCTION _ReadTemp (BEGIN)
                                           ; SOURCE LINE # 519
;---- Variable 'n' assigned to Register 'R6/R7' ----
                                           ; SOURCE LINE # 520
                                           ; SOURCE LINE # 521
0000 E4                CLR     A
0001 900000      R     MOV     DPTR,#low
0004 F0                MOVX    @DPTR,A
0005 A3                INC     DPTR
0006 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 522
0007 A3                INC     DPTR
0008 EE                MOV     A,R6
0009 F0                MOVX    @DPTR,A
000A A3                INC     DPTR
000B EF                MOV     A,R7
000C F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 525
000D 7F42              MOV     R7,#042H
000F 120000      R     LCALL   _ReadControlRegister
0012 900000      R     MOV     DPTR,#low
0015 EF                MOV     A,R7
0016 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 526
0017 120000      R     LCALL   SPI_delay
                                           ; SOURCE LINE # 527
001A 7F41              MOV     R7,#041H
001C 120000      R     LCALL   _ReadControlRegister
001F 900000      R     MOV     DPTR,#high
C51 COMPILER V9.51   IMU_FUNCTIONS                                                         02/16/2018 15:56:04 PAGE 86  

0022 EF                MOV     A,R7
0023 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 528
0024 120000      R     LCALL   SPI_delay
                                           ; SOURCE LINE # 530
0027 900000      R     MOV     DPTR,#high
002A E0                MOVX    A,@DPTR
002B FD                MOV     R5,A
002C 900000      R     MOV     DPTR,#row+01H
002F E0                MOVX    A,@DPTR
0030 25E0              ADD     A,ACC
0032 FF                MOV     R7,A
0033 900000      R     MOV     DPTR,#row
0036 E0                MOVX    A,@DPTR
0037 33                RLC     A
0038 FE                MOV     R6,A
0039 7400        E     MOV     A,#LOW Temp
003B 2F                ADD     A,R7
003C F582              MOV     DPL,A
003E 7400        E     MOV     A,#HIGH Temp
0040 3E                ADDC    A,R6
0041 F583              MOV     DPH,A
0043 ED                MOV     A,R5
0044 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 531
0045 900000      R     MOV     DPTR,#low
0048 E0                MOVX    A,@DPTR
0049 FD                MOV     R5,A
004A 7400        E     MOV     A,#LOW Temp+01H
004C 2F                ADD     A,R7
004D F582              MOV     DPL,A
004F 7400        E     MOV     A,#HIGH Temp+01H
0051 3E                ADDC    A,R6
0052 F583              MOV     DPH,A
0054 ED                MOV     A,R5
0055 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 532
0056 E4                CLR     A
0057 900000      R     MOV     DPTR,#low
005A F0                MOVX    @DPTR,A
005B A3                INC     DPTR
005C F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 533
005D 22                RET     
             ; FUNCTION _ReadTemp (END)

             ; FUNCTION _WriteControlRegister (BEGIN)
                                           ; SOURCE LINE # 538
0000 900000      R     MOV     DPTR,#address
0003 EF                MOV     A,R7
0004 F0                MOVX    @DPTR,A
0005 A3                INC     DPTR
0006 ED                MOV     A,R5
0007 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 540
0008 120000      E     LCALL   SPI_IMU_ClearRxBuffer
                                           ; SOURCE LINE # 541
000B 120000      E     LCALL   SPI_IMU_ClearTxBuffer
                                           ; SOURCE LINE # 542
000E 120000      E     LCALL   SPI_IMU_ClearFIFO
                                           ; SOURCE LINE # 543
0011 900000      R     MOV     DPTR,#address
C51 COMPILER V9.51   IMU_FUNCTIONS                                                         02/16/2018 15:56:04 PAGE 87  

0014 E0                MOVX    A,@DPTR
0015 FF                MOV     R7,A
0016 120000      E     LCALL   _SPI_IMU_WriteTxData
0019         ?C0062:
                                           ; SOURCE LINE # 544
0019 120000      E     LCALL   SPI_IMU_ReadStatus
001C EF                MOV     A,R7
001D 30E1F9            JNB     ACC.1,?C0062
0020         ?C0063:
                                           ; SOURCE LINE # 545
0020 900000      R     MOV     DPTR,#dta
0023 E0                MOVX    A,@DPTR
0024 FF                MOV     R7,A
0025 120000      E     LCALL   _SPI_IMU_WriteTxData
0028         ?C0064:
                                           ; SOURCE LINE # 546
0028 120000      E     LCALL   SPI_IMU_ReadStatus
002B EF                MOV     A,R7
002C 30E1F9            JNB     ACC.1,?C0064
002F         ?C0065:
                                           ; SOURCE LINE # 547
002F         ?C0066:
002F 22                RET     
             ; FUNCTION _WriteControlRegister (END)

             ; FUNCTION _ReadControlRegister (BEGIN)
                                           ; SOURCE LINE # 552
;---- Variable 'address' assigned to Register 'R7' ----
                                           ; SOURCE LINE # 555
0000 EF                MOV     A,R7
0001 4480              ORL     A,#080H
0003 FF                MOV     R7,A
0004 120000      E     LCALL   _SPI_IMU_WriteTxData
                                           ; SOURCE LINE # 556
0007 E4                CLR     A
0008 FF                MOV     R7,A
0009 120000      E     LCALL   _SPI_IMU_WriteTxData
000C         ?C0067:
                                           ; SOURCE LINE # 557
000C 120000      E     LCALL   SPI_IMU_ReadStatus
000F EF                MOV     A,R7
0010 30E0F9            JNB     ACC.0,?C0067
0013         ?C0068:
                                           ; SOURCE LINE # 558
0013 120000      E     LCALL   SPI_IMU_ReadRxData
;---- Variable 'controlreg' assigned to Register 'R7' ----
                                           ; SOURCE LINE # 559
                                           ; SOURCE LINE # 560
0016         ?C0069:
0016 22                RET     
             ; FUNCTION _ReadControlRegister (END)

             ; FUNCTION SPI_delay (BEGIN)
                                           ; SOURCE LINE # 565
                                           ; SOURCE LINE # 566
0000 900000      E     MOV     DPTR,#c_mem+03H
0003 E0                MOVX    A,@DPTR
0004 24FE              ADD     A,#0FEH
0006 600B              JZ      ?C0072
0008 04                INC     A
0009 700F              JNZ     ?C0074
                                           ; SOURCE LINE # 567
C51 COMPILER V9.51   IMU_FUNCTIONS                                                         02/16/2018 15:56:04 PAGE 88  

000B         ?C0071:
                                           ; SOURCE LINE # 568
000B 7F0A              MOV     R7,#0AH
000D 7E00              MOV     R6,#00H
000F 120000      E     LCALL   _CyDelayUs
                                           ; SOURCE LINE # 569
0012 22                RET     
                                           ; SOURCE LINE # 570
0013         ?C0072:
                                           ; SOURCE LINE # 571
0013 7F64              MOV     R7,#064H
0015 7E00              MOV     R6,#00H
0017 120000      E     LCALL   _CyDelayUs
                                           ; SOURCE LINE # 572
                                           ; SOURCE LINE # 573
                                           ; SOURCE LINE # 574
                                           ; SOURCE LINE # 575
                                           ; SOURCE LINE # 576
001A         ?C0074:
001A 22                RET     
             ; FUNCTION SPI_delay (END)



MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   6871    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =      1     156
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
   EDATA SIZE       =   ----    ----
   HDATA SIZE       =   ----    ----
   XDATA CONST SIZE =   ----    ----
   FAR CONST SIZE   =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
